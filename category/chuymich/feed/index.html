<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
>

<channel>
	<title>chuymich &#8211; BabyPhD CTF Team</title>
	<atom:link href="https://babyphd.net/category/chuymich/feed/" rel="self" type="application/rss+xml" />
	<link>https://babyphd.net</link>
	<description>NÃ³i chung Ä‘Ã¢y lÃ  má»™t khÃ¡i niá»‡m vÃ´ cÃ¹ng trá»«u tÆ°á»£ng</description>
	<lastBuildDate>Thu, 07 Sep 2017 08:22:09 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.2</generator>
<site xmlns="com-wordpress:feed-additions:1">104079289</site>	<item>
		<title>What is SafeFinder/OperatorMac campaign?</title>
		<link>https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/</link>
				<pubDate>Thu, 10 Aug 2017 15:35:08 +0000</pubDate>
		<dc:creator><![CDATA[phamus]]></dc:creator>
				<category><![CDATA[chuymich]]></category>
		<category><![CDATA[forensic]]></category>
		<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[vietnamese]]></category>
		<category><![CDATA[malware]]></category>
		<category><![CDATA[Mughthesec]]></category>
		<category><![CDATA[OperatorMac]]></category>

		<guid isPermaLink="false">https://babyphd.net/?p=687</guid>
				<description><![CDATA[&#160; A new variant of adware was just discovered yesterday. Itâ€™s going viral on Twitter and other media, since they use valid Apple developer certificate to sign all packed samples. Iâ€™m quite overbusy these days but it got my interest when seeing the name stated in that certificate: â€œQuoc Thinhâ€, quite a unique Vietnamese name. &#8230; <a href="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/" class="more-link">Continue reading <span class="screen-reader-text">What is SafeFinder/OperatorMac campaign?</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<p>&nbsp;</p>
<p>A new variant of adware was just discovered yesterday. Itâ€™s going viral on Twitter and other media, since they use valid Apple developer certificate to sign all packed samples. Iâ€™m quite overbusy these days but it got my interest when seeing the name stated in that certificate: â€œQuoc Thinhâ€, quite a unique Vietnamese name. So why not take a break from desperate thesis, toss adware in my lame automated MacOS analysis framework and see what our â€˜countrymanâ€™ doing?</p>
<p><span id="more-687"></span>The sample was first noticed by <em>Gavriel State</em>â€ on Aug 7, then <em>Thomas A Reed</em> â€“ the Mac malware boss hunter from Malwarebytes - confirmed it relates to OperatorMac on the next day. I think you all know the famous Mac free security toolsâ€™ author: <em>Patrick Wardle</em>, wrote an amazing report on <a href="https://objective-see.com/blog/blog_0x20.html">objective-see.com</a> in Aug 9. So Iâ€™m not going too deep in reverse engineering - static analysis, just throw in my Grey-cuckoo framework and grab results. In case somebody doesnâ€™t know, itâ€™s my thesis project and and soon to be released right after my judgment day - defense (hopefully).</p>
<p>From Patrickâ€™s report we understand itâ€™s an adware which installs lots of crabs. By default, cuckoo sandbox timeout is 120 sec. Letâ€™s extend it a bit, 300 sec (5 min) would be enough.</p>
<p id="jztOQbU"><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?ssl=1"><img data-attachment-id="692" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c71a4b4bf1/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?fit=1892%2C1159&amp;ssl=1" data-orig-size="1892,1159" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c71a4b4bf1" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?fit=300%2C184&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?fit=604%2C370&amp;ssl=1" class="alignnone size-full wp-image-692 " src="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?w=604&#038;ssl=1" alt="" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?w=1892&amp;ssl=1 1892w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?resize=300%2C184&amp;ssl=1 300w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?resize=768%2C470&amp;ssl=1 768w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?resize=1024%2C627&amp;ssl=1 1024w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?w=1208&amp;ssl=1 1208w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c71a4b4bf1.png?w=1812&amp;ssl=1 1812w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p>First result we got, that Apple developer ID â€œQuoc Thinhâ€, and he got his certificate revoked from Apple today by the way <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f604.png" alt="ğŸ˜„" class="wp-smiley" style="height: 1em; max-height: 1em;" />.</p>
<p><code>spctl -avv "Mughthesec-Player(dmg).dmg"<br />
Mughthesec-Player(dmg).dmg: <strong>CSSMERR_TP_CERT_REVOKED</strong></code></p>
<p>From captured screenshots, we can see what this adware apparently executes: Install Adobe flash and offer you a bunch of PUA (potential unwanted applications) â€“ Booking, Advanced Mac Cleaner, SafeFinder Safari extension, and AdBlock (in some relevant samples that will be discussed later).</p>
<p><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?ssl=1"><img data-attachment-id="696" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/webp-net-gifmaker/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?fit=1390%2C869&amp;ssl=1" data-orig-size="1390,869" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Webp.net-gifmaker" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?fit=300%2C188&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?fit=604%2C378&amp;ssl=1" class="alignnone wp-image-696" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?resize=571%2C358&#038;ssl=1" alt="" width="571" height="358" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?resize=300%2C188&amp;ssl=1 300w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?resize=768%2C480&amp;ssl=1 768w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?resize=1024%2C640&amp;ssl=1 1024w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/Webp.net-gifmaker.gif?w=1208&amp;ssl=1 1208w" sizes="(max-width: 571px) 100vw, 571px" data-recalc-dims="1" /></a></p>
<p>Behavioral analysis shows the packed DMG sample invoked a â€˜macâ€™ binary, thereafter â€˜Mughthesecâ€™ with a persistence â€˜Iâ€™ binary. Screenshots below already included other analysis variant of this campaign.</p>
<p><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?ssl=1"><img data-attachment-id="693" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c722bde0a9/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?fit=726%2C863&amp;ssl=1" data-orig-size="726,863" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c722bde0a9" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?fit=252%2C300&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?fit=604%2C718&amp;ssl=1" class="alignnone wp-image-693 " src="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?resize=275%2C327&#038;ssl=1" alt="" width="275" height="327" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?w=726&amp;ssl=1 726w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c722bde0a9.png?resize=252%2C300&amp;ssl=1 252w" sizes="(max-width: 275px) 100vw, 275px" data-recalc-dims="1" /></a><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?ssl=1"><img data-attachment-id="694" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c72309c103/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?fit=732%2C1051&amp;ssl=1" data-orig-size="732,1051" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c72309c103" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?fit=209%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?fit=604%2C867&amp;ssl=1" class="alignnone wp-image-694 " src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?resize=224%2C322&#038;ssl=1" alt="" width="224" height="322" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?w=732&amp;ssl=1 732w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?resize=209%2C300&amp;ssl=1 209w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c72309c103.png?resize=713%2C1024&amp;ssl=1 713w" sizes="(max-width: 224px) 100vw, 224px" data-recalc-dims="1" /></a><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?ssl=1"><img data-attachment-id="695" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c7244ef84c/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?fit=917%2C1413&amp;ssl=1" data-orig-size="917,1413" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c7244ef84c" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?fit=195%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?fit=604%2C930&amp;ssl=1" class="alignnone wp-image-695 " src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?resize=297%2C458&#038;ssl=1" alt="" width="297" height="458" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?w=917&amp;ssl=1 917w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?resize=195%2C300&amp;ssl=1 195w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?resize=768%2C1183&amp;ssl=1 768w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7244ef84c.png?resize=665%2C1024&amp;ssl=1 665w" sizes="(max-width: 297px) 100vw, 297px" data-recalc-dims="1" /></a></p>
<p>Move on to the network DNS feature, we see a lot of queries and some domains look "suspicious". Their DNS servers mostly are pointed to Akamai so I suggest we rather use domain as IOC than IP address, which could be different from viewers location. Filtering system calls logs with some rules of mine, there is no evasion technique been found. Itâ€™s quite surprising because Virustotal behavioral analysis shows a shorter execution trace than mine, which usually means its environment was detected at some point and malware stop running. In Patrickâ€™s report he said there might be MAC address verification to detect VM (VM MAC usually starts with â€™00:xxâ€™). Fortunately, my VM framework MAC address was modified long ago since my colleague Yorick Koster at Securify used same trick to abuse my lame framework (thanks Yorick). I should add new rule â€“ â€œMAC address checkâ€ later.</p>
<p id="zFlKkqi"><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?ssl=1" target="_blank" rel="noopener"><img data-attachment-id="698" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c755999974/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?fit=1949%2C1982&amp;ssl=1" data-orig-size="1949,1982" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c755999974" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?fit=295%2C300&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?fit=604%2C614&amp;ssl=1" class=" alignnone wp-image-698 " src="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?resize=604%2C614&#038;ssl=1" alt="" width="604" height="614" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?w=1949&amp;ssl=1 1949w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?resize=295%2C300&amp;ssl=1 295w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?resize=768%2C781&amp;ssl=1 768w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?resize=1007%2C1024&amp;ssl=1 1007w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?w=1208&amp;ssl=1 1208w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c755999974.png?w=1812&amp;ssl=1 1812w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p>Additionally instead of execve(), MacOS sandbox policy usually invokes processes using XPCProxy or launchd services. So we got several processes created with posix_spawn(): delete Safari, iBooks, Mail cache (likely Advanced Mac cleaner doing its job), install mentioned PUAs and we got some new IOCs.</p>
<p id="daBSQQC"><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?ssl=1"><img data-attachment-id="699" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c75725dafc/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?fit=1950%2C755&amp;ssl=1" data-orig-size="1950,755" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c75725dafc" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?fit=300%2C116&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?fit=604%2C234&amp;ssl=1" class="alignnone wp-image-699 size-full" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?resize=604%2C234&#038;ssl=1" alt="" width="604" height="234" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?w=1950&amp;ssl=1 1950w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?resize=300%2C116&amp;ssl=1 300w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?resize=768%2C297&amp;ssl=1 768w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?resize=1024%2C396&amp;ssl=1 1024w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?w=1208&amp;ssl=1 1208w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c75725dafc.png?w=1812&amp;ssl=1 1812w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p>Other great things from Cuckoo sandbox are Network analysis and Dropped files. However previous report detailed it well enough, hence only some screenshots from these features will be showed:</p>
<style>.gist table { margin-bottom: 0; }</style><div class="gist-oembed" data-gist="0f0a61788ffe53be1f1a08be33150962.json"></div>
<style>.gist table { margin-bottom: 0; }</style><div class="gist-oembed" data-gist="1830a8eb98f5ba755f1947386f7f93a0.json"></div>
<p>Some dropped binaries like AMCleaner (93dd0c34a4ec25a508cd6d5fb86d8ccc0c318238d9fee0c93342a20759bf9b7e) already marked as malicious on VirusTotal (VT) 7/56, which could be an indication for vigilant users.</p>
<p>Also with some fancy nonsense statistic screenshots, intent to scare analyst (:p)</p>
<p id="MQRWKqm"><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?ssl=1"><img data-attachment-id="702" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c7796efc07/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?fit=1950%2C987&amp;ssl=1" data-orig-size="1950,987" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c7796efc07" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?fit=300%2C152&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?fit=604%2C306&amp;ssl=1" class="alignnone size-full wp-image-702 " src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?w=604&#038;ssl=1" alt="" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?w=1950&amp;ssl=1 1950w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?resize=300%2C152&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?resize=768%2C389&amp;ssl=1 768w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?resize=1024%2C518&amp;ssl=1 1024w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?w=1208&amp;ssl=1 1208w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c7796efc07.png?w=1812&amp;ssl=1 1812w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p id="WVLWtXn"><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?ssl=1"><img data-attachment-id="703" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c779ebc535/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?fit=1950%2C880&amp;ssl=1" data-orig-size="1950,880" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c779ebc535" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?fit=300%2C135&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?fit=604%2C273&amp;ssl=1" class="alignnone size-full wp-image-703 " src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?w=604&#038;ssl=1" alt="" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?w=1950&amp;ssl=1 1950w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?resize=300%2C135&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?resize=768%2C347&amp;ssl=1 768w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?resize=1024%2C462&amp;ssl=1 1024w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?w=1208&amp;ssl=1 1208w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c779ebc535.png?w=1812&amp;ssl=1 1812w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p>At this moment, we have got all indicators to make behavioral detection rule and go hunting for other similar adware samples. Reason why I call this blog post â€“ â€œa campaignâ€: there are numerous similar packed DMG/Mac apps matched â€˜my behavioral ruleâ€™: fake Adobe Flash installer, lots of PUAs from subdomain name [cdn, dl, api] and Vietnamese developer certificate ID.</p>
<p>&nbsp;</p>
<table width="470">
<tbody>
<tr>
<td width="107"><strong>Developer ID</strong></td>
<td width="75"><strong>Number of Samples</strong></td>
<td width="95"><strong>Detected (VT)</strong></td>
<td width="92"><strong>Apple status</strong></td>
<td width="101"><strong>First seen</strong></td>
</tr>
<tr>
<td width="107">Quoc Thinh</p>
<p>9G2J3967H9</p>
<p>&nbsp;</td>
<td width="75">6</td>
<td width="95">1/6 (Ikarus detected 1 sample)</td>
<td width="92">Revoked ID</td>
<td width="101">2017-08-05</p>
<p>&nbsp;</td>
</tr>
<tr>
<td width="107">Pham Huong</p>
<p>2BS26F3ZCP</td>
<td width="75">7</td>
<td width="95">0</td>
<td width="92">Revoked ID</td>
<td width="101">2017-07-15</td>
</tr>
<tr>
<td width="107">Phan Anh</p>
<p>C7J9SJ95GX</td>
<td width="75">24</td>
<td width="95">0</td>
<td width="92">Valid</td>
<td width="101">2017-04-13</td>
</tr>
<tr>
<td width="107">Nhien Nguyen</td>
<td width="75">3</td>
<td width="95">1/3 (ESET-NOD32 detected 1 sample)</td>
<td width="92">Valid</td>
<td width="101">2017-08-09</p>
<p>&nbsp;</td>
</tr>
<tr>
<td width="107">Thanh Thuy WAA98JBA59</td>
<td width="75">17</td>
<td width="95">0</td>
<td width="92">Valid</td>
<td width="101">2017-07-06</p>
<p>&nbsp;</td>
</tr>
<tr>
<td width="107">Tran Phong GMFY4TULB3</td>
<td width="75">6</td>
<td width="95">0</td>
<td width="92">Valid</td>
<td width="101">2017-06-27</p>
<p>&nbsp;</td>
</tr>
<tr>
<td width="107">Minh Duc</p>
<p>7CXE5FM69W</td>
<td width="75">5</td>
<td width="95">0</td>
<td width="92">Valid</td>
<td width="101">2017-06-21</td>
</tr>
<tr>
<td width="107">Mai Linh</p>
<p>M3XXTCHY66</td>
<td width="75">3</td>
<td width="95">0</td>
<td width="92">Valid</td>
<td width="101">2017-07-12</td>
</tr>
<tr>
<td width="107"><strong><em>Total</em></strong></td>
<td width="75"><em>71</em></td>
<td width="95"><em>2 (3%)</em></td>
<td width="92"><em>2/8 Revoked ID</em></td>
<td width="101"><em>Staying undetected at least 4 months</em></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Please note that VT score is an indicator only, people usually fail to judge hardworking AVs by looking at VT score. We can never know if AV would detect those adwares live running whether or not. Also instead of Mughthesec, other adware use different loader names such as SearchWebSvc, TrustedSafeFinder, etc. I donâ€™t think OSX/Mughthesec would be appropriate for the adware name. I suggest it would be OperatorMac because all campaign packages call a simple loader â€œmacâ€ binary.</p>
<p><strong>Conclusion</strong></p>
<p>Be <strong>vigilant</strong>, no one needs Flash nowadays itâ€™s dead. Apple Mac is not virus-free even with those fancy Apple protection XProtect, GateKeeper, Mac sandbox, code signing, etc, many security researchers already warned.</p>
<p>Itâ€™s likely an affiliation advertising campaign, in which adware authors spent quite some money (~$800) for these 8 Apple developer certificates and only 2 of them are revoked. Some of dropped MachO executables are not signed, and we donâ€™t know what if those can be really dangerous (like the unsigned MachO executable from APT32 Ocean Lotus campaign targeted Vietnamese organizations lately is really a sophisticated one). Based on timeline and periods of certificate registration, and money they have spent, I doubt these adware creators are making lots of money. Last, let me remind you some incidents happened recently and could be related to this campaign:</p>
<ul>
<li><a href="http://genk.vn/chuyen-gia-bao-mat-phat-hien-duong-day-chiem-doat-tai-khoan-ngan-hang-facebook-gmail-cuc-lon-o-viet-nam-ban-cung-co-the-la-nan-nhan-20170622230143671.chn">Malicious browser extension â€“ fake IDM Downloader harvested around 5M cookies from popular websites, targeted Vietnamese netizens.Â </a></li>
<li><a href="https://www.techsignin.com/tintuc/lua-dao-tu-viet-nam-kiem-hon-80-000-usdthang-tu-apple-store/">Fake App store AV app â€“ making more than $80K per month.Â </a></li>
</ul>
<p><a href="https://twitter.com/phd_phuc">Phamus</a></p>
<p><strong>P/S: </strong>I confronted one famous hacker in cyber pirate community â€“ â€œQuoc Thinhâ€ aka G4mm4, he seriously admitted he's behind the "crime". Not sure thatâ€™s true or he was just kidding <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f60f.png" alt="ğŸ˜" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?ssl=1"><img data-attachment-id="704" data-permalink="https://babyphd.net/2017/08/10/wtf-is-safefinderoperatormac-campaign/img_598c77b2a0e82/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?fit=729%2C461&amp;ssl=1" data-orig-size="729,461" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="img_598c77b2a0e82" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?fit=300%2C190&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?fit=604%2C382&amp;ssl=1" class="alignnone size-full wp-image-704 " src="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?w=604&#038;ssl=1" alt="" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?w=729&amp;ssl=1 729w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/08/img_598c77b2a0e82.png?resize=300%2C190&amp;ssl=1 300w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p><strong>IOCs:</strong></p>
<p><strong>appfastplay.com</strong></p>
<p>Created</p>
<table width="416">
<tbody>
<tr>
<td>2017-04-08</td>
<td>New</td>
<td>-none-</td>
<td>198.54.117.212</td>
</tr>
<tr>
<td>2017-04-23</td>
<td>Change</td>
<td>198.54.117.212</td>
<td>198.54.117.215</td>
</tr>
<tr>
<td>2017-07-07</td>
<td>Change</td>
<td>198.54.117.215</td>
<td>198.54.117.210</td>
</tr>
</tbody>
</table>
<p>Namecheap domain hosting @ USA.</p>
<p><strong>mughthesec.com</strong></p>
<p>198.54.117.210</p>
<p><strong>SimplyEApps.com</strong><br />
198.54.117.210</p>
<p><strong>(api./dl./cdn.)dynacubeapps.com</strong></p>
<p>198.54.117.210</p>
<p><strong>(api./dl./cdn.)cloudmacfront.com</strong></p>
<p><strong>(api./dl./cdn.)api.airautoupdates.com</strong></p>
<p><strong>(api./dl./cdn.)osxessentials.com</strong></p>
<p><strong>(api./dl./cdn.)api.vertizoom.com</strong></p>
<p><strong>(api./dl./cdn.)macgabspan.com</strong></p>
<p><strong>install.searchwebsvc.com</strong></p>
<p><strong>install.trustedsafefinder.com</strong></p>
<p><strong>searc.trustedsafefinder.com/h?_pg=XXXX-1234-67890</strong></p>
<p><strong>searc.trustedsafefinder.com/s?q=@@@&amp;_pg=XXXX-1234-67890</strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>~/Library/LaunchAgents/com.Mughthesec.plist</strong></p>
<p><strong><span class="mono">~/Library/Application Support/com.Mughthesec</span></strong></p>
<p><strong>~/Library/LaunchAgents/SearchWebSvc.plist</strong></p>
<p><strong><span class="mono">~/Library/Application Support/SearchWebSvc</span></strong></p>
<p><strong>~/Library/LaunchAgents/TrustedSafeFinder</strong></p>
<p><strong><span class="mono">~/Library/Application Support/com.TrustedSafeFinder.plist</span></strong></p>
<p>&nbsp;</p>
<p><strong>~/Library/LaunchAgents/com.pcv.hlpramcn.plistÂ  (Advanced Mac Cleaner)</strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><em>phan anh 4f62cc7e6f923ffd3d01de7ed47c3a62593e8c245bfc6cb81783a70fb821ca3c</em></p>
<p><em>9e72aea77562c7d85950076f8acef12580050d2bfd199de9500cd9a3cf18e5ba</em></p>
<p><em>04343158bd4942f25f8ff4e39c5bc21fa08b2e98c9f4dd3391f017667a47e59e</em></p>
<p><em>b31baed2592708d5fb8227fc7d18faa339f813ff1db1aa32580f54d0601b08f0</em></p>
<p><em>5afe86f9ec0764f53721452199383a0732d262b679356f4e5c716ca5710502c8</em></p>
<p><em>4dcde58b6bd4b415eae924b62b1f0ce4e0b8d11a714fbcf99c4da553a66751d7</em></p>
<p><em>08f2dfa3d011aa90fa90f2a2fabeb9aff72ad0acde01378f8126a3ab6ce61b41</em></p>
<p><em>7ceb92839c025760203fac5d0ad4ff63df9c92d409831b3536c99f0c7f0874c6</em></p>
<p><em>e0606875fb61db097f618b5e2ea9c140e3e5dff733ec3a30719af8452ca06aab</em></p>
<p><em>4b665b885db33498129a86b354f09b4067e51b7add4595cb231d0d0b7f8a8678</em></p>
<p><em>22ca8d75544d061d3e8b986b0af3dc2a462d9acfa29a4be5a5589fa51282dedb</em></p>
<p><em>0650ce68e2d3b1e9e53a72115f5da42120d6eff83a07aa309b1f04f11f55c1de</em></p>
<p><em>4f62cc7e6f923ffd3d01de7ed47c3a62593e8c245bfc6cb81783a70fb821ca3c</em></p>
<p><em>9e72aea77562c7d85950076f8acef12580050d2bfd199de9500cd9a3cf18e5ba</em></p>
<p><em>cf63d5861eb654efcafef25d758ca5daf877e3c63888ee086bcd29f22e3f77ad</em></p>
<p><em>04343158bd4942f25f8ff4e39c5bc21fa08b2e98c9f4dd3391f017667a47e59e</em></p>
<p><em>b31baed2592708d5fb8227fc7d18faa339f813ff1db1aa32580f54d0601b08f0</em></p>
<p><em>5afe86f9ec0764f53721452199383a0732d262b679356f4e5c716ca5710502c8</em></p>
<p><em>4dcde58b6bd4b415eae924b62b1f0ce4e0b8d11a714fbcf99c4da553a66751d7</em></p>
<p><em>08f2dfa3d011aa90fa90f2a2fabeb9aff72ad0acde01378f8126a3ab6ce61b41</em></p>
<p><em>8690299992e9a1d8bf1b5184a3274619eb6c95c44a83b42f7ee455b419947d5d</em></p>
<p><em>7ceb92839c025760203fac5d0ad4ff63df9c92d409831b3536c99f0c7f0874c6</em></p>
<p><em>e0606875fb61db097f618b5e2ea9c140e3e5dff733ec3a30719af8452ca06aab</em></p>
<p><em>f47246e7b4ae43d6aa284145292d67247d428d52f327c00a7f7af2dd65fb1c0b</em></p>
<p><em>4b665b885db33498129a86b354f09b4067e51b7add4595cb231d0d0b7f8a8678</em></p>
<p><em>22ca8d75544d061d3e8b986b0af3dc2a462d9acfa29a4be5a5589fa51282dedb</em></p>
<p><em>0650ce68e2d3b1e9e53a72115f5da42120d6eff83a07aa309b1f04f11f55c1de</em></p>
<p><em>52ac6206d109acb15547e8f655d1e522d28bbb39c9e40784126de5f27778f51c</em></p>
<p><em>cd9c564799f88ad6efae4bd5acb047d5f0d5b39378965386925c171eec3977b5</em></p>
<p><em>15d796bd76339a0fbb430bc8c6cc9bcbd6a21f3aef619d0cb81fe0069552a29d</em></p>
<p><em>99c598ef5fe10347803296d20a37fb6c33d793f35443725dbcfc41382dbd9391</em></p>
<p><em>34886986af88810585238c2ecf44924e48a08f775b25794e553689f0f2585899</em></p>
<p><em>12effeff2bc280d144bd1432f9bbfae2efaae483731d20b6f0b061e8be505a0c</em></p>
<p><em>3460877be00af3632895539567b57647ca1e07363213b4f93d52ac80b17454ee</em></p>
<p><em>79b54c71b74112881a8c4b88ad36a9bae4c2eecedcba510e2b4f52c215a9ebac</em></p>
<p>&nbsp;</p>
<p><em>quoc thinh</em><br />
<em> 9c4f74feff131fa93dd04175795f334649ee91ad7fce11dc661231254e1ebd84</em></p>
<p><em>f5d76324cb8fcae7f00b6825e4c110ddfd6b32db452f1eca0f4cff958316869c</em></p>
<p><em>63b9e81a0c3a57bcbaf2aac308ecc53035f7fff6a416a6752acf13f16352a94a</em></p>
<p><em>431c30c1db1aefb87d5fa5485c0fd11e792ec94bb95fb401cc93ef0528ad41cb</em></p>
<p><em>687def9ff3cd0fa8dab1a7d4da5fa04b0604292fa74a66f23a96fb1eb31cd2c2</em></p>
<p>&nbsp;</p>
<p><em>pham huong</em></p>
<p><em>af1e6391dd48f84beac69fbd69dbbb20eefd7ca69d33c686ed4d5a85ba760254</em></p>
<p><em>7ce4d0ec31dc334388d2461b65617ba5dbdebf935da2ed2a7d65d8a9cc14148c</em></p>
<p><em>f995bd07e5f782cf823b45d226c63407695d4a1bfb06358f49621291f1629f60</em></p>
<p><em>a2bd399d8087752776762fa9a805429de6973994f26e17bdac9ca4130dcb87fb</em></p>
<p><em>bafe800c397e69e9e6859311c437e5c4b6cdd200f3ed832306e6c9f331eb6bae</em></p>
<p>&nbsp;</p>
<p><em>nhien nguyen</em></p>
<p><em>3028aa7ece2f140f6fa28d348bf18156e6e4da4cb2f9208925d15ca7b564f35f</em></p>
<p><em>fc89afe4f72c3e02dca3e998351e59684f5ad6a9000c9f2eaee3b7195d4f0fda</em></p>
<p>&nbsp;</p>
<p><em>minh duc</em></p>
<p><em>17f39a0268ec97cf5528bcc9d871c7f7b428379a2549c3b01581440acd7ed8a5</em></p>
<p><em>79e821bab2adbdb9a53e471b7a1937c8f0a1ba1ce0801b8d2eca49a7c9391e42</em></p>
<p><em>dfc0b3618a3eb246ae6026c460596a102f45ff71660f7fdec39c5f105a3190cd</em></p>
<p><em>90d825d481297def07771865a5e719c4e55ed1109008721744608bf94841d7cc</em></p>
<p>&nbsp;</p>
<p><em>tran phong</em></p>
<p><em>8c1b1b2b997a11d8b408091e12d02960bf71bb83304a3b23c439056c4e9882ad</em></p>
<p><em>9acb781d19d6ed4c6ac6e10448d113fca868bba21f95496f535013005fe2d29e</em></p>
<p><em>f159c3dc2aa704d42a07f145985fa7b339cbd4bcdf7ff9783220b9dd3a9e097e</em></p>
<p><em>a1dc898586e1697bd19d6c6ec8421e1871ac918132bcbcf89db9b523e199664d</em></p>
<p><em>e537d868f9ab708e3c5a8427dd4036798570b7d6b55b3ef0e1be9775e64e9c9d</em></p>
<p><em>f7468d3af9267e9a6325fb981a5bd734dafeea32265d0318cb4793bd1b52f112</em></p>
<p>&nbsp;</p>
<p><em>mai linh</em></p>
<p>&nbsp;</p>
<p><em>c7c11ae9fdaeef0c359621de06d4de5264cc3d62929d5e8a1e2c3d2c08290e2f</em></p>
<p><em>202d7e5bd230c59051d5c21124e9af613f70576f3511a0a79c567f48844e5b45</em></p>
<p>&nbsp;</p>
<p><em>thanh thuy</em></p>
<p><em>6494a2bd4e9da2f3000b0774a13682a3f9fcd17e7da8d0fd42bfa88d1dce14f5</em></p>
<p><em>aa556a1b27356c35be3890f7c6f022c431d48ff7b5c15b2a0586609b15e5d5f6</em></p>
<p><em>f86b4d24627d5dc9d806a3f89c03aea19aaa987bcedb44fc5635140bf9191d03</em></p>
<p><em>387dddd9bb34fb1fa697f4f5c208ad425e14f6a37e943a3ddf73cca12356054b</em></p>
<p><em>086ad9c053fc3a670db2954b120733ba97109e1eb845ca383e88d2623289ae66</em></p>
<p><em>da329f9a9b2ea505fb5ffb4a8d08ff8755b3c960ce84c342c50ab7e808c835b5</em></p>
<p><em>22179b6701cf203abfa94eee9152495d409bcb9f5293fb5aa87fe342f7285a18</em></p>
<p><em>a60503e089b805ca7b99186c1b4014bbca98655eadd615f911a7379708b0405a</em></p>
<p><em>b3be9a9b5b6cd97815a1a2a5c14713b761b664e195a6e1384219a701ccc12036</em></p>
<p><em>22179b6701cf203abfa94eee9152495d409bcb9f5293fb5aa87fe342f7285a18</em></p>
<p><em>a60503e089b805ca7b99186c1b4014bbca98655eadd615f911a7379708b0405a</em></p>
<p><em>da329f9a9b2ea505fb5ffb4a8d08ff8755b3c960ce84c342c50ab7e808c835b5</em></p>
<p><em>22179b6701cf203abfa94eee9152495d409bcb9f5293fb5aa87fe342f7285a18</em></p>
<p><em>387dddd9bb34fb1fa697f4f5c208ad425e14f6a37e943a3ddf73cca12356054b</em></p>
<p><em>5b4703281a185e81113b303277e546c5f87ae599fba4565932a2638b3d40b41f</em></p>
<p><em>da329f9a9b2ea505fb5ffb4a8d08ff8755b3c960ce84c342c50ab7e808c835b5</em></p>
<p><em>5b4703281a185e81113b303277e546c5f87ae599fba4565932a2638b3d40b41f</em></p>
<p><em>5b4703281a185e81113b303277e546c5f87ae599fba4565932a2638b3d40b41f</em></p>
<p><em>b3be9a9b5b6cd97815a1a2a5c14713b761b664e195a6e1384219a701ccc12036</em></p>
<p><em>aa556a1b27356c35be3890f7c6f022c431d48ff7b5c15b2a0586609b15e5d5f6</em></p>
<p><em>a60503e089b805ca7b99186c1b4014bbca98655eadd615f911a7379708b0405a</em></p>
<p><em>da329f9a9b2ea505fb5ffb4a8d08ff8755b3c960ce84c342c50ab7e808c835b5</em></p>
<p id="INlghhy"><em>Â </em></p>
]]></content:encoded>
									<post-id xmlns="com-wordpress:feed-additions:1">687</post-id>	</item>
		<item>
		<title>An toÃ n tÃ­nh toÃ¡n Ä‘a thÃ nh viÃªn</title>
		<link>https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/</link>
				<pubDate>Wed, 07 Sep 2016 11:24:32 +0000</pubDate>
		<dc:creator><![CDATA[chuymichxinhdep]]></dc:creator>
				<category><![CDATA[chuymich]]></category>
		<category><![CDATA[crypto]]></category>
		<category><![CDATA[research]]></category>
		<category><![CDATA[vietnamese]]></category>

		<guid isPermaLink="false">https://babyphd.net/?p=557</guid>
				<description><![CDATA[Multi-Party Computation (MPC) lÃ  má»™t khÃ¡i niá»‡m Ä‘Æ°á»£c cÃ¡c nhÃ  máº­t mÃ£ há»c Ä‘áº¯n Ä‘o nghiÃªn cá»©u táº­n nhá»¯ng tháº­p niÃªn 80 tháº¿ ká»· trÆ°á»›c. Xuáº¥t phÃ¡t tá»± nhiÃªn tá»« nhá»¯ng bÃ i toÃ¡n há»c bÃºa trongÂ cuá»™c sá»‘ng pháº£i Ä‘áº·t ra má»™t giao thá»©c hay ho hÆ¡n Ä‘á»ƒ Ä‘Ã¡nh Ä‘á»‘ nhau. VÃ­ dá»¥ nÄƒm 1982 Ä‘Ã³ &#8230; <a href="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/" class="more-link">Continue reading <span class="screen-reader-text">An toÃ n tÃ­nh toÃ¡n Ä‘a thÃ nh viÃªn</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<p><strong>Multi-Party Computation (MPC)</strong> lÃ  má»™t khÃ¡i niá»‡m Ä‘Æ°á»£c cÃ¡c nhÃ  máº­t mÃ£ há»c Ä‘áº¯n Ä‘o nghiÃªn cá»©u táº­n nhá»¯ng tháº­p niÃªn 80 tháº¿ ká»· trÆ°á»›c. Xuáº¥t phÃ¡t tá»± nhiÃªn tá»« nhá»¯ng bÃ i toÃ¡n há»c bÃºa trongÂ cuá»™c sá»‘ng pháº£i Ä‘áº·t ra má»™t giao thá»©c hay ho hÆ¡n Ä‘á»ƒ Ä‘Ã¡nh Ä‘á»‘ nhau. VÃ­ dá»¥ nÄƒm 1982 Ä‘Ã³ lÃ  bÃ i toÃ¡n triá»‡u phÃº cá»§a anh Yao (1982 <a title="Andrew Yao" href="https://en.wikipedia.org/wiki/Andrew_Yao">Andrew Yao</a>Â  1), diá»…n NÃ´mÂ Ä‘Æ¡n giáº£n lÃ  anh Bin cÃ³ sá»‘ A tiá»n, cÃ²n anh Job cÃ³ sá»‘ B tiá»n. Hai anh trong má»™t cuá»™c nháº­u lá»¡ thÃ¡ch nhau xem ai cÃ³ nhiá»u tiá»n hÆ¡n ai <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?ssl=1"><img data-attachment-id="568" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/surrender/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="surrender" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-568" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?resize=25%2C25&#038;ssl=1" alt="surrender" width="25" height="25" data-recalc-dims="1" /></a>. NhÆ°ng hai anh Ä‘á»u khÃ´ng muá»‘n lá»™ raÂ tá»•ng sá»‘ tiá»n mÃ¬nh cÃ³ cho nhau biáº¿t. Do Ä‘Ã³ má»›i náº£y sinh bÃ i toÃ n chá»©ng minh báº¥t Ä‘áº³ng thá»©c AÂ â‰¥ B mÃ  khÃ´ng lá»™ thÃ´ng tin nÃ o cá»§a A vÃ  B cho báº¥t cá»© ai, ká»ƒ cáº£ 2 anh Bin vÃ  anh Jobs. Giáº£i quyáº¿t xong bÃ i toÃ n nÃ y Ä‘Ã£ má»Ÿ ra má»™t ká»· nguyÃªn má»›i cho báº£o máº­t thÃ´ng tin Ä‘áº·c biá»‡t lÃ  thÆ°Æ¡ng mai Ä‘iá»‡n tá»­, data mining khi muá»‘n so sÃ¡nh cÃ¡c giÃ¡ trá»‹, tÃ­nh toÃ¡n cá»™ng trá»« nhÃ¢n chia mÃ  váº«n báº£o vá»‡ Ä‘Æ°á»£c thÃ´ng tin máº­t nhÆ° sá»‘ tiá»n, tá»•ng tiá»n trong tÃ i khoáº£n khÃ¡ch hÃ ng, thÃ´ng tin nhÃ¢n kháº©u há»c v.v.</p>
<p><span id="more-557"></span></p>
<p><strong>1. MPC</strong></p>
<p>Tá»•ng quÃ¡t hÃ³a bÃ i toÃ¡n cá»§a Yao Ä‘Ã³ lÃ : giáº£ sá»­ cÃ³ n thÃ nh viÃªnÂ  <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_80a9c7eae10390d097c7698419f4e3ac.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span> báº£o máº­t cho n giÃ¡ trá»‹ tÆ°Æ¡ng á»©ngÂ <span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_391e71aa9bce9e9078443200ea5c76a5.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span>, vÃ  táº¥t cáº£ cÃ¡c thÃ nh viÃªn thá»±c hiá»‡nÂ phÃ©p tÃ­nhÂ <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_a722b10a2cc25a31b0c1067d8a2854fc.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span> sao cho cÃ¡c giÃ¡ trá»‹Â <span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_391e71aa9bce9e9078443200ea5c76a5.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> Ä‘Æ°á»£c báº£o máº­t hoÃ n toÃ n. Trong Ä‘á»‹nh nghÄ©a nÃ y, bÃ i toÃ¡nÂ cá»§a Yao lÃ  trÆ°á»ng há»£p nhá» vá»›i <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_c303081f7a16f603112b0375bdc84883.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> vÃ Â phÃ©p tÃ­nhÂ <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_345e1346b4e1502a8d3742870700eb0a.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span></p>
<p>VÃ­ dá»¥ thá»© hai Ä‘Ã³ lÃ  trÃ² chÆ¡i tÃ¬nh yÃªu, nhÆ° cÃ¡c báº¡n Ä‘á»c biáº¿t <a href="http://ctf.yeuchimse.com">yeuchimse</a>Â lÃ  má»™t thanh niÃªn á»§y má»‹ Æ°á»›t Ã¡t,Â sáº¿n rá»‡n hayÂ nghÄ© lung tung. Sáº» Ä‘á»‡ láº§n Ä‘áº§u tiÃªn khÃ´ng dÃ¡m tá» tÃ¬nh vÃ¬ sá»£ ngÆ°á»i áº¥y khÃ´ng thÃ­ch mÃ¬nh thÃ¬ tháº­t lÃ  quÃª Ä‘á»™ nÃªn Ä‘Ã£Â yÃªu cáº§u <a href="https://www.facebook.com/profile.php?id=100009514863101">chuymichxinhdepÂ </a>thiáº¿t káº¿ má»™t giao thá»©c sao cho:</p>
<ul>
<li><strong> Eligibility</strong>: Ä‘Æ°á»£c thá»• lá»™ vÃ  chá»‰ thá»• lá»™ mÃ´t láº§n.</li>
<li><strong>Privacy</strong>: Ä‘áº£m báº£o khÃ´ng lá»™ thÃ´ng tin Ä‘Ã£ thá»• lá»™ cho báº¥t ká»³ ai biáº¿t, cho dÃ¹ Ä‘Ã³ lÃ  ngÆ°á»i áº¥y hay chÃ­nhÂ <a href="https://www.facebook.com/profile.php?id=100009514863101">chuymichxinhdepÂ </a></li>
<li><strong>Universal Verifiability</strong>: ai cÅ©ng cÃ³ thá»ƒ check Ä‘Æ°á»£c káº¿t quáº£ lÃ  2 Ä‘á»©a nÃ³ cÃ³ Ä‘áº¿n Ä‘Æ°á»£c vá»›i nhau hay khÃ´ng Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh cÃ´ng báº±ng cá»§a cuá»™c chÆ¡i tÃ¬nh Ã¡i.</li>
<li><strong>Robustness</strong>: Má»i hÃ nh Ä‘á»™ng gian trÃ¡ vÃ­ dá»¥ nhÆ° thá»• lá»™ cÃ³ yÃªu sau Ä‘Ã³ láº¡i thay Ä‘á»•i Ã½ kiáº¿n lÃ  khÃ´ng yÃªu Ä‘á»u bá»‹ cáº¥m.</li>
</ul>
<p>4Â tiá»n Ä‘á» trÃªn cÃ¡c báº¡n Ä‘á»c nÃ o thÃ´ng minh cÃ³ thá»ƒ Ã¡p dá»¥ng vÃ o báº§u cá»­ Ä‘iá»‡n tá»­, tuy nhiÃªn giao thá»©cÂ <a href="https://www.facebook.com/profile.php?id=100009514863101">chuymichxinhdepÂ </a>thiáº¿t káº¿ dÆ°á»›i Ä‘Ã¢y sau nÃ y Ä‘Æ°á»£c biáº¿t Ä‘áº¿n rá»™ng rÃ£i dÆ°á»›i cÃ¡i tÃªnÂ  Five-Card Trick (Bert den Boer, Eurocrypt 1989) nhÆ° sau:</p>
<figure id="attachment_560" aria-describedby="caption-attachment-560" style="width: 524px" class="wp-caption aligncenter"><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?ssl=1"><img data-attachment-id="560" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?fit=524%2C297&amp;ssl=1" data-orig-size="524,297" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?fit=300%2C170&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?fit=524%2C297&amp;ssl=1" class="wp-image-560 size-full" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?resize=524%2C297&#038;ssl=1" alt="Five-Card Trick (Bert den Boer, Eurocrypt 1989)" width="524" height="297" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?w=524&amp;ssl=1 524w, https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled.png?resize=300%2C170&amp;ssl=1 300w" sizes="(max-width: 524px) 100vw, 524px" data-recalc-dims="1" /></a><figcaption id="caption-attachment-560" class="wp-caption-text">Five-Card Trick (Bert den Boer, Eurocrypt 1989)</figcaption></figure>
<p>Vá»›i 5 lÃ¡ bÃ i Ãt, máº·c Ä‘á»‹nh má»™t chiáº¿c lÃ¡ Ãt cÆ¡ Ä‘á» Ä‘áº·t sáºµn trÃªn bÃ n. Vá»›i cÃ¡c cÃ¢u tráº£ lá»i giá»¯a 2 ngÆ°á»i tham gia trÃ² chÆ¡i lÃ  YÃªu hoáº·c khÃ´ng YÃªu tÆ°Æ¡ng á»©ng vá»›i 2 cÃ¡ch xáº¿p bÃ i Ãt cÆ¡, Ãt bÃ­ch. Sau khi Ä‘áº·t bÃ i xuá»‘ng bÃ n (cÃ³ thá»ƒ thay Ä‘á»•i chiá»u hÃ ng 5 bÃ i Ä‘á»ƒ khÃ´ng ai biáº¿t cÃ¢u tráº£ lá»i cá»§a mÃ¬nh á»Ÿ bÃªn nÃ o) thÃ¬ káº¿t quáº£ cáº£ 2 ngÆ°á»i Ä‘á»u cÃ³ cáº£m tÃ¬nh vá»›i nhau chá»‰ xáº£y ra khi cÃ³ 3 quÃ¢n Ãt cÆ¡ náº±m cáº¡nh nhau. TrÆ°á»ng há»£p káº¿t quáº£ 2 ngÆ°á»i khÃ´ng há»£p nhau thÃ¬ váº«n Ä‘áº£m báº£o cÃ´ gÃ¡i khÃ´ng biáº¿t Ä‘Æ°á»£c Ä‘á»‘i phÆ°Æ¡ng tráº£ lá»i lÃ  YÃªu hay khÃ´ng YÃªu. (Tháº­t lÃ  vi diá»‡u pháº£i khÃ´ng? <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?ssl=1"><img class="alignnone wp-image-565" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?resize=25%2C25&#038;ssl=1" alt="boss" width="25" height="25" data-recalc-dims="1" /></a>)</p>
<p>Äá»ƒ giáº£i thÃ­ch cÃ¡ch giáº£i nÃ y, thá»±c cháº¥t Ä‘Ã³ chÃ­nh lÃ  báº£ng AND toÃ¡n tá»­ á»Ÿ báº£ng nÃ y:</p>
<p><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?ssl=1"><img data-attachment-id="561" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-2/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?fit=330%2C80&amp;ssl=1" data-orig-size="330,80" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?fit=300%2C73&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?fit=330%2C80&amp;ssl=1" class="size-medium wp-image-561 aligncenter" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?resize=300%2C73&#038;ssl=1" alt="Untitled" width="300" height="73" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?resize=300%2C73&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-1.png?w=330&amp;ssl=1 330w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></p>
<p>Káº¿t quáº£ xy=1 thÃ¬ rÃµ khi vÃ  chá»‰ khi x=1 vÃ  y=1. CÃ²n vá»›i xy=0 thÃ¬ ta chá»‰ káº¿t luáº­n cÃ³ 1 trong x hoáº·cÂ y tráº£ lá»i 0 mÃ  khÃ´ng thá»ƒ kháº³ng Ä‘á»‹nh rÃµ ai tráº£ lá»i 0 hay 1.Â Káº¿t quáº£ láº§n thá»±c nghiá»‡m protocol Ä‘Ã³ nhÆ° cÃ¡c báº¡n Ä‘Ã£ biáº¿t,Â cuá»™c sá»‘ngÂ rÃ¢Ìt Ã´Ì€n aÌ€o, cÃ³ nhá»¯ng káº» tháº¥t tÃ¬nh khÃ´ng biáº¿tÂ trÃ´Ìn vaÌ€o Ä‘Ã¢u Ä‘ÃªÌ‰ ngÃ´Ì€i mÃ´Ì£t miÌ€nh vaÌ€ tiÌ€m sÆ°Ì£ tiÌƒnh lÄƒÌ£ng cho riÃªng miÌ€nhÂ nÃªn Ä‘Ã nh chÆ¡i CTF.Â â€œEm chÆ°a lÃ¢Ìy chÃ´Ì€ng laÌ€ lÃ´Ìƒi cuÌ‰a anh!â€. Vá»›iÂ love game thÃ¬Â Ä‘en báº¡c cÃ²n Ä‘á» tÃ¬nh nhÆ°ng <a href="http://ctf.yeuchimse.com">yeuchimse</a>Â Ä‘en thÃ´i, Ä‘á» váº«n váº­y.Â <a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/beauty.png?ssl=1"><img data-attachment-id="564" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/beauty/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/beauty.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="beauty" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/beauty.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/beauty.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-564" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/beauty.png?resize=26%2C26&#038;ssl=1" alt="beauty" width="26" height="26" data-recalc-dims="1" /></a></p>
<p><strong>2. OT</strong></p>
<p>Äá»ƒ hÃ³c bÃºa hÆ¡n, ngÆ°á»i ta Ä‘Ã£ phÃ¡t minh ra giao thá»©c ráº¥t hay ho Ä‘Ã³ lÃ  Chuyá»ƒnÂ giao khÃ´ng lá»™Â thÃ´ng tin ( Oblivious Transfer ) Ä‘Æ¡n giáº£n tháº¿ nÃ y: Â Anh Mao giá»¯ 2 giÃ¡ trá»‹Â <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_9865b118af4cfc107929ec116ab9eb80.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> lÃ  bÃ­t tá»©c lÃ  chá»‰ cÃ³ 0 hoáº·c 1, chá»‹ MaiAnh giá»¯ má»™t giÃ¡ trá»‹ secret s, táº¥t nhiÃªn, cÅ©ng chá»‰ lÃ  bÃ­t 01. Chá»‹ chá»n má»™t sá»‘ u ngáº«u nhiÃªn khÃ¡ to trong táº­p nguyÃªn <strong>Z</strong> vÃ  chá»‹ tÃ­nh <span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_7cb433fd43ea022f61fa76e4d73a28d8.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span> vá»›i <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_7997a21e02329ca6c6bc77e68e43277e.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span>. Do <em>s</em> lÃ  bit nÃªn lÃºc nÃ y chá»‹ cÃ³ 2 giÃ¡ trá»‹ <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_f6bf330e68e6b2523ee18338347b8e2a.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span>, chá»‹Â gá»­i cáº£ 2 giÃ¡ trá»‹ nÃ y láº¡i cho Mao vá»›i má»¥c Ä‘Ã­ch lÃ m Mao khÃ´ng biáº¿t giÃ¡ trá»‹ <em>u, s</em> lÃ  gÃ¬, ká»ƒ cáº£ giÃ¡ trá»‹ <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_b2f5ff47436671b6e533d8dc3614845d.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> á»Ÿ Ä‘Ã¢y lÃ  generator chung mÃ  cáº£ 2 Ä‘á»u biáº¿t, thÃ¬ theo báº¡n <a href="https://en.wikipedia.org/wiki/ElGamal_encryption">ElGamalÂ </a>Ä‘á»‘iÂ vá»›i mÃ¡y tÃ­nh cá»• lá»— cá»§a Mao lÃ  con MBP 15 inch Ä‘á»i giá»¯a 2015, tá»›i lÃºc bá»‘c má»™Â cÅ©ng khÃ´ng giáº£i ra Ä‘Æ°á»£cÂ <em>u</em> (Ã  mÃ  vá»›i Ä‘iá»u kiá»‡n lÃ  chá»‹ MaiAnh cÃ³ <em>u</em> ráº¥t to nhÃ©). Sau bÆ°á»›c nÃ y thÃ¬ Mao chá»nÂ 2 giÃ¡ trá»‹ <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_53dd2b7a99cd54e0d6febbc311e5b554.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> cÅ©ng ngáº«u nhiÃªn trong táº­p nguyÃªn Ä‘á»ƒÂ tÃ­nh má»™t phÆ°Æ¡ng trÃ¬nh phá»©c táº¡p hÆ¡n Ä‘Ã³ lÃ :</p>
<p><span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_ae26caf67145aba703126c109d33ea19.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span></p>
<p>Rá»“i Mao chuyá»ƒn láº¡i cáº·p <span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_dbdce35eb2f44b7d782b3408c9661212.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span> Ä‘á»ƒ cho MaiAnh tÃ­nh ra <span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_d9094fb8cc52a45fb6338a51d0b15d53.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span>. NhÆ° váº­y, Mao khÃ´ng Ä‘á»ƒ lá»™ cáº£ 2Â giÃ¡ trá»‹Â <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_9865b118af4cfc107929ec116ab9eb80.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span>, trong khi MaiAnh khÃ´ng Ä‘á»ƒ lá»™ <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_03c7c0ace395d80182db07ae2c30f034.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" data-recalc-dims="1" /></span> mÃ  váº«n láº¥y Ä‘Æ°á»£c <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_a727b3abb09c0ecf8898343a5bbeffb1.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> vá». Mao cÅ©ng khÃ´ng biáº¿t Ä‘Æ°á»£c MaiAnh Ä‘Ã£ láº¥y sá»‘ nÃ o vá» mÃ  chá»‰ biáº¿t MaiAnh Ä‘Ã£ láº¥y Ä‘Æ°á»£c 1 sá»‘. TÃ³m táº¯t láº¡i trong hÃ¬nh nhÆ° sau:</p>
<p><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?ssl=1"><img data-attachment-id="563" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-3/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?fit=389%2C187&amp;ssl=1" data-orig-size="389,187" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?fit=300%2C144&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?fit=389%2C187&amp;ssl=1" class="aligncenter wp-image-563 size-full" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?resize=389%2C187&#038;ssl=1" alt="Untitled" width="389" height="187" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?w=389&amp;ssl=1 389w, https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-2.png?resize=300%2C144&amp;ssl=1 300w" sizes="(max-width: 389px) 100vw, 389px" data-recalc-dims="1" /></a></p>
<p>CÃ¢u há»i Ä‘áº·t ra OT sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng nhÆ° tháº¿ nÃ o, vÃ­ dá»¥ anh MÃ­ch Ä‘ang lÃ m há»‡ thá»‘ng e-Health sá»©c khá»e y táº¿ Ä‘iá»‡n tá»­. VÃ¬ anh lÃ  bÃªn thá»© 3 lÃ m tin há»c nÃªn táº¥t nhiÃªn anh khÃ´ng Ä‘Æ°á»£c Ã´ng quan thanh liÃªm nÃ o cho tiáº¿p cáº­n vÃ o há»“ sÆ¡ y táº¿ cá»§a bá»‡nh nhÃ¢n. Do Ä‘Ã³ anh quyáº¿t Ä‘á»‹nh kÃ½ há»£p Ä‘á»“ng vá»›i bá»‡nh viá»‡n sá»­ dá»¥ng OT Ä‘á»ƒ lÃ m API truy cáº­p thÃ´ng tin. LÃºc nÃ y anh lÃ m demo nÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u má»›i cÃ³ thÃ´ng tin HIV cá»§a 2 bá»‡nh nhÃ¢n lÆ°u dÆ°á»›i dáº¡ng dÆ°Æ¡ng tÃ­nh (1) vÃ  Ã¢m tÃ­nh (0). Ãp dá»¥ng OTP anh MÃ­ch Ä‘Ã£ cÃ³ thá»ƒ biáº¿t tráº¡ng thÃ¡i HIV cá»§a 1 trong 2 bá»‡nh nhÃ¢n mÃ  bá»‡nh viÃªn khÃ´ng biáº¿t anh Ä‘Ã£ query bá»‡nh nhÃ¢n nÃ o.</p>
<p><strong>3.ZKP</strong></p>
<p>Bá»‡nh cáº¡nh viá»‡c dÃ¹ng OT Ä‘á»ƒ chia sáº» khÃ´ng lá»™ thÃ´ng tin, ngÆ°á»i ta cÃ²n nghÄ© ra nhiá»u trÃ² phá»©c táº¡p khÃ¡c dÆ°á»›i cÃ¡i tÃªn <strong>ZKP (Zero Knowledge Proof)</strong>Â Ä‘iá»ƒn hÃ¬nh lÃ Â bÃ i toÃ¡n lÃªn bar cá»§a chá»¥y MÃ­ch Ä‘Æ°á»£c trÃ¬nh bÃ y nhÆ° sau: Trong má»™t láº§n trÃªnÂ bar hÆ¡i muá»™n vÃ o khoáº£ngÂ 2 giá» sÃ¡ng thÃ¬ cÃ¡c anh pokemon áº­p vÃ o Ä‘Ã²i kiá»ƒm tra hÃ nh chÃ­nh vá»›i lÃ½ do trÃªn 18 tuá»•i má»›i Ä‘Æ°á»£c ngá»“i bar hÃºt thuá»‘c bÃº diá»‡u nhÆ° má»™t sá»‘ hoa háº­u nÃ o Ä‘Ã³. Vá»‘n lÃ  má»™t ngÆ°á»i tÃ´n trá»ng quyá»n con ngÆ°á»i chá»¥y khÃ´ng muá»‘n ai phÃ¡n xÃ©t vÃ¬ hÃºt thuá»‘c lÃ¡ lÃ  quyá»n tá»± do cá»§a má»—i ngÆ°á»i. Chá»¥yÂ chÃ¢n thÃ nh chÃºc má»«ng báº¡n chá»¥yÂ náº¿u emÂ bá» Ä‘Æ°á»£c thuá»‘c, cÃ²n khÃ´ng emÂ cÅ©ng Ä‘á»«ng buá»“n vÃ¬ sau má»™t thá»i gian nghá»‰, Ä‘iáº¿u thuá»‘c sáº¯p tá»›i emÂ hÃºt Ä‘áº£m báº£o nÃ³ sáº½ ngon khÃ´ng bÃºt nÃ o táº£ xiáº¿t.Â NgoÃ i ra láº¡i vá»‘n lÃ  má»™t ngÆ°á»i tÃ´n trá»ng quyá»n con ngÆ°á»i chá»¥y cÅ©ngÂ khÃ´ng muá»‘n Ä‘á»ƒ lá»™ liá»…u ngÃ y sinh nháº­t cá»§a mÃ¬nh giá»¯a chá»‘n Ä‘Ã´ng ngÆ°á»i. Thay vÃ¬ trÃ¬nh ID CMND hay báº±ng lÃ¡i chá»¥y Ä‘Ã£ show tháº» ngÃ¢n hÃ ng cá»§a mÃ¬nh Ä‘á»ƒ quáº¹t bill cho cÃ¡c anh xem. Vá»›i luáº­t trÃªn 18 tuá»•i má»›i Ä‘Æ°á»£c lÃ m credit card nÃªn máº·c nhiÃªn chá»¥y Ä‘Ã£ chá»©ng minh mÃ¬nh Ä‘Ã£ trÃªn 18 tuá»•i mÃ  khÃ´ng Ä‘á»ƒ lá»™ ngÃ y sinh cá»§a mÃ¬nh <a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?ssl=1"><img data-attachment-id="566" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/sexy_girl/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sexy_girl" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-566" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?resize=25%2C25&#038;ssl=1" alt="sexy_girl" width="25" height="25" data-recalc-dims="1" /></a>.</p>
<p>Má»™t vÃ­ dá»¥ ZKP thá»© 2 Ä‘Ã³ lÃ  vÃ­ dá»¥ hang Ä‘á»™ng cá»§a AliBaBa:</p>
<p><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-3.png?ssl=1"><img data-attachment-id="567" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-4/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-3.png?fit=277%2C187&amp;ssl=1" data-orig-size="277,187" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-3.png?fit=277%2C187&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-3.png?fit=277%2C187&amp;ssl=1" class="size-full wp-image-567 aligncenter" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-3.png?resize=277%2C187&#038;ssl=1" alt="Untitled" width="277" height="187" data-recalc-dims="1" /></a></p>
<p>NhiÂ tuyÃªn bá»‘ ráº±ng cÃ´ biáº¿t máº­t mÃ£ Ä‘á»ƒ má»Ÿ cá»­a hang. LÃ­pÂ há»i cÃ´ pháº£iÂ chá»©ng minh tuyÃªn bá»‘ cá»§a mÃ¬nh. NhÆ°ng NhiÂ khÃ´ng thá»ƒ nÃ³i máº­t kháº©uÂ cho LÃ­p vÃ¬ nhÆ° váº­y tháº­t lÃ  lá»™ liá»…uÂ <a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?ssl=1"><img data-attachment-id="566" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/sexy_girl/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="sexy_girl" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-566" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/sexy_girl.png?resize=25%2C25&#038;ssl=1" alt="sexy_girl" width="25" height="25" data-recalc-dims="1" /></a>. Do Ä‘Ã³ chá»¥y MÃ­ch Ä‘Ã£ chá»‰ cho Nhi má»™t cÃ¡ch nhÆ° sau:</p>
<ul>
<li>LÃ­p Ä‘á»©ng quay máº·t tá»¥t quáº§n á»Ÿ má»™t khoáº£ng cÃ¡ch khÃ¡ xa vÃ  chá»Â NhiÂ bÆ°á»›c vÃ o hang.<br />
Sau Ä‘Ã³, LÃ­p Ä‘áº¿n cá»­a hangÂ rÃµ rÃ ngÂ anh ta khÃ´ng biáº¿t Nhi Ä‘Ã£ Ä‘i sang bÃªn nÃ o.</li>
<li>LÃ­p tÃ¹y Ã½ hÃ©t lÃªn yÃªu cáº§uÂ Nhi bÆ°á»›c raÂ tá»« bÃªn trÃ¡i hoáº·c bÃªn pháº£i.</li>
<li>Hai Ä‘á»©aÂ láº·p láº¡i trÃ² chÆ¡i nÃ y cho Ä‘áº¿nÂ khi LÃ­p bá»‹Â thuyáº¿t phá»¥c hoáº·c Nhi chÃ¡n khÃ´ng chÆ¡i ná»¯a.</li>
</ul>
<p>RÃµ rÃ ng náº¿u Nhi Ä‘Ã£ á»Ÿ phÃ­a bÃªn trÃ¡i vÃ  LÃ­p yÃªu cáº§uÂ cÃ´ áº¥y Ä‘áº¿n tá»« bÃªn trÃ¡i thÃ¬ quáº£ nÃ yÂ NhiÂ Ä‘Ã£ may máº¯n <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?ssl=1"><img class="alignnone wp-image-568" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?resize=24%2C24&#038;ssl=1" alt="surrender" width="24" height="24" data-recalc-dims="1" /></a>. Náº¿u khÃ´ng, Nhi chá»‰ cÃ³ thá»ƒ Ä‘áº¿nÂ tá»« bÃªn trÃ¡i náº¿u cÃ´ áº¥y biáº¿t máº­t mÃ£ Ä‘á»ƒ má»Ÿ cá»­a hang pháº£i khÃ´ng nÃ o (!?).</p>
<p><strong>4.Há»‡ máº­t Ä‘á»“ng cáº¥u( Homomorphic cryptosystem)</strong></p>
<p>Äá»ƒ tiáº¿p tá»¥c lÃ  cuá»™c chÆ¡i thÃªm pháº§n phá»©c táº¡p, cÃ¡c nhÃ  máº­t mÃ£ há»c láº¡i tiáº¿p tá»¥c nghÄ© ra Há»‡ máº­t Ä‘á»“ng cáº¥u Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a:</p>
<p><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?ssl=1"><img data-attachment-id="570" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-5/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?fit=463%2C159&amp;ssl=1" data-orig-size="463,159" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?fit=300%2C103&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?fit=463%2C159&amp;ssl=1" class="aligncenter wp-image-570 size-full" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?resize=463%2C159&#038;ssl=1" alt="Untitled" width="463" height="159" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?w=463&amp;ssl=1 463w, https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-4.png?resize=300%2C103&amp;ssl=1 300w" sizes="(max-width: 463px) 100vw, 463px" data-recalc-dims="1" /></a></p>
<p>Há»‡ mÃ£ hoÃ¡ Elgamal cÃ³ tÃ­nh cháº¥t Ä‘á»“ng cáº¥u, nhá» nÃ³ cÃ³ thá»ƒ tÃ­nh Ä‘Æ°á»£c káº¿t quáº£ trong cuá»™c bá» phiáº¿u â€œchá»n má»™t trong haiâ€, mÃ  khÃ´ng cáº§n giáº£i mÃ£ tá»«ng lÃ¡ phiáº¿u. SÆ¡ Ä‘á»“ chia sáº» bÃ­ máº­t Shamir phá»‘i há»£p vá»›i há»‡ mÃ£ hoÃ¡ Elgamal cÃ²n cÃ³ tÃ­nh cháº¥t Ä‘áº·c biá»‡t hÆ¡n ná»¯a, nhá» nÃ³ cÃ³ thá»ƒ chia lÃ¡ phiáº¿u thÃ nh nhiá»u máº£nh, cá»­ tri gá»­i má»—i máº£nh cho má»™t thÃ nh viÃªn ban kiá»ƒm phiáº¿u, khi khá»›p cÃ¡c máº£nh phiáº¿u láº¡i sáº½ Ä‘Æ°á»£c ná»™i dung Ä‘áº§y Ä‘á»§ cá»§a lÃ¡ phiáº¿u. BÃ i bÃ¡o nÃ y trÃ¬nh bÃ y cÃ¡c tÃ­nh cháº¥t trÃªn vÃ  chá»‰ ra á»©ng dá»¥ng cá»§a chÃºng trong bá» phiáº¿u tá»« xa.Há»‡ mÃ£ hoÃ¡ Elgamal cÃ³ tÃ­nh cháº¥t Ä‘á»“ng cáº¥u, nhá» nÃ³ cÃ³ thá»ƒ tÃ­nh Ä‘Æ°á»£c káº¿t quáº£ trong cuá»™c bá» phiáº¿u â€œchá»n má»™t trong haiâ€, mÃ  khÃ´ng cáº§n giáº£i mÃ£ tá»«ng lÃ¡ phiáº¿u. SÆ¡ Ä‘á»“ chia sáº» bÃ­ máº­t Shamir phá»‘i há»£p vá»›i há»‡ mÃ£ hoÃ¡ Elgamal cÃ²n cÃ³ tÃ­nh cháº¥t Ä‘áº·c biá»‡t hÆ¡n ná»¯a, nhá» nÃ³ cÃ³ thá»ƒ chia lÃ¡ phiáº¿u thÃ nh nhiá»u máº£nh, cá»­ tri gá»­i má»—i máº£nh cho má»™t thÃ nh viÃªn ban kiá»ƒm phiáº¿u, khi khá»›p cÃ¡c máº£nh phiáº¿u láº¡i sáº½ Ä‘Æ°á»£c ná»™i dung Ä‘áº§y Ä‘á»§ cá»§a lÃ¡ phiáº¿u. (ref2 Trá»‹nh Nháº­t Tiáº¿n, Äáº·ng Thu Hiá»n, TrÆ°Æ¡ng Thá»‹ Thu Hiá»n, LÆ°Æ¡ng Viá»‡t NguyÃªn)</p>
<p class="">Äá»ƒ rÃµ thÃªm vá» váº¥n Ä‘á» nÃ y, báº¡n Ä‘á»c cÃ³ thá»ƒ xem láº¡i bÃ iÂ <a href="https://babyphd.net/2016/03/introduction-to-threshold-signature-scheme/">Introduction to Threshold signature scheme</a>. LÆ°u Ã½Â Elgamal cÃ³ tÃ­nh cháº¥t Ä‘á»“ng cáº¥u cÃ²n RSA thÃ¬ khÃ´ng nhÃ© <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?ssl=1"><img data-attachment-id="568" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/surrender/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="surrender" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-568" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?resize=25%2C25&#038;ssl=1" alt="surrender" width="25" height="25" data-recalc-dims="1" /></a>.Â á» khuÃ´n khá»• bÃ i viáº¿t nÃ y chá»‰ trÃ¬nh bÃ y thÃªm vá» há»‡ mÃ£ Paillier cÃ´ng bá»‘ nÄƒm 1999 nhÆ° sau:</p>
<p class="">Giáº£ sá»­Â n = pq vÃ Â g lÃ  má»™t pháº§n tá»­ Ä‘áº·c biáº¿t cá»§a <a href="https://vi.wikipedia.org/wiki/Nh%C3%B3m_(to%C3%A1n_h%E1%BB%8Dc)#Nh.C3.B3m_xiclic">nhÃ³m cyclic</a>Â Z dá»±a theo lÅ©y thá»«a n sao cho <span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_5c6997547b6627b1b35a5ce698c5a298.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span>. KhÃ³a bÃ­ máº­tÂ <span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_b41b9dd23fcbbf9d222a2b66fd285d85.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span>, khÃ³a cÃ´ng khaiÂ (g, n). Vá»›i plaintext lÃ  thÃ´ng Ä‘iá»‡p <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_b35275cb2846fd1f47f7772df7bb08fc.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span> vÃ  má»™t sá»‘ r nguyÃªn dÆ°Æ¡ng ngáº«u nhiÃªn thÃ¬ hÃ m mÃ£ hÃ³a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a:<br />
<span class='MathJax_Preview'><img src='https://i2.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_ce9d9741c5d2c87fc79319bb44b3fb85.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span></p>
<p class="">LÆ°u Ã½ lcm = least common multiple Æ°á»›c chung nhá» nháº¥t. VÃ  ngÆ°á»i ta thÆ°á»ng chá»n g=n+1 Ä‘á»ƒ thá»a mÃ£n tÃ­nh cháº¥t generator nhÆ° sau:</p>
<p class=""><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?ssl=1"><img data-attachment-id="576" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-6/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?fit=384%2C169&amp;ssl=1" data-orig-size="384,169" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?fit=300%2C132&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?fit=384%2C169&amp;ssl=1" class="aligncenter wp-image-576 size-full" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?resize=384%2C169&#038;ssl=1" alt="Untitled" width="384" height="169" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?w=384&amp;ssl=1 384w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-5.png?resize=300%2C132&amp;ssl=1 300w" sizes="(max-width: 384px) 100vw, 384px" data-recalc-dims="1" /></a></p>
<p class="">CÃ²n quÃ¡ trÃ¬nh giáº£i mÃ£ thÃ¬ phá»©c táº¡p hÆ¡n chÃºt, Ä‘Ã³ lÃ :</p>
<p class=""><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?ssl=1"><img data-attachment-id="577" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-7/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?fit=823%2C410&amp;ssl=1" data-orig-size="823,410" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?fit=300%2C149&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?fit=604%2C301&amp;ssl=1" class="alignnone wp-image-577 " src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?resize=542%2C270&#038;ssl=1" alt="Untitled" width="542" height="270" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?w=823&amp;ssl=1 823w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?resize=300%2C149&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-6.png?resize=768%2C383&amp;ssl=1 768w" sizes="(max-width: 542px) 100vw, 542px" data-recalc-dims="1" /></a></p>
<p class="">Váº­y táº¡i sao cÃ³ RSA phá»• cáº­p nÃ´ng thÃ´n Ä‘Ã£ cháº¥t chÆ¡i ngÆ°á»i dÆ¡i rá»“i, cÃ¡c nhÃ  máº­t mÃ£ há»c láº¡i pháº£i nghÄ© ra há»‡ máº­t oÃ¡i Äƒm nÃ y <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?ssl=1"><img class="alignnone wp-image-568" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?resize=24%2C24&#038;ssl=1" alt="surrender" width="24" height="24" data-recalc-dims="1" /></a>. áº¤y lÃ  vÃ¬ á»Ÿ Ä‘Ã¢y ta cÃ³ random r, má»—i láº§n mÃ£ hÃ³a láº¡i cÃ³ ciphertext khÃ¡c nhau. NgoÃ i ra vá»›i má»—i ciphertext náº¿u khÃ´ng biáº¿t random r thÃ¬ láº¡iÂ ra vÃ´ sá»‘ message m thá»a khÃ¡c nhau. NgoÃ i ra vá»›i tÃ­nh cháº¥t Ä‘á»“ng cáº¥u giÃºp cho phÃ©p cá»™ng (+) vÃ  lÅ©y thá»«a (^) ta cÃ³ thá»ƒ thiáº¿t káº¿ cÃ¡c giao thá»©c mÃ£ hÃ³a gá»­i Ä‘i ciphertext Ä‘á»ƒ má»™t bÃªn thá»© ba tÃ­nh toÃ¡n, bÃªn tÃ­nh toÃ¡n nÃ y chá»‰ tráº£ vá» káº¿t quáº£ phÃ©p tÃ­nh mÃ  khÃ´ng biáº¿t giÃ¡ trá»‹ mÃ  bÃªn cáº§n tÃ­nh Ä‘Æ°a ra lÃ  gÃ¬Â <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?ssl=1"><img data-attachment-id="565" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/boss/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="boss" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-565" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/boss.png?resize=27%2C27&#038;ssl=1" alt="boss" width="27" height="27" data-recalc-dims="1" /></a></p>
<p class=""><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?ssl=1"><img data-attachment-id="578" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-8/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?fit=659%2C153&amp;ssl=1" data-orig-size="659,153" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?fit=300%2C70&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?fit=604%2C140&amp;ssl=1" class="alignnone wp-image-578 size-full" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?resize=604%2C140&#038;ssl=1" alt="Untitled" width="604" height="140" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?w=659&amp;ssl=1 659w, https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-7.png?resize=300%2C70&amp;ssl=1 300w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p class="">VÃ­ dá»¥ giao thá»©c Ä‘Æ¡n giáº£n Alice cÃ³ <strong>publickey</strong> (Ä‘á»ƒ mÃ£ hÃ³a) vÃ  2 sá»‘ tiá»n cá»§a 2 orders mÃ  Bob Ä‘áº·t hÃ ng Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a<strong> [a], [b]</strong>. Alice khÃ´ng thá»ƒ giáº£i mÃ£ Ä‘á»ƒ biáº¿t <strong>a, b</strong> nhÆ°ng láº¡i muá»‘n tÃ­nh tá»•ng tiá»n<strong> [a+b]</strong>. Bob á»Ÿ Ä‘Ã¢y cÃ³ <strong>secretkey</strong> cÃ³ kháº£ nÄƒng giáº£i mÃ£ Ä‘á»ƒ tÃ­nh phÃ©p cá»™ng cho Alice nhÆ°ng há»‡ thÃ´ng khÃ´ng muá»‘n Bob biáº¿t Alice Ä‘ang muá»‘n tÃ­nh gÃ¬.</p>
<p class=""><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?ssl=1"><img data-attachment-id="579" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-9/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?fit=724%2C273&amp;ssl=1" data-orig-size="724,273" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?fit=300%2C113&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?fit=604%2C228&amp;ssl=1" class="alignnone size-full wp-image-579" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?resize=604%2C228&#038;ssl=1" alt="Untitled" width="604" height="228" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?w=724&amp;ssl=1 724w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-8.png?resize=300%2C113&amp;ssl=1 300w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p class="">Alice báº±ng viá»‡c sá»­ dá»¥ng random <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_2943eb743cec6d95e34639874f2d6a27.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" data-recalc-dims="1" /></span> khiáº¿n cho Bob khÃ´ng biáº¿t Ä‘Æ°á»ng nÃ o mÃ  láº§n, dÃ¹ anh cÃ³ giáº£i mÃ£ ra a mÅ© vÃ  b ngÃ£ thÃ¬ váº«n khÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c a,b lÃ  gÃ¬. Tuy nhiÃªn cÅ©ng xin lÆ°u Ã½ á»Ÿ Ä‘Ã¢y ráº±ng, Ä‘á»ƒ Ä‘áº£m báº£o giao thá»©c hoáº¡t Ä‘á»™ng ngon thÃ¬Â random cáº§n cÃ³ má»™t Ä‘á»™ dÃ i k bits cáº§n thiáº¿t nhÃ©. LÃºc implement bá»‹ hack thÃ¬ Ä‘á»«ng Ä‘á»• cho chá»¥y khÃ´ng nÃ³i trÆ°á»›cÂ <a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/look_down.png?ssl=1"><img data-attachment-id="580" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/look_down/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/look_down.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="look_down" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/look_down.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/look_down.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-580" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/look_down.png?resize=25%2C25&#038;ssl=1" alt="look_down" width="25" height="25" data-recalc-dims="1" /></a>.</p>
<p class=""><strong>5. VÃ­ dá»¥ á»©ng dá»¥ng</strong></p>
<p class="">Pháº§n nÃ y vá»›i báº¡n Ä‘á»c nÃ o hiá»ƒu rÃµ há»c thuáº­t rá»“i cÃ³ thá»ƒ skip sang luÃ´n pháº§n like subcribe comment vÃ  share trÃªn phÃ¢y bÃºc.Â DÆ°á»›iÂ Ä‘Ã¢y chá»‰ lÃ  bÃ i toÃ¡n vÃ­ dá»¥ Ä‘Æ¡n giáº£n tráº» con sá»­ dá»¥ng Pailler Ä‘á»ƒ báº£o vá»‡ cÃ¡c thÃ´ng tin nhÆ°: tuá»•i, thu nháº­p báº±ng Python.</p>
<p class=""><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?ssl=1"><img data-attachment-id="581" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-10/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?fit=561%2C312&amp;ssl=1" data-orig-size="561,312" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?fit=300%2C167&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?fit=561%2C312&amp;ssl=1" class="alignnone size-full wp-image-581" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?resize=561%2C312&#038;ssl=1" alt="Untitled" width="561" height="312" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?w=561&amp;ssl=1 561w, https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-9.png?resize=300%2C167&amp;ssl=1 300w" sizes="(max-width: 561px) 100vw, 561px" data-recalc-dims="1" /></a></p>
<p class="">Äáº§u tiÃªn, giáº£ sá»­ tÃ´i cÃ³ má»™t há»‡ cÆ¡ sá»Ÿ dá»¯ liá»‡u cáº§n mÃ£ hÃ³a Paillier vá»›i 3 cá»™t: TÃªn, tuá»•i, thu nháº­p. TÃ´i xin Äƒn cáº¯pÂ thÆ° viá»‡nÂ Pure Python Paillier Homomorphic Cryptosystem (3) Ä‘á»ƒ mÃ£ hÃ³a dÆ°á»›i Ä‘Ã¢y:</p>
<pre class="lang:python decode:true">from paillier.paillier import *
from timer import Timer
import random,string

def encrypt_db():
	print "Encrypting...."
	for p in session.query(Person):
		p.age = str(encrypt(pub, int(p.age)))
		p.income = str(encrypt(pub, int(p.income)))
		p.name = str(int(p.name.encode("hex"),16))
	session.commit()

def decrypt_db():
	print "Decrypting...."
	for p in session.query(Person):
		print decrypt(priv, pub, int(p.age)) ,decrypt(priv, pub, int(p.income)) , hex(decrypt(priv, pub, int(p.name ))).replace("0x","").replace("L","")

print "Generating keypair..."
priv, pub =  generate_keypair(2048)
</pre>
<p>Vá»›i quyá»n query lÃªn database toÃ n bá»™ bá»‹ mÃ£ hÃ³a, tÃ´i cÃ³ 2 bÃ i toÃ¡n cáº§n giáº£i quyáº¿t Ä‘Ã³ lÃ :</p>
<ul>
<li>Nháº­p lÃªn má»™t sá»‘ <em>x</em>, yÃªu cáº§u tráº£ lá»i cÃ¢u há»iÂ cÃ³ bao nhiÃªu ngÆ°á»i cÃ³ Ä‘á»™ tuá»•i lá»›n hÆ¡n x mÃ  khÃ´ng lÃ m lá»™ sá»‘ <em>x</em> Ä‘ang Ä‘Æ°á»£c há»i.</li>
<li>TÃ­nh tá»•ng thu nháº­p cá»§a táº¥t cáº£ nhá»¯ng ngÆ°á»i cÃ³ Ä‘á»™ tuá»•iÂ lá»›n hÆ¡n x mÃ  khÃ´ng lÃ m lá»™ thÃ´ng tin thu nháº­p cá»§a tá»«ng ngÆ°á»i.</li>
</ul>
<p>Äá» giáº£i quyáº¿t 2 bÃ i toÃ¡n trÃªn, tÃ´i tham kháº£o giao thá»©c tÃ­nh toÃ¡n khÃ´ng lÃ m lá»™ dá»¯ liá»‡u Ä‘Æ°á»£c cáº£i tiáº¿n cá»§a Zerkin (4) báº¡n tÃ´i nhÆ° sau:</p>
<p><img class="alignnone size-full" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/u.jpg?resize=604%2C958&#038;ssl=1" alt="" width="604" height="958" data-recalc-dims="1" /></p>
<p>HÃ m gá»­i lÃªn Ä‘á»ƒ láº¥y káº¿t quáº£ ta chá»‰ cáº§n quan tÃ¢m tá»›i hÃ m A(pub, enc_a, enc_b). á» Ä‘Ã¢y Ä‘Æ°á»£c code nhÆ° sau (code bá»«a hÆ¡i dÃ i Ä‘á» nghá»‹ khÃ´ng gáº¡ch Ä‘Ã¡ <a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/beat_brick.png?ssl=1"><img data-attachment-id="586" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/beat_brick/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/beat_brick.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="beat_brick" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/beat_brick.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/beat_brick.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-586" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/09/beat_brick.png?resize=27%2C27&#038;ssl=1" alt="beat_brick" width="27" height="27" data-recalc-dims="1" /></a>):</p>
<pre class="lang:python decode:true ">from paillier.paillier import *
import random,string

l=17
def A(pub, enc_a, enc_b):
	enc_z = e_add(pub, e_add(pub, enc_a, encrypt(pub, 2**l)), invmod(enc_b,pub.n_sq))
	r = random.randrange(2**(80+l+1))

	r_bin = bin(r).replace("0b","").replace("L","")
	r_bin = "0"* (l-len(r_bin))+r_bin
	r_bin = r_bin[::-1]
	enc_r = encrypt(pub, r)
	enc_d = e_add(pub, enc_z , enc_r)
	enc_d1, enc_d2 , enc_t = B1(enc_d)
	s = [-1,1][random.randint(0,1)]

	h = [0]*l
	v = [0]*l
	enc_c = [0]*l
	enc_e = [0]*l
	for i in range(l):
		while True:
			h[i] = random.getrandbits(long(round(math.log(pub.n, 2))))
			if h[i] &gt; 0 and h[i] &lt; pub.n and gcd(h[i], pub.n) == 1:
				break

	for i in range(l):
		v[i] = s - int(r_bin[i])
		for j in range(i+1,l):
			v[i] -= (2**j) * int(r_bin[j])
		if v[i] &lt; 0: 
			v[i] = pub.n + v[i]
		enc_c[i] = e_add(pub, encrypt(pub, v[i]), enc_t[i])
		enc_e[i] = pow (enc_c[i], h[i],pub.n_sq)

	enc_lamda = B2(enc_e)
	if s != 1:
		enc_lamda = e_add(pub, encrypt(pub,1), invmod(enc_lamda,pub.n_sq))
	enc_zl = e_add(pub, e_add(pub, enc_d2, invmod(encrypt(pub,(r / 2**l)),pub.n_sq)), invmod(enc_lamda,pub.n_sq))
	return B3(enc_zl)

def B1(enc_d):
	d= decrypt(priv, pub, enc_d)
	d1 = d%(2**l)
	d2 = d/(2**l)
	d_bin = bin(d1).replace("0b","").replace("L","")
	d_bin = "0"* (l-len(d_bin))+d_bin
	d_bin = d_bin[::-1]
	t = [int(0)]*l
	for i in range(l):
		t[i] = int(d_bin[i])
		for j in range(i+1,l):
			t[i] += (2**j) * int(d_bin[j])
		t[i] = encrypt(pub, t[i])
	return encrypt(pub,d1) , encrypt(pub,d2),t
def B2(enc_e):
	e = [int(0)]*l
	for i in range(l):
		e[i] = decrypt(priv, pub, enc_e[i])
		if e[i] ==0: return encrypt(pub,1)
	return encrypt(pub,0)


def B3(enc_zl):
	return decrypt(priv,pub, enc_zl)</pre>
<p>Váº­y vá»›i bÃ i toÃ¡n 1, Ä‘á»ƒ biáº¿t bao ngÆ°á»i cÃ³ sá»‘ tuá»•i tá»« x Ä‘á»• lÃªn ta chá»‰ cáº§n query báº±ng hÃ m A():</p>
<pre class="lang:default decode:true">index = [-1]*len(income)	
for i in range(len(age)):
	enc_x = encrypt(pub, x)
	if int(A(pub, age[i],  enc_x))&gt;0:
		index[number] = i
		number+=1</pre>
<p>Vá»›i bÃ i toÃ¡n 2, Ä‘á»ƒ thÃªm pháº§n báº£o máº­t ta nhÃ©t thÃªm má»™t sá»‘ random r tháº­t dÃ i vÃ o má»—i láº§n query nhÆ° sau:</p>
<pre class="lang:default decode:true">	r = random.randrange(2**(80+32))
	for i in index:
		if i&gt;-1:
			totalincome = e_add(pub, totalincome, income[i])
	totalincome = e_add(pub, totalincome, encrypt(pub,r))
	totalincome = decrypt(priv,pub,totalincome) - r</pre>
<p>Tháº­t lÃ  Ä‘Æ¡n giáº£n pháº£i khÃ´ngÂ <a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?ssl=1"><img data-attachment-id="568" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/surrender/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" data-orig-size="128,128" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="surrender" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?fit=128%2C128&amp;ssl=1" class="alignnone wp-image-568" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/surrender.png?resize=25%2C25&#038;ssl=1" alt="surrender" width="25" height="25" data-recalc-dims="1" /></a>, náº¿u báº¡n váº«n chÆ°a hiá»ƒu, xin Ä‘á»«ng liÃªn há»‡ tÃ´i vÃ¬ tÃ´i sáº½ khÃ´ng giáº£i thÃ­ch Ä‘Ã¢u. Xin má»i báº¡n Ä‘á»c pháº§n appendix nhÃ©.</p>
<ol>
<li>"Protocols for secure computations". <i>FOCS</i>. 23rd Annual Symposium on Foundations of Computer Science (FOCS 1982): 160â€“164.<a title="Digital object identifier" href="https://en.wikipedia.org/wiki/Digital_object_identifier">doi</a>:<a class="external text" href="https://dx.doi.org/10.1109%2FSFCS.1982.88" rel="nofollow">10.1109/SFCS.1982.88</a></li>
<li>MÃ£ hoÃ¡ Ä‘á»“ng cáº¥u vÃ  á»©ng dá»¥ngÂ http://tapchi.vnu.edu.vn/tckh/news/?1887/635/Ma-hoa-dong-cau-va-ung-dung.htm</li>
<li>https://github.com/mikeivanov/paillier</li>
<li>Z. Erkin, M. Franz, J. Guajardo, S. Katzenbeisser, R. L. Lagendijk and T. Toft, Privacy- Preserving Face Recognition, 9th International Symposium on Privacy Enhancing Technologies, LNCS 5672, pp. 235-253, August 2009.</li>
</ol>
<h1>Appendix:</h1>
<p><strong>á»¨ng dá»¥ng há»‡ mÃ£ hÃ³a Ä‘á»“ng cáº¥u trong nháº­n dáº¡ng hÃ¬nh áº£nh tá»™i pháº¡m</strong> (váº«n Ä‘áº£m báº£o quyá»n báº£o vá»‡ há»‡ thá»‘ng hÃ¬nh áº£nh tá»™i pháº¡m, cÅ©ng nhÆ° khÃ´ng lÃ m lá»™ khuÃ´n máº·t ngÆ°á»i cáº§n kiá»ƒm tra):</p>
<p><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?ssl=1"><img data-attachment-id="582" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-11/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?fit=790%2C1496&amp;ssl=1" data-orig-size="790,1496" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?fit=158%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?fit=541%2C1024&amp;ssl=1" class="alignnone size-full wp-image-582" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?resize=604%2C1144&#038;ssl=1" alt="Untitled" width="604" height="1144" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?w=790&amp;ssl=1 790w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?resize=158%2C300&amp;ssl=1 158w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?resize=768%2C1454&amp;ssl=1 768w, https://i0.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-10.png?resize=541%2C1024&amp;ssl=1 541w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p><strong>TÃ­nh toÃ¡n khÃ´ng lá»™ thÃ´ng tin (ghi chÃº pháº§n 4)</strong></p>
<p><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?ssl=1"><img data-attachment-id="583" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/av2/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?fit=1417%2C2169&amp;ssl=1" data-orig-size="1417,2169" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="av2" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?fit=196%2C300&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?fit=604%2C925&amp;ssl=1" class="alignnone size-full wp-image-583" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?resize=604%2C925&#038;ssl=1" alt="av2" width="604" height="925" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?w=1417&amp;ssl=1 1417w, https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?resize=196%2C300&amp;ssl=1 196w, https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?resize=768%2C1176&amp;ssl=1 768w, https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?resize=669%2C1024&amp;ssl=1 669w, https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/av2.png?w=1208&amp;ssl=1 1208w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?ssl=1"><img data-attachment-id="584" data-permalink="https://babyphd.net/2016/09/07/an-toan-tinh-toan-da-thanh-vien/untitled-12/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?fit=558%2C158&amp;ssl=1" data-orig-size="558,158" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Untitled" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?fit=300%2C85&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?fit=558%2C158&amp;ssl=1" class="alignnone size-full wp-image-584" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?resize=558%2C158&#038;ssl=1" alt="Untitled" width="558" height="158" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?w=558&amp;ssl=1 558w, https://i1.wp.com/babyphd.net/wp-content/uploads/2016/09/Untitled-11.png?resize=300%2C85&amp;ssl=1 300w" sizes="(max-width: 558px) 100vw, 558px" data-recalc-dims="1" /></a></p>
]]></content:encoded>
									<post-id xmlns="com-wordpress:feed-additions:1">557</post-id>	</item>
		<item>
		<title>Malware Analysis Overview for beginners</title>
		<link>https://babyphd.net/2016/07/07/malware-analysis-overview-for-beginners/</link>
				<pubDate>Thu, 07 Jul 2016 13:54:56 +0000</pubDate>
		<dc:creator><![CDATA[chuymichxinhdep]]></dc:creator>
				<category><![CDATA[chuymich]]></category>
		<category><![CDATA[re]]></category>
		<category><![CDATA[research]]></category>

		<guid isPermaLink="false">https://babyphd.net/?p=545</guid>
				<description><![CDATA[&#160; &#160; The malware threat landscape is continuously evolving. In thisÂ blog post,Â I would like toÂ introduce the basic concept of malware and malware analysis, the ideas of both static and dynamic malware analysis. Besides, malware evasive techniques and novel solutions will be introduced as well asÂ modern research such as automatic protocol RE and Android malware behavior &#8230; <a href="https://babyphd.net/2016/07/07/malware-analysis-overview-for-beginners/" class="more-link">Continue reading <span class="screen-reader-text">Malware Analysis Overview for beginners</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The malware threat landscape is continuously evolving. In thisÂ blog post,Â I would like toÂ introduce the basic concept of malware and malware analysis, the ideas of both static and dynamic malware analysis. Besides, malware evasive techniques and novel solutions will be introduced as well asÂ modern research such as automatic protocol RE and Android malware behavior analysis will be mentioned in last sections.</p>
<p><span id="more-545"></span></p>
<h1><a id="post-545-_Toc444553187"></a>Basic principles of malware analysis</h1>
<h2><a id="post-545-_Toc444553188"></a>What is malware?</h2>
<p>Software that â€œdeliberate fulfills the harmful intent of an attackerâ€. It motivates to create tools to detect and mitigate malicious software. There is a common signature-base AV scanners which match pre-generated signatures against files. But this approach is error-prone task and not be able to detect unknown, specially tailored malware.</p>
<p><strong>Types of malware</strong>: Worm, virus, Trojan horse, spyware, bot(net), rootkit.</p>
<p><strong>Infection vectors</strong>: Exploiting vulnerable services, drive-by download and SE.</p>
<h2><a id="post-545-_Toc444553189"></a>Malware analysis:</h2>
<p><strong>Static analysis</strong>: refers to techniques that verify the actions the program performs in practice, without actually executing it. Analysts often disassemble the program to understand their behaviors but it might result in ambiguous results if the binary uses self modifying code techniques (e.g., packer programs). Additionally, malware relying on outside values cannot be statically determined correctly (e.g., current system date, indirect jump instructions) Therefore, it is necessary to develop analysis techniques that are reliably analyze malicious software.</p>
<p><strong>Dynamic analysis</strong>: refers to techniques that execute functions, verify the actions the program performs in practice by executing it. To monitor what functions are called is to intercept function calls (hooking). Then output the invocation to a log file or analyze input parameters or output results. There are 3 kinds of function calls: API, system calls and Windows Native API.</p>
<p>Implementing function hooking: by inserting to source code (if exists), binary rewriting using Detours library, debugging techniques, replacing dynamic shared libraries.</p>
<p>To analyze function parameter: Information flow tracking (taint sources and sinks), irect data dependencies (taint labels), address dependencies, control flow dependencies, implicit information flow.</p>
<p>Implementation strategies for malware analysis:</p>
<ul>
<li>Analysis in User-/Kernel-mode: ease to invoke functions or API calls.</li>
<li>Analysis in emulator: Memory&amp;CPU emulation (libemu, qemu etc.), full system emulation (Boshs, etc.)</li>
<li>Analysis in Virtual Machine</li>
<li>Network simulation: no internet but simulated network, or filtered network.</li>
</ul>
<h2><a id="post-545-_Toc444553190"></a>An example of static analysis - Metamorphic malware analysis and real-time detection</h2>
<p>Metamorphism [4] is a technique that mutates the binary code using different obfuscations. It changes the opcodes with each run of the infected program and does not use any encryption or decryption (different from Polymorphism). The malware never keeps same sequence of codes in the memory.</p>
<p>The authors present a new framework named Metamorphic Malware Analysis and Real-Time Detection (MARD). It builds a behavioral signature and detect metamorphic malware in real-time using two techniques: ACFG (Annotated Control Flow Graph) provides a faster matching of CFGs, without compromising detection accuracy and SWOD-CFWeight (Sliding Window of Difference and Control Flow Weight) mitigates and addresses key issues in current techniques, related to the change of the frequencies of opcodes, such as the use of different compilers, compiler optimizations, operating systems and obfuscations.</p>
<p><img class="aligncenter" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/07/word-image.png?w=604&#038;ssl=1" data-recalc-dims="1" /></p>
<p style="text-align: center;">Fig 1. <em>Overview of MARD</em></p>
<h3><a id="post-545-_Toc444553191"></a>Metamorphic Malware Analysis and Real-Time Detection (MARD)</h3>
<p>First, a training dataset Malware Templates is built using the malware training samples. After a sample is translated to Malware Analysis Intermediate Language (MAIL) and to a behavioral signature, the Similarity Detector detects the presence of malware in the program, using the Malware Templates. All the steps as shown are completely automated. The tool automatically generates the report after all the samples are processed.</p>
<h3><a id="post-545-_Toc444553192"></a>Annotated Control Flow Graph detection technique</h3>
<p>A sample is initiallyÂ disassembled and translated to a MAIL program. The MAIL program is then annotated with patterns, then they build a CFG of the annotated MAIL program yielding the corresponding ACFG. The constructed ACFG becomes part of the signature of the program and is matched against a database of known malware samples to see if the program contains a malware or not. For detecting unknown malware, the authors build an ACFG for each function in the program is built. Then divide a program into smaller ACFGs, with one ACFG per function instead of building a large ACFG as signature. A sample which contains part of the control flow of a training malware sample, is classified as a malware, i.e. if a percentage (compared to some predefined threshold) of the number of ACFGs involved in a malware signature match with the signature of a sample then this sample is classified as a malware.</p>
<h3><a id="post-545-_Toc444553193"></a>Sliding Window of Difference and Control Flow Weight detection technique</h3>
<p>Shahid Alam et al propose a new opcode-based malware detection technique by transforming the assembly code to an intermediate language that makes the analysis independent of different compilers. Then they extract and analyze the control flow semantics of the program in order to mitigate the effect of obfuscations by polymorphic and metamorphic malware. The control flow semantics were applied by statistical analysis of opcode distributions to develop a set of heuristics.</p>
<h3><a id="post-545-_Toc444553194"></a>Evaluation</h3>
<p>Out of the 10 systems, ACFG clearly shows superior results and, unlike others is fully automatic, supports malware detection for 64 bit Windows (PE binaries) and Linux (ELF binaries) platforms and has the potential to be used as a realtime detector.</p>
<p><img src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/07/word-image-1.png?w=604&#038;ssl=1" data-recalc-dims="1" /></p>
<p>Fig 2. <em>Comparison of ACFG with the metamorphic malware detection techniques based on control and information flow analysis.</em></p>
<h2><a id="post-545-_Toc444553195"></a>Dynamic malware behavior analysis</h2>
<p>TheÂ paper [3] implement an automated approach to extract malware behaviors by observing all the system functions calls in virtualized environment. A virtualized W32 machine is created through <em>wine</em> with common Windows system configuration and an emulated network infrastructure. Execution monitor, environment is controlled via <em>SSH</em>.</p>
<h3><a id="post-545-_Toc444553196"></a>Analyzing malware behavior</h3>
<p><strong>Malware behavior</strong>: The authors create a set of actions (virtual operating system function call) that a malware <em>M</em> can perform.</p>
<p><strong>Determination of malware actions</strong>: There is an important issue that they must differentiate between function calls called by operating system and by malware. Gerard Wagener et. al create a set of return memory addresses to characterize correctly executed functions.</p>
<p><strong>Malware behavior similarities</strong>: 2 malware behaviors are compared with each other and a similarity function is evaluated. This function compares pair-wise all the action and attaches scores for matching. A malware with low similarity can be seen as unknown behavior and vice versa.</p>
<p><strong>Distance between malware behaviors</strong>: The previous comparison technique only consider the similarity of function call order. In some cases, the malfunctioned activities can run concurrently or depends on the operation scheduler. Then they improve the model by rely on the frequencies of function calls as well by using Hellinger distance. Besides, a malware did not call a function does not mean it never calls these functions. So they apply the technique of statistical smoothing then show how many information is contained in a malware behavior.</p>
<p><strong>Phylogenetic tree for malware</strong>: A phylogenetic tree is a branching diagram or "tree" showing the relationships among various biological species based upon similarities and differences in their genetic characteristics. The authors apply a binary tree by grouping similar nodes based on the previous similarity matrix until the matrix is empty.</p>
<h3><a id="post-545-_Toc444553197"></a>Experimental validation</h3>
<ul>
<li>Malwares are captured through a honeypot called Nepenthes.</li>
<li>They created some anti-RE binaries to include as a behavior should be observed.</li>
<li>They created obfuscated assembler code, used a debugger to see the code changes its behavior or not.</li>
<li>They handled sleep(), exception division by zero (which is often used as an anti-sandbox), observed virtual operating system environment.</li>
</ul>
<p>Using above sequences to compute the similarity, they generated a top 10 list of most common malware behavior, average similarity etc. and used AV software to explain the similarity. Then they applied phylogenetic tree to highlight 3 malware families then built 2 trees based on similarity matrix and Hellinger distance matrix.</p>
<p>The authors introduced the automated malware behavior analysis, then they can detect 0day malware based on low average distance similarity from real world data. It is considered that malwares behave similarly at the beginning, it means the malware author copied parts from previous malware. They plan to extend the work with better heuristics and a differentiated analysis.</p>
<h1><a id="post-545-_Toc444553198"></a>The malware analysis arms race and its consequences</h1>
<h2><a id="post-545-_Toc444553199"></a>Malware evasive techniques</h2>
<p><strong>Self-modifying code and packers [1]</strong>: The malware self modifies its binary and store data in memory using encoding or encryption techniques. It also can be polymorphic using different encryption keys. Countermeasures are RE the unpacking algorithm, generic detection and reconstruction of packed code (catching the original binary in process address space).</p>
<p><strong>Detection of Analysis environment</strong>: Malware tries to detect analysis platforms based on: Hardware fingerprint, execution environment (eg. IsDebuggerPresent()), external applications (such as debuggers), behavioral. Mitigations are eliminating the differences between analysis environment and real environment or modifying the malware during execution to force the wanted path to be executed.</p>
<p><strong>Logic bombs</strong>: A malware might only execute on a certain date or reliance on user input.</p>
<p><strong>Analysis performance</strong>: The execution of malware analysis might slow down the timing in the operating system which executes malware. Countermeasures: RDTSC time-stam counter register, slowing down time in an emulated/virtual environment; terminate the analysis once a given timeout process.</p>
<h2><a id="post-545-_Toc444553200"></a>Malware analysis tools</h2>
<p>In order to deal with thousands of malwares with modern techniques, security analysts create many novel tools to ease these challenges.</p>
<ul>
<li>Anubis: analysis of unknown libraries based on TTAnalyze, executes the sample in a Windows OS, focus on the executed operations on behalf of the sample, and produce a report (now support Android APK as well).</li>
<li>Multiple path exploration: This tool recognizes a branching point whenever a control flow decision is based on data outside the monitored process. Then it is detected if a control flow decision is based on a return value of a system call (e.g., the current system time). Multiple path exploration is a countermeasure of logic bombs.</li>
<li>CWSandbox: a virtual environment based on invoking API functions by injecting DLL to the running process. Then it analyze malware behavior and produce a malware analysis report.</li>
<li>Norman Sandbox: also used in [3] to reference to anti-emulation code. The Norman Sandbox provides a simulated environment with fake impression that it is running on a real system to the sample under analysis that consists of custom-made versions of user-land APIs necessary for the sample to execute.</li>
</ul>
<h2><a id="post-545-_Toc444553201"></a>Bare-metal Analysis-based Evasive Malware Detection</h2>
<p>Nowadays, malwares become more and more sophisticated especially improved techniques to identify analysis environment and refraining from performing malicious actions. In this section, I introduce the research of BareCloud [5] - an automated evasive malware detection system based on bare-metal dynamic malware analysis. This is a novel approach of hierarchical similarity-based malware behavior comparison to analyze the behavior of a sample in the various analysis systems.</p>
<h3><a id="post-545-_Toc444553202"></a>Bare-metal system overview</h3>
<p>The bare-metal malware analysis system is a cluster of hardware-based modular worker units based on a remote storage disk. The bare-metal system also has a software-based remote control mechanism to automate the malware execution process on the workers. This mechanism is based on the IPMI remote administration features,iSCSI protocol (Internet Small Computer System Interface) to attach remote disks to worker units, Logical Volume Manager (LVM)-based copy-on-write snapshots to host the remote disk used by the analysis system running on the worker units. After the completion of each malware analysis, the corresponding volume snapshot is recreated from a clean volume.</p>
<p>The bare-metal malware analysis system is a real hardware-based hence there is really difficult for malware to identify the analysis environment. With these network log and disk capture, the authors make a behavior comparison after applying behavior deviation, behavioral profile, behavior extraction and hierarchical similarity.</p>
<h3><a id="post-545-_Toc444553203"></a>Evaluation</h3>
<p>The experiments show that research produces better evasion detection results compared to previous methods. BareCloud was able to automatically detect 5,835 evasive malware out of 110,005 recent samples.</p>
<h1><a id="post-545-_Toc444553204"></a>Automatic protocol RE</h1>
<p>Previous sections focus on techniques to analyze and classify malware based on hooking functions, system calls. However, understanding the C&amp;C botnetâ€™s protocol is a hard work and analysts need to rewrite every sent and received messages. In the next section, I will introduce Dispatcher [2] â€“ an automatic protocol RE to analyze botnet networking communication.</p>
<h2><a id="post-545-_Toc444553205"></a>Dispatcher implementation overview</h2>
<p>The captured output buffer (in case of encrypted protocols, they capture the buffer before being encrypted and sent or they capture the buffer after being decrypted and received, therefore they can obtain unencrypted data) will be <em>deconstructed</em> to build message field tree.</p>
<p><img class="aligncenter" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2016/07/word-image-2.png?w=604&#038;ssl=1" data-recalc-dims="1" /> <img class="aligncenter" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2016/07/word-image-3.png?w=604&#038;ssl=1" data-recalc-dims="1" /></p>
<p style="text-align: center;">Fig 3. <em>Message field tree and Field semantics identified by Dispatcher</em></p>
<p>To infer the field semantics, Juan Caballera et al. use type-inference-based technique that leverage the observation that many functions and instructions are used by known programs contain semantic information. Such interference is general and can be used to identify large scale of field semantics such as cookie, timestamps, hostname, port, IP address etc.</p>
<p>Combining 2 above solutions, the authors introduced Dispatcher which firstly makes a forward pass over the execution trace collecting information needed using loop analysis, callstack analysis and buffer liveness analysis. Then it use a recursive process to deconstruct the buffer based on program locations, dependency chains (a sequence of write operations). Dispatcher infer the field attributes eventually by determine: keywords, length fields, delimiters, variable-length fields and arrays.</p>
<h2><a id="post-545-_Toc444553206"></a>Evaluation</h2>
<p>The authors evaluate these techniques on MegaD C&amp;C which uses a proprietary encryption protocol on port 443 (instead of SSL) and they successfully rewrite and summarize its field semantics and compare this with unencrypted messages using BinPac. Besides, they evaluate their techniques on 4 open protocols: HTTP, DNS, FTP and ICQ. The results show that the accuracy of the message format automatically extracted by Dispatcher can rival that of Wireshark, without requiring a manually generated grammar.</p>
<h1><a id="post-545-_Toc444553207"></a>Automatically Reconstruct Android Malware Behaviors</h1>
<p>With a huge user base of Anroid mobile devices, Android malwares are rising with an alarmingly pace. This section I will summarize basic concepts of CopperDroid [6], an approach built on top of QEMU to automatically perform out-of-the-box dynamic behavioral analysis of Android malware.</p>
<h2><a id="post-545-_Toc444553208"></a>CooperDroid</h2>
<p><img class="aligncenter" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2016/07/word-image-4.png?w=604&#038;ssl=1" data-recalc-dims="1" /></p>
<p style="text-align: center;">Fig 4. <em>CooperDroid Architecture</em></p>
<p>The whole Android system runs on top of the CopperDroid emulator based on qemu (a generic and open source machine emulator and virtualizer). It enhances the Android emulator to enable system call tracking and support our out-of-the-box system call-centric analyses. The communication between host and emulator is using GDB support.</p>
<ul>
<li>Tracking System Call Invocations: This is the basic dynamic malware analysis technique mentioned in 2.4. However, the ARM architecture underlying the Android operating system and CopperDroid <strong>swi </strong>instruction for invoking system calls which are different from Windows/Linux OS.</li>
<li>Binder Analysis: Dissecting interprocess communication (IPC) and remote procedure calls (RPCs). Android uses Binder which allows a Java process to invoke methods of remote objects as if they were local methods, through synchronous calls. CopperDroid carry out a detailed analysis of communication channels to specify behaviours of malicious Android applications. For example, when sending a SMS message, the system invokes service <em>isms</em> and remotely invoking its <em>sendText</em> function with the proper arguments. CopperDroid catches the arguments of each binder-related ioctl system call to reconstruct the remote invocation.</li>
<li>Path Coverage: Unanalysed path is exacerbated when mobile applications are user driven and interaction with applications. To address this problem, CopperDroid implements an approach based on extracting information from the Manifest to stimulate the analyzed sample with a number of events of interest. For example, injecting events such as phone calls and reception of SMS texts would lead to the execution of the registered application's broadcast receivers.</li>
</ul>
<h2><a id="post-545-_Toc444553209"></a>Results</h2>
<p>The authors observed an average of 28% additional behaviors on more than 60% of the Android Malware Genome Project's samples, and an average of 22% additional behaviors on roughly 73% of the Contagio's samples.</p>
<h1><a id="post-545-_Toc444553210"></a>References</h1>
<p>[1] Egele, Manuel, et al. "A survey on automated dynamic malware-analysis techniques and tools." ACM Computing Surveys (CSUR) 44.2 (2012): 6.</p>
<p>[2] Caballero, Juan, et al. "Dispatcher: Enabling active botnet infiltration using automatic protocol reverse-engineering." Proceedings of the 16th ACM conference on Computer and communications security. ACM, 2009.</p>
<p>[3] Wagener, GÃ©rard, Radu State, and Alexandre Dulaunoy. "Malware behaviour analysis." Journal in Computer Virology 4.4 (2008): 279-287.</p>
<p>[4] Shahid Alam, R.Nigel Horspool, Issa Traore, Ibrahim Sogukpinar. â€œA framework for metamorphic malware analysis and real-time detectionâ€. Computers &amp; security 48 (2015) 212-233</p>
<p>[5] Dhilung Kirat, Giovanni Vigna, and Christopher Kruegel. â€œBareCloud: Bare-metal Analysis-based Evasive Malware Detectionâ€. Proceedings of the 23rd USENIX Security Symposium. ISBN 978-1-931971-15-7</p>
<p>[6] Alessandro Reina, Aristide Fattori, Lorenzo Cavallaro. â€œA System Call-Centric Analysis and Stimulation Technique to Automatically Reconstruct Android Malware Behaviorsâ€. In the Proceedings of the 6th European Workshop on Systems Security (EuroSec).</p>
]]></content:encoded>
									<post-id xmlns="com-wordpress:feed-additions:1">545</post-id>	</item>
		<item>
		<title>BackdoorCTF Writeup</title>
		<link>https://babyphd.net/2015/04/03/backdoorctf-writeup/</link>
				<comments>https://babyphd.net/2015/04/03/backdoorctf-writeup/#comments</comments>
				<pubDate>Fri, 03 Apr 2015 06:50:03 +0000</pubDate>
		<dc:creator><![CDATA[chuymichxinhdep]]></dc:creator>
				<category><![CDATA[chuymich]]></category>
		<category><![CDATA[2015]]></category>
		<category><![CDATA[babyphd]]></category>
		<category><![CDATA[backdoorCTF]]></category>
		<category><![CDATA[gaylord]]></category>

		<guid isPermaLink="false">https://babyphd.net/?p=324</guid>
				<description><![CDATA[backdoor CTF 2015: NONAME Category: Exploit Points: 200 Author: Amanpreet Singh Difficulty: Solves: 25 Description: https://backdoor.sdslabs.co/challenges/NONAME Intrestingly enough, even though it was not expected, Chintu found a cool website to play with, though he can't get the flag. Can you? Visit this. Submit the SHA-256 hash of the flag obtained. Gaylord : At first,Â (str (all-ns))Â to &#8230; <a href="https://babyphd.net/2015/04/03/backdoorctf-writeup/" class="more-link">Continue reading <span class="screen-reader-text">BackdoorCTF Writeup</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<h1>backdoor CTF 2015: <a href="https://backdoor.sdslabs.co/challenges/NONAME">NONAME</a></h1>
<p><strong>Category:</strong> Exploit <strong>Points:</strong> 200 <strong>Author:</strong> <a href="https://backdoor.sdslabs.co/users/apsdehal">Amanpreet Singh</a> <strong>Difficulty:</strong> <strong>Solves:</strong> 25 <strong>Description:</strong></p>
<ul class="task-list">
<li><a href="https://backdoor.sdslabs.co/challenges/NONAME">https://backdoor.sdslabs.co/challenges/NONAME</a></li>
</ul>
<blockquote><p>Intrestingly enough, even though it was not expected, Chintu found a cool website to play with, though he can't get the flag. Can you? Visit <a href="https://agile-garden-1672.herokuapp.com/">this</a>. Submit the SHA-256 hash of the flag obtained.</p>
<p style="text-align: left;">
</blockquote>
<p>Gaylord : At first,Â (str (all-ns))Â to get all namespaces. And thenÂ (clojure.repl/dir noname.people.admin) to see what inside. There is including flag and secret. UsedÂ (noname.people.admin/flag) to get the Â a half of the flag.</p>
<p>Chuymichxinhdep: However secret is a private variable variable, I used ((noname.people.admin/secret)) to obtain the other half of the flag. Problem solved.</p>
<h1>backdoor CTF 2015: <a href="https://backdoor.sdslabs.co/challenges/QR">QR</a></h1>
<p><strong>Category:</strong> Misc <strong>Points:</strong> 70 <strong>Author:</strong> <a href="https://backdoor.sdslabs.co/users/nemo">Abhay Bir Singh Rana</a> <strong>Difficulty:</strong> Easy <strong>Solves:</strong> 84 <strong>Description:</strong></p>
<ul class="task-list">
<li><a href="https://backdoor.sdslabs.co/challenges/QR">https://backdoor.sdslabs.co/challenges/QR</a></li>
</ul>
<blockquote><p>Decode some QR codes at <code>nc hack.bckdr.in 8010</code></p>
<p>&nbsp;</p></blockquote>
<p>chuymichxinhdep:</p>
<pre class="lang:python decode:true">from subprocess import Popen, PIPE
i = 0
import socket

sock = socket.socket()
sock.connect(("hack.bckdr.in", 8010))
s= sock.recv(1024)
print(s)
while True:
	i=i+1
	string = ""
	s= sock.recv(65535)
	data= s.replace("\x20\x20","0").replace("\xe2\x96\x88\xe2\x96\x88","1")
	file = open('qr','w')
	for line in data.split("\n"):
		string = string+line[1:len(line)-1]+"0"*(47-len(line))+"\n"
	file.write(string[46:len(string)-1-46])
	file.close()
	output = Popen(["python", "sqrd.py", "qr"], stdout=PIPE).communicate()[0]
	print i, output.strip()
	sock.send(output.strip())</pre>
<p>Convert the QR to binary only and use Strong QR to decode. After 50 submissions we've got the flag.</p>
<h1>backdoor CTF 2015: <a href="https://backdoor.sdslabs.co/challenges/RAPIDFIRE">RAPIDFIRE</a></h1>
<p><strong>Category:</strong> Misc <strong>Points:</strong> 500 <strong>Author:</strong> <a href="https://backdoor.sdslabs.co/users/apsdehal">Amanpreet Singh</a> <strong>Difficulty:</strong> TODO <strong>Solves:</strong> 0 <strong>Description:</strong></p>
<ul class="task-list">
<li><a href="https://backdoor.sdslabs.co/challenges/RAPIDFIRE">https://backdoor.sdslabs.co/challenges/RAPIDFIRE</a></li>
</ul>
<blockquote><p>I am enjoying it really. Are you? <code>nc hack.bckdr.in 8007</code>. Submit the SHA-256 hash of the flag obtained.</p></blockquote>
<p>Chuymichxinhdep: Just use a brilliant source code from gaylord.</p>
<pre class="lang:python decode:true ">import socket, hashlib, time, requests
from geopy import GoogleV3
import re
import shelve
import omdb

host = '128.199.107.60'
port = 8008
rep_countrycode = False

def fib(n):
    i = h = 1
    j = k = 0
    while (n &gt; 0) :
        if (n%2 == 1) : # when n is odd
            t = j*h
            j = i*h + j*k + t
            i = i*k + t
        t = h*h
        h = 2*k*h + t
        k = k*k + t
        n = int(n/2)
    return j

def get_country(place_name):
    gapi = shelve.open('googly_cache', writeback=True)
    try:
        wat = place_name.encode('base64')
    except UnicodeEncodeError:
        wat = u' '.join(place_name).encode('utf-8').strip().encode('base64')
    if (wat in gapi):
        print('[*] Found in shelf')
        loc = gapi[wat]
    else:
        print('[*] Request from GGAPI')
        loc = geolocator.geocode(place_name).raw
        gapi[wat] = loc
        gapi.sync()
    gapi.close()
    for comp in loc['address_components']:
        if 'country' in comp['types']:
            if rep_countrycode:
                return comp['short_name'] # TODO: not short_name but something else
            else:
                return comp['long_name']

def get_release(movie_name):
    gapi = shelve.open('moviee_cache', writeback=True)
    try:
        wat = movie_name.encode('base64')
    except UnicodeEncodeError:
        wat = u' '.join(movie_name).encode('utf-8').strip().encode('base64')
    if (wat in gapi):
        print('[*] Found in shelf')
        loc = gapi[wat]
    else:
        print('[*] Request from OMDB')
        s = omdb.title(movie_name)
        loc = s['year']
        gapi[wat] = loc
        gapi.sync()
    gapi.close()
    return loc
    
def read_until(wat):
    buf = ''
    while not (wat in buf):
        buf += sock.recv(1)
    return buf
    
def read_for_fun(sz):
    d = ''
    while (sz &gt; 0):
        tmp = sock.recv(sz)
        sz -= len(tmp)
        d += tmp
    return d

# init connection
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((host, port))
geolocator = GoogleV3()
pii = requests.get('http://www.angio.net/pi/digits/pi1000000.txt').text
# read &amp; answer
while True:
    s = sock.recv(8192)
    if ('code is in CAPS' in s): rep_countrycode = True
    if (s == ''): sleep(10)
    print(s)
    n = 'wat'
    res = n
    if ('sum' in s):
        n = int(re.findall(r'first\ (\d+)\ ', s)[0])
        if ('odd' in s):
            res = n * n
        elif ('fibonacci' in s):
            res = fib(n+2) - 1
        elif ('natural number' in s):
            res = (n * (n + 1) // 2)
        res = str(res)
    elif ('prime' in s):
        n = int(re.findall(r'the\ (\d+)(st|nd|rd|th)', s)[0][0]) + 1
        n = str(n)
        page = requests.get('http://numbersofprime.com/prime/' + n)
        res = re.findall(r'<p style='text-align:center;'><span class='MathJax_Preview'><img src='https://i0.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_7d2876bab7cecac2e7cfb6f0c86dd091.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none;' class='tex' alt="" data-recalc-dims="1" /></span></p>', page.text)[1]
        res = res.replace(',', '')
        res = res.strip()
    elif ('md5' in s):
        n = re.findall(r'of\ (.*)\n', s)[0]
        res = hashlib.md5(n).hexdigest()
    elif ('pi' in s):
        n = int(re.findall(r'the\ (\d+)(st|nd|rd|th)', s)[0][0])
        res = pii[n+1]
    elif ('fibonacci' in s):
        n = int(re.findall(r'the\ (\d+)(st|nd|rd|th)', s)[0][0])
        res = str(fib(n))
    elif ('binary' in s):
        n = int(re.findall(r'of\ (\d+)\ in', s)[0])
        res = bin(n)[2:]
    elif ('country' in s):
        n = re.findall(r'of\ (.*)\n', s)[0]
        res = get_country(n)
    elif ('release year' in s):
        n = re.findall(r'of\ (.*)\n', s)[0]
        res = get_release(n)
    print '[*] n = ', n
    print '[*] res = ', res
    sock.sendall(res+'\n')</pre>
<p>&nbsp;</p>
<p>I added pycountry to get the alpha-2 code of country. After 199 submissions we will get the flag. Not a fun challange because of slow server and too many stupid questions.</p>
<p>-chuymichxinhdep.</p>
<p><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?ssl=1"><img data-attachment-id="326" data-permalink="https://babyphd.net/2015/04/03/backdoorctf-writeup/phd/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?fit=1350%2C696&amp;ssl=1" data-orig-size="1350,696" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="phd" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?fit=300%2C155&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?fit=604%2C311&amp;ssl=1" class="aligncenter wp-image-326 size-full" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?resize=604%2C311&#038;ssl=1" alt="phd" width="604" height="311" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?w=1350&amp;ssl=1 1350w, https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?resize=300%2C155&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?resize=1024%2C528&amp;ssl=1 1024w, https://i0.wp.com/babyphd.net/wp-content/uploads/2015/04/phd.png?w=1208&amp;ssl=1 1208w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p>BabyPhD.</p>
]]></content:encoded>
							<wfw:commentRss>https://babyphd.net/2015/04/03/backdoorctf-writeup/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
						<post-id xmlns="com-wordpress:feed-additions:1">324</post-id>	</item>
	</channel>
</rss>
