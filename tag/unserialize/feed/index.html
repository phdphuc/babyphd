<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
>

<channel>
	<title>unserialize &#8211; BabyPhD CTF Team</title>
	<atom:link href="https://babyphd.net/tag/unserialize/feed/" rel="self" type="application/rss+xml" />
	<link>https://babyphd.net</link>
	<description>Nói chung đây là một khái niệm vô cùng trừu tượng</description>
	<lastBuildDate>Thu, 27 Jul 2017 19:02:07 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.2</generator>
<site xmlns="com-wordpress:feed-additions:1">104079289</site>	<item>
		<title>ASISCTF 2017 - Web - Secure portal [1,2,3]</title>
		<link>https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/</link>
				<pubDate>Fri, 12 May 2017 13:38:37 +0000</pubDate>
		<dc:creator><![CDATA[justcallmedude]]></dc:creator>
				<category><![CDATA[web]]></category>
		<category><![CDATA[unserialize]]></category>

		<guid isPermaLink="false">https://babyphd.net/?p=642</guid>
				<description><![CDATA[Hey yo! Long time no C++ Có chút vấn đề khi mình viết writeup cho bài này đó là phần lầy flag có vẻ không hoạt động 🙁 nên hiện tại mình chỉ có thể viết được phần 1. Okie, link Có gợi ý như sau By the way I know it's dangerous to code with &#8230; <a href="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/" class="more-link">Continue reading <span class="screen-reader-text">ASISCTF 2017 - Web - Secure portal [1,2,3]</span> <span class="meta-nav">&#8594;</span></a>]]></description>
								<content:encoded><![CDATA[<p>Hey yo!</p>
<p>Long time no C++<br />
Có chút vấn đề khi mình viết writeup cho bài này đó là phần lầy flag có vẻ không hoạt động <img src="https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f641.png" alt="🙁" class="wp-smiley" style="height: 1em; max-height: 1em;" /> nên hiện tại mình chỉ có thể viết được phần 1.</p>
<p>Okie, <a href="http://66.172.33.77:8080/">link</a></p>
<p>Có gợi ý như sau <em><strong>By the way I know it's dangerous to code with IDE in server-side but I really obey security instructions</strong>.</em></p>
<p>Vào trang web và lưu lại các request &amp; response bằng Burpsuite Proxy</p>
<p style="text-align: center;"><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?ssl=1"><img data-attachment-id="643" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/1-2/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?fit=1221%2C750&amp;ssl=1" data-orig-size="1221,750" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?fit=300%2C184&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?fit=604%2C371&amp;ssl=1" class="aligncenter wp-image-643 size-full" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?resize=604%2C371&#038;ssl=1" width="604" height="371" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?w=1221&amp;ssl=1 1221w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?resize=300%2C184&amp;ssl=1 300w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?resize=768%2C472&amp;ssl=1 768w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/1.png?resize=1024%2C629&amp;ssl=1 1024w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p style="text-align: center;"><span id="more-642"></span></p>
<p style="text-align: left;">Có thể là có cả những file cấu hình project - Information leak. Tiện sẵn máy mình cũng cài PHPStorm nên tạo luôn 1 project để xem thế nào</p>
<p style="text-align: left;"><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?ssl=1"><img data-attachment-id="644" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/2-2/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?fit=490%2C165&amp;ssl=1" data-orig-size="490,165" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?fit=300%2C101&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?fit=490%2C165&amp;ssl=1" class="size-full wp-image-644 aligncenter" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?resize=490%2C165&#038;ssl=1" alt="" width="490" height="165" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?w=490&amp;ssl=1 490w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/2.png?resize=300%2C101&amp;ssl=1 300w" sizes="(max-width: 490px) 100vw, 490px" data-recalc-dims="1" /></a></p>
<p style="text-align: left;">Như vậy là có các file như trong hình, thử vào <code>.idea/workspace.xml</code> và ...</p>
<p style="text-align: left;"><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?ssl=1"><img data-attachment-id="645" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/3-2/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?fit=1063%2C596&amp;ssl=1" data-orig-size="1063,596" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="3" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?fit=300%2C168&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?fit=604%2C339&amp;ssl=1" class="size-full wp-image-645 aligncenter" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?resize=604%2C339&#038;ssl=1" alt="" width="604" height="339" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?w=1063&amp;ssl=1 1063w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?resize=300%2C168&amp;ssl=1 300w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?resize=768%2C431&amp;ssl=1 768w, https://i2.wp.com/babyphd.net/wp-content/uploads/2017/05/3.png?resize=1024%2C574&amp;ssl=1 1024w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p style="text-align: left;">Tiếp tục là 1 file php khác</p>
<p style="text-align: left;"><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?ssl=1"><img data-attachment-id="646" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/4-3/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?fit=731%2C644&amp;ssl=1" data-orig-size="731,644" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="4.3" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?fit=300%2C264&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?fit=604%2C532&amp;ssl=1" class="size-full wp-image-646 aligncenter" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?resize=604%2C532&#038;ssl=1" alt="" width="604" height="532" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?w=731&amp;ssl=1 731w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.3.png?resize=300%2C264&amp;ssl=1 300w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p style="text-align: left;">Phân tích kỹ ta có 1 đoạn compare lỗi <code>==</code> ở <code>if($realSign == $signature)</code></p>
<p style="text-align: left;">Bypass bằng cách bruteforce input để md5sum của (input + unknown-key) = 0e[a-f0-9]{30} aka <strong><em><a href="https://www.whitehatsec.com/blog/magic-hashes/">magic hash</a></em></strong>, sau đó đến phần unserialize của $payload... hmm, không đơn giản lắm nhỉ, bruteforce mà vẫn phải unserialize được. Tuy nhiên thì ta có thể chèn thêm junk variables vào trong $payload mà deserialize không ảnh hưởng gì cả.</p>
<p style="text-align: left;">Ví dụ</p>
<p style="text-align: left;"><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?ssl=1"><img data-attachment-id="647" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/4-1/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?fit=584%2C252&amp;ssl=1" data-orig-size="584,252" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="4.1" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?fit=300%2C129&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?fit=584%2C252&amp;ssl=1" class="size-full wp-image-647 aligncenter" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?resize=584%2C252&#038;ssl=1" alt="" width="584" height="252" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?w=584&amp;ssl=1 584w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/4.1.png?resize=300%2C129&amp;ssl=1 300w" sizes="(max-width: 584px) 100vw, 584px" data-recalc-dims="1" /></a></p>
<p style="text-align: left;"><a href="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?ssl=1"><img data-attachment-id="648" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/4-2/" data-orig-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?fit=782%2C300&amp;ssl=1" data-orig-size="782,300" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="4.2" data-image-description="" data-medium-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?fit=300%2C115&amp;ssl=1" data-large-file="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?fit=604%2C232&amp;ssl=1" class="size-full wp-image-648 aligncenter" src="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?resize=604%2C232&#038;ssl=1" alt="" width="604" height="232" srcset="https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?w=782&amp;ssl=1 782w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?resize=300%2C115&amp;ssl=1 300w, https://i1.wp.com/babyphd.net/wp-content/uploads/2017/05/4.2.png?resize=768%2C295&amp;ssl=1 768w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p style="text-align: left;">Chạy 1 lúc (ở server cũ)</p>
<p style="text-align: left;"><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?ssl=1"><img data-attachment-id="649" data-permalink="https://babyphd.net/2017/05/12/asisctf-2017-web-secure-portal-123/attachment/5/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?fit=956%2C385&amp;ssl=1" data-orig-size="956,385" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="5" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?fit=300%2C121&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?fit=604%2C243&amp;ssl=1" class="size-full wp-image-649 aligncenter" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?resize=604%2C243&#038;ssl=1" alt="" width="604" height="243" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?w=956&amp;ssl=1 956w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?resize=300%2C121&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2017/05/5.png?resize=768%2C309&amp;ssl=1 768w" sizes="(max-width: 604px) 100vw, 604px" data-recalc-dims="1" /></a></p>
<p style="text-align: left;">Sử dụng auth trên để lấy flag + source cho phần thứ 2.</p>
<p style="text-align: left;">&lt;continue&gt;</p>
]]></content:encoded>
									<post-id xmlns="com-wordpress:feed-additions:1">642</post-id>	</item>
	</channel>
</rss>
